
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( systemfit )
Loading required package: Matrix
Loading required package: car
Loading required package: lmtest
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

> options( digits = 3 )
> 
> data( "Kmenta" )
> useMatrix <- FALSE
> 
> demand <- consump ~ price + income
> supply <- consump ~ price + farmPrice + trend
> inst <- ~ income + farmPrice + trend
> inst1  <- ~ income + farmPrice
> instlist <- list( inst1, inst )
> system <- list( demand = demand, supply = supply )
> restrm <- matrix(0,1,7)  # restriction matrix "R"
> restrm[1,3] <-  1
> restrm[1,7] <- -1
> restrict <- "demand_income - supply_trend = 0"
> restr2m <- matrix(0,2,7)  # restriction matrix "R" 2
> restr2m[1,3] <-  1
> restr2m[1,7] <- -1
> restr2m[2,2] <- -1
> restr2m[2,5] <-  1
> restr2q <- c( 0, 0.5 )  # restriction vector "q" 2
> restrict2 <- c( "demand_income - supply_trend = 0",
+    "- demand_price + supply_price = 0.5" )
> tc <- matrix(0,7,6)
> tc[1,1] <- 1
> tc[2,2] <- 1
> tc[3,3] <- 1
> tc[4,4] <- 1
> tc[5,5] <- 1
> tc[6,6] <- 1
> tc[7,3] <- 1
> restr3m <- matrix(0,1,6)  # restriction matrix "R" 2
> restr3m[1,2] <- -1
> restr3m[1,5] <-  1
> restr3q <- c( 0.5 )  # restriction vector "q" 2
> restrict3 <- "- C2 + C5 = 0.5"
> 
> 
> ## ********************* W2SLS *****************
> fitw2sls1 <- systemfit( system, "W2SLS", data = Kmenta, inst = inst,
+    useMatrix = useMatrix )
> print( summary( fitw2sls1 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.87   0.00
supply   0.00   6.04

The covariance matrix of the residuals
       demand supply
demand   3.87   4.36
supply   4.36   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.9208   11.95  1.1e-09 ***
price        -0.2436     0.0965   -2.52    0.022 *  
income        0.3140     0.0469    6.69  3.8e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12   0.0008 ***
price         0.2401     0.0999    2.40   0.0288 *  
farmPrice     0.2556     0.0473    5.41  5.8e-05 ***
trend         0.2529     0.0997    2.54   0.0219 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> ## ********************* W2SLS (EViews-like) *****************
> fitw2sls1e <- systemfit( system, "W2SLS", data = Kmenta, inst = inst,
+    methodResidCov = "noDfCor", x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fitw2sls1e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    2.97  0.697      0.525

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.29   0.00
supply   0.00   4.83

The covariance matrix of the residuals
       demand supply
demand   3.29   3.59
supply   3.59   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.3027   12.96  1.7e-14 ***
price        -0.2436     0.0890   -2.74   0.0099 ** 
income        0.3140     0.0433    7.25  2.5e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.7425    4.61  5.8e-05 ***
price         0.2401     0.0894    2.69   0.0112 *  
farmPrice     0.2556     0.0423    6.05  8.4e-07 ***
trend         0.2529     0.0891    2.84   0.0077 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> ## ********************* W2SLS with restriction *******************
> fitw2sls2 <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, useMatrix = useMatrix )
> print( summary( fitw2sls2 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.41  0.692      0.565

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.8 3.93 1.98 0.751  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.97   0.00
supply   0.00   6.13

The covariance matrix of the residuals
       demand supply
demand   3.93   4.56
supply   4.56   6.15

The correlations of the residuals
       demand supply
demand  1.000  0.927
supply  0.927  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.3832     8.0090   11.78  1.5e-13 ***
price        -0.2302     0.0946   -2.43     0.02 *  
income        0.3028     0.0430    7.05  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.983 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.838 MSE: 3.932 Root MSE: 1.983 
Multiple R-Squared: 0.751 Adjusted R-Squared: 0.721 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.0494    11.8001    4.07  0.00026 ***
price         0.2430     0.1006    2.42  0.02122 *  
farmPrice     0.2625     0.0459    5.72  2.0e-06 ***
trend         0.3028     0.0430    7.05  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.48 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.445 MSE: 6.153 Root MSE: 2.48 
Multiple R-Squared: 0.633 Adjusted R-Squared: 0.564 

> # the same with symbolically specified restrictions
> fitw2sls2Sym <- systemfit( system, "W2SLS", data = Kmenta,
+    restrict.matrix = restrict, inst = inst, useMatrix = useMatrix )
> all.equal( fitw2sls2, fitw2sls2Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> 
> ## ********************* W2SLS with restriction (EViews-like) **************
> fitw2sls2e <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, methodResidCov = "noDfCor", x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fitw2sls2e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    2.33  0.692      0.535

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.9 3.94 1.98 0.750  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.37   0.00
supply   0.00   4.91

The covariance matrix of the residuals
       demand supply
demand   3.35   3.76
supply   3.76   4.92

The correlations of the residuals
       demand supply
demand  1.000  0.926
supply  0.926  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.3706     7.3834   12.78  1.6e-14 ***
price        -0.2295     0.0871   -2.63    0.013 *  
income        0.3022     0.0394    7.67  6.4e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.984 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.906 MSE: 3.936 Root MSE: 1.984 
Multiple R-Squared: 0.75 Adjusted R-Squared: 0.721 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.0661    10.5574    4.55  6.5e-05 ***
price         0.2430     0.0900    2.70    0.011 *  
farmPrice     0.2624     0.0411    6.39  2.7e-07 ***
trend         0.3022     0.0394    7.67  6.4e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.48 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.408 MSE: 6.15 Root MSE: 2.48 
Multiple R-Squared: 0.633 Adjusted R-Squared: 0.564 

> nobs( fitw2sls2e )
[1] 40
> 
> ## ********************* W2SLS with restriction via restrict.regMat *******************
> fitw2sls3 <- systemfit( system, "W2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = inst, x = TRUE, useMatrix = useMatrix )
> print( summary( fitw2sls3 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.41  0.692      0.565

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.8 3.93 1.98 0.751  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.97   0.00
supply   0.00   6.13

The covariance matrix of the residuals
       demand supply
demand   3.93   4.56
supply   4.56   6.15

The correlations of the residuals
       demand supply
demand  1.000  0.927
supply  0.927  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.3832     8.0090   11.78  1.5e-13 ***
price        -0.2302     0.0946   -2.43     0.02 *  
income        0.3028     0.0430    7.05  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.983 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.838 MSE: 3.932 Root MSE: 1.983 
Multiple R-Squared: 0.751 Adjusted R-Squared: 0.721 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.0494    11.8001    4.07  0.00026 ***
price         0.2430     0.1006    2.42  0.02122 *  
farmPrice     0.2625     0.0459    5.72  2.0e-06 ***
trend         0.3028     0.0430    7.05  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.48 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.445 MSE: 6.153 Root MSE: 2.48 
Multiple R-Squared: 0.633 Adjusted R-Squared: 0.564 

> 
> ## ********************* W2SLS with restriction via restrict.regMat (EViews-like) **************
> fitw2sls3e <- systemfit( system, "W2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = inst, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fitw2sls3e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    2.33  0.692      0.535

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.9 3.94 1.98 0.750  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.37   0.00
supply   0.00   4.91

The covariance matrix of the residuals
       demand supply
demand   3.35   3.76
supply   3.76   4.92

The correlations of the residuals
       demand supply
demand  1.000  0.926
supply  0.926  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.3706     7.3834   12.78  1.6e-14 ***
price        -0.2295     0.0871   -2.63    0.013 *  
income        0.3022     0.0394    7.67  6.4e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.984 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.906 MSE: 3.936 Root MSE: 1.984 
Multiple R-Squared: 0.75 Adjusted R-Squared: 0.721 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.0661    10.5574    4.55  6.5e-05 ***
price         0.2430     0.0900    2.70    0.011 *  
farmPrice     0.2624     0.0411    6.39  2.7e-07 ***
trend         0.3022     0.0394    7.67  6.4e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.48 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.408 MSE: 6.15 Root MSE: 2.48 
Multiple R-Squared: 0.633 Adjusted R-Squared: 0.564 

> 
> ## ***************** W2SLS with 2 restrictions ********************
> fitw2sls4 <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fitw2sls4 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.57   0.69      0.575

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.89   0.00
supply   0.00   6.25

The covariance matrix of the residuals
       demand supply
demand   3.88   4.55
supply   4.55   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.924
supply  0.924  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3043     6.3056   15.11  < 2e-16 ***
price        -0.2428     0.0684   -3.55   0.0011 ** 
income        0.3063     0.0394    7.78  3.9e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.969 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.931 MSE: 3.878 Root MSE: 1.969 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4229     8.3296    5.57  2.8e-06 ***
price         0.2572     0.0684    3.76  0.00062 ***
farmPrice     0.2642     0.0455    5.80  1.4e-06 ***
trend         0.3063     0.0394    7.78  3.9e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.255 MSE: 6.266 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> # the same with symbolically specified restrictions
> fitw2sls4Sym <- systemfit( system, "W2SLS", data = Kmenta,
+    restrict.matrix = restrict2, inst = inst, x = TRUE,
+    useMatrix = useMatrix )
> all.equal( fitw2sls4, fitw2sls4Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> 
> ## ***************** W2SLS with 2 restrictions (EViews-like) **************
> fitw2sls4e <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, methodResidCov = "noDfCor",
+    useMatrix = useMatrix )
> print( summary( fitw2sls4e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.44   0.69      0.546

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.2 6.26 2.50 0.626  0.556

The covariance matrix of the residuals used for estimation
       demand supply
demand    3.3      0
supply    0.0      5

The covariance matrix of the residuals
       demand supply
demand   3.30   3.75
supply   3.75   5.01

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3470     5.7579   16.56  < 2e-16 ***
price        -0.2428     0.0621   -3.91  0.00041 ***
income        0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.97 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.945 MSE: 3.879 Root MSE: 1.97 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4366     7.5360    6.16  4.7e-07 ***
price         0.2572     0.0621    4.14  0.00021 ***
farmPrice     0.2642     0.0407    6.48  1.8e-07 ***
trend         0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.225 MSE: 6.264 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> 
> ## ***************** W2SLS with 2 restrictions via R and restrict.regMat ******************
> fitw2sls5 <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    x = TRUE, useMatrix = useMatrix )
> print( summary( fitw2sls5 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.57   0.69      0.575

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.89   0.00
supply   0.00   6.25

The covariance matrix of the residuals
       demand supply
demand   3.88   4.55
supply   4.55   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.924
supply  0.924  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3043     6.3056   15.11  < 2e-16 ***
price        -0.2428     0.0684   -3.55   0.0011 ** 
income        0.3063     0.0394    7.78  3.9e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.969 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.931 MSE: 3.878 Root MSE: 1.969 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4229     8.3296    5.57  2.8e-06 ***
price         0.2572     0.0684    3.76  0.00062 ***
farmPrice     0.2642     0.0455    5.80  1.4e-06 ***
trend         0.3063     0.0394    7.78  3.9e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.255 MSE: 6.266 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> # the same with symbolically specified restrictions
> fitw2sls5Sym <- systemfit( system, "W2SLS", data = Kmenta,
+    restrict.matrix = restrict3, restrict.regMat = tc, inst = inst,
+    x = TRUE, useMatrix = useMatrix )
> all.equal( fitw2sls5, fitw2sls5Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> 
> ## ***************** W2SLS with 2 restrictions via R and restrict.regMat (EViews-like) **************
> fitw2sls5e <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fitw2sls5e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.44   0.69      0.546

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.2 6.26 2.50 0.626  0.556

The covariance matrix of the residuals used for estimation
       demand supply
demand    3.3      0
supply    0.0      5

The covariance matrix of the residuals
       demand supply
demand   3.30   3.75
supply   3.75   5.01

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3470     5.7579   16.56  < 2e-16 ***
price        -0.2428     0.0621   -3.91  0.00041 ***
income        0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.97 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.945 MSE: 3.879 Root MSE: 1.97 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4366     7.5360    6.16  4.7e-07 ***
price         0.2572     0.0621    4.14  0.00021 ***
farmPrice     0.2642     0.0407    6.48  1.8e-07 ***
trend         0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.225 MSE: 6.264 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> 
> ## ****** 2SLS estimation with different instruments **********************
> fitw2slsd1 <- systemfit( system, "W2SLS", data = Kmenta, inst = instlist,
+    useMatrix = useMatrix )
> print( summary( fitw2slsd1 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.97   0.00
supply   0.00   6.04

The covariance matrix of the residuals
       demand supply
demand   3.97   3.84
supply   3.84   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 106.7894    11.1435    9.58  2.9e-08 ***
price        -0.4116     0.1448   -2.84    0.011 *  
income        0.3617     0.0564    6.41  6.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12   0.0008 ***
price         0.2401     0.0999    2.40   0.0288 *  
farmPrice     0.2556     0.0473    5.41  5.8e-05 ***
trend         0.2529     0.0997    2.54   0.0219 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> ## ****** 2SLS estimation with different instruments (EViews-like)******************
> fitw2slsd1e <- systemfit( system, "W2SLS", data = Kmenta, inst = instlist,
+    methodResidCov = "noDfCor", x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fitw2slsd1e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    6.29  0.694        0.5

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.37   0.00
supply   0.00   4.83

The covariance matrix of the residuals
       demand supply
demand   3.37   3.16
supply   3.16   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  106.789     10.274   10.39  6.1e-12 ***
price         -0.412      0.134   -3.08   0.0041 ** 
income         0.362      0.052    6.95  6.0e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.7425    4.61  5.8e-05 ***
price         0.2401     0.0894    2.69   0.0112 *  
farmPrice     0.2556     0.0423    6.05  8.4e-07 ***
trend         0.2529     0.0891    2.84   0.0077 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> ## **** W2SLS estimation with different instruments and restriction ********
> fitw2slsd2 <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, useMatrix = useMatrix )
> print( summary( fitw2slsd2 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    5.11   0.69      0.557

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.8 3.81 1.95 0.758  0.730
supply 20 16 101.4 6.34 2.52 0.622  0.551

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.79   0.00
supply   0.00   6.27

The covariance matrix of the residuals
       demand supply
demand   3.81   4.36
supply   4.36   6.34

The correlations of the residuals
       demand supply
demand  1.000  0.888
supply  0.888  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 104.5695    10.6344    9.83  1.8e-11 ***
price        -0.3653     0.1327   -2.75   0.0094 ** 
income        0.3369     0.0485    6.95  5.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.952 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.776 MSE: 3.81 Root MSE: 1.952 
Multiple R-Squared: 0.758 Adjusted R-Squared: 0.73 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.0356    11.9466    3.94  0.00039 ***
price         0.2450     0.1017    2.41  0.02156 *  
farmPrice     0.2672     0.0465    5.74  1.9e-06 ***
trend         0.3369     0.0485    6.95  5.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.518 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 101.426 MSE: 6.339 Root MSE: 2.518 
Multiple R-Squared: 0.622 Adjusted R-Squared: 0.551 

> 
> ## **** W2SLS estimation with different instruments and restriction (EViews-like)*
> fitw2slsd2e <- systemfit( system, "W2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, methodResidCov = "noDfCor", x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fitw2slsd2e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    3.45   0.69      0.535

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.7 3.81 1.95 0.759  0.730
supply 20 16 101.3 6.33 2.52 0.622  0.551

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.22   0.00
supply   0.00   5.02

The covariance matrix of the residuals
       demand supply
demand   3.24   3.60
supply   3.60   5.06

The correlations of the residuals
       demand supply
demand  1.000  0.888
supply  0.888  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 104.4638     9.7929   10.67  2.2e-12 ***
price        -0.3630     0.1220   -2.98   0.0053 ** 
income        0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.951 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.715 MSE: 3.807 Root MSE: 1.951 
Multiple R-Squared: 0.759 Adjusted R-Squared: 0.73 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.0706    10.6890    4.40   0.0001 ***
price         0.2449     0.0910    2.69   0.0109 *  
farmPrice     0.2671     0.0416    6.41  2.5e-07 ***
trend         0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.516 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 101.299 MSE: 6.331 Root MSE: 2.516 
Multiple R-Squared: 0.622 Adjusted R-Squared: 0.551 

> 
> ## ** W2SLS estimation with different instruments and restriction via restrict.regMat ****
> fitw2slsd3 <- systemfit( system, "W2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = instlist, x = TRUE, useMatrix = useMatrix )
> print( summary( fitw2slsd3 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    5.11   0.69      0.557

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.8 3.81 1.95 0.758  0.730
supply 20 16 101.4 6.34 2.52 0.622  0.551

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.79   0.00
supply   0.00   6.27

The covariance matrix of the residuals
       demand supply
demand   3.81   4.36
supply   4.36   6.34

The correlations of the residuals
       demand supply
demand  1.000  0.888
supply  0.888  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 104.5695    10.6344    9.83  1.8e-11 ***
price        -0.3653     0.1327   -2.75   0.0094 ** 
income        0.3369     0.0485    6.95  5.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.952 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.776 MSE: 3.81 Root MSE: 1.952 
Multiple R-Squared: 0.758 Adjusted R-Squared: 0.73 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.0356    11.9466    3.94  0.00039 ***
price         0.2450     0.1017    2.41  0.02156 *  
farmPrice     0.2672     0.0465    5.74  1.9e-06 ***
trend         0.3369     0.0485    6.95  5.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.518 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 101.426 MSE: 6.339 Root MSE: 2.518 
Multiple R-Squared: 0.622 Adjusted R-Squared: 0.551 

> 
> ## W2SLS estimation with different instruments and restriction via restrict.regMat (EViews-like)
> fitw2slsd3e <- systemfit( system, "W2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = instlist, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fitw2slsd3e, useDfSys = TRUE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    3.45   0.69      0.535

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.7 3.81 1.95 0.759  0.730
supply 20 16 101.3 6.33 2.52 0.622  0.551

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.22   0.00
supply   0.00   5.02

The covariance matrix of the residuals
       demand supply
demand   3.24   3.60
supply   3.60   5.06

The correlations of the residuals
       demand supply
demand  1.000  0.888
supply  0.888  1.000


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 104.4638     9.7929   10.67  2.2e-12 ***
price        -0.3630     0.1220   -2.98   0.0053 ** 
income        0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.951 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.715 MSE: 3.807 Root MSE: 1.951 
Multiple R-Squared: 0.759 Adjusted R-Squared: 0.73 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.0706    10.6890    4.40   0.0001 ***
price         0.2449     0.0910    2.69   0.0109 *  
farmPrice     0.2671     0.0416    6.41  2.5e-07 ***
trend         0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.516 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 101.299 MSE: 6.331 Root MSE: 2.516 
Multiple R-Squared: 0.622 Adjusted R-Squared: 0.551 

> 
> 
> ## *********** estimations with a single regressor ************
> fitw2slsS1 <- systemfit(
+    list( consump ~ price - 1, price ~ consump + trend ), "W2SLS",
+    data = Kmenta, inst = ~ farmPrice + trend + income, useMatrix = useMatrix )
> print( summary( fitw2slsS1 ) )

systemfit results 
method: W2SLS 

        N DF  SSR detRCov OLS-R2 McElroy-R2
system 40 36 1544     179  -0.65      0.852

     N DF SSR  MSE RMSE     R2 Adj R2
eq1 20 19 861 45.3 6.73 -2.213 -2.213
eq2 20 17 682 40.1 6.33 -0.022 -0.143

The covariance matrix of the residuals used for estimation
     eq1  eq2
eq1 45.3  0.0
eq2  0.0 40.1

The covariance matrix of the residuals
      eq1   eq2
eq1  45.3 -40.5
eq2 -40.5  40.1

The correlations of the residuals
      eq1   eq2
eq1  1.00 -0.95
eq2 -0.95  1.00


W2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ price - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
price    1.006      0.015    66.9   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.734 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 861.48 MSE: 45.341 Root MSE: 6.734 
Multiple R-Squared: -2.213 Adjusted R-Squared: -2.213 


W2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ consump + trend
Instruments: ~farmPrice + trend + income

            Estimate Std. Error t value Pr(>|t|)
(Intercept)  55.5365    46.2668    1.20     0.25
consump       0.4453     0.4622    0.96     0.35
trend        -0.0426     0.2496   -0.17     0.87

Residual standard error: 6.335 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 682.257 MSE: 40.133 Root MSE: 6.335 
Multiple R-Squared: -0.022 Adjusted R-Squared: -0.143 

> fitw2slsS2 <- systemfit(
+    list( consump ~ price - 1, consump ~ trend - 1 ), "W2SLS",
+    data = Kmenta, inst = ~ farmPrice + price + income, useMatrix = useMatrix )
> print( summary( fitw2slsS2 ) )

systemfit results 
method: W2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 38 47456  111148  -87.5      -5.28

     N DF   SSR    MSE  RMSE      R2  Adj R2
eq1 20 19   861   45.3  6.73   -2.21   -2.21
eq2 20 19 46595 2452.3 49.52 -172.79 -172.79

The covariance matrix of the residuals used for estimation
     eq1  eq2
eq1 45.3    0
eq2  0.0 2452

The covariance matrix of the residuals
      eq1     eq2
eq1 45.34   -6.33
eq2 -6.33 2452.34

The correlations of the residuals
        eq1     eq2
eq1  1.0000 -0.0448
eq2 -0.0448  1.0000


W2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ price - 1
Instruments: ~farmPrice + price + income

      Estimate Std. Error t value Pr(>|t|)    
price    1.006      0.015    66.9   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.733 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 861.449 MSE: 45.339 Root MSE: 6.733 
Multiple R-Squared: -2.213 Adjusted R-Squared: -2.213 


W2SLS estimates for 'eq2' (equation 2)
Model Formula: consump ~ trend - 1
Instruments: ~farmPrice + price + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.578      0.934    8.11  1.4e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.521 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 46594.549 MSE: 2452.345 Root MSE: 49.521 
Multiple R-Squared: -172.786 Adjusted R-Squared: -172.786 

> fitw2slsS3 <- systemfit(
+    list( consump ~ trend - 1, price ~ trend - 1 ), "W2SLS",
+    data = Kmenta, inst = instlist, useMatrix = useMatrix )
> print( summary( fitw2slsS3 ) )

systemfit results 
method: W2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 38 97978  687515   -104      -10.6

     N DF   SSR  MSE RMSE     R2 Adj R2
eq1 20 19 50950 2682 51.8 -189.0 -189.0
eq2 20 19 47028 2475 49.8  -69.5  -69.5

The covariance matrix of the residuals used for estimation
     eq1  eq2
eq1 2682    0
eq2    0 2475

The covariance matrix of the residuals
     eq1  eq2
eq1 2682 2439
eq2 2439 2475

The correlations of the residuals
      eq1   eq2
eq1 1.000 0.989
eq2 0.989 1.000


W2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ trend - 1
Instruments: ~income + farmPrice

      Estimate Std. Error t value Pr(>|t|)    
trend     8.65       1.05    8.27    1e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 51.784 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 50949.985 MSE: 2681.578 Root MSE: 51.784 
Multiple R-Squared: -189.031 Adjusted R-Squared: -189.031 


W2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ trend - 1
Instruments: ~income + farmPrice + trend

      Estimate Std. Error t value Pr(>|t|)    
trend    7.318      0.929    7.88  2.1e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.751 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 47028.107 MSE: 2475.164 Root MSE: 49.751 
Multiple R-Squared: -69.48 Adjusted R-Squared: -69.48 

> fitw2slsS4 <- systemfit(
+    list( consump ~ trend - 1, price ~ trend - 1 ), "W2SLS",
+    data = Kmenta, inst = ~ farmPrice + trend + income,
+    restrict.matrix = matrix( c( 1, -1 ), nrow = 1 ), useMatrix = useMatrix )
> print( summary( fitw2slsS4 ) )

systemfit results 
method: W2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 39 93548  111736    -99      -1.03

     N DF   SSR  MSE RMSE     R2 Adj R2
eq1 20 19 46514 2448 49.5 -172.5 -172.5
eq2 20 19 47034 2475 49.8  -69.5  -69.5

The covariance matrix of the residuals used for estimation
     eq1  eq2
eq1 2448    0
eq2    0 2475

The covariance matrix of the residuals
     eq1  eq2
eq1 2448 2439
eq2 2439 2475

The correlations of the residuals
      eq1   eq2
eq1 1.000 0.988
eq2 0.988 1.000


W2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ trend - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.362      0.655    11.2  8.4e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.478 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 46514.224 MSE: 2448.117 Root MSE: 49.478 
Multiple R-Squared: -172.487 Adjusted R-Squared: -172.487 


W2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ trend - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.362      0.655    11.2  8.4e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.754 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 47033.528 MSE: 2475.449 Root MSE: 49.754 
Multiple R-Squared: -69.488 Adjusted R-Squared: -69.488 

> fitw2slsS5 <- systemfit(
+    list( consump ~ 1, price ~ 1 ), "W2SLS",
+    data = Kmenta, inst = instlist, useMatrix = useMatrix )
> print( summary( fitw2slsS5 ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 38 935     491      0          0

     N DF SSR  MSE RMSE R2 Adj R2
eq1 20 19 268 14.1 3.76  0      0
eq2 20 19 667 35.1 5.93  0      0

The covariance matrix of the residuals used for estimation
     eq1  eq2
eq1 14.1  0.0
eq2  0.0 35.1

The covariance matrix of the residuals
      eq1   eq2
eq1 14.11  2.18
eq2  2.18 35.12

The correlations of the residuals
       eq1    eq2
eq1 1.0000 0.0981
eq2 0.0981 1.0000


W2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ 1
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   100.90       0.84     120   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.756 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 268.114 MSE: 14.111 Root MSE: 3.756 
Multiple R-Squared: 0 Adjusted R-Squared: 0 


W2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ 1
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   100.02       1.33    75.5   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5.926 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 667.251 MSE: 35.118 Root MSE: 5.926 
Multiple R-Squared: 0 Adjusted R-Squared: 0 

> 
> 
> ## **************** shorter summaries **********************
> print( summary( fitw2sls1e, residCov = FALSE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    2.97  0.697      0.525

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.3027   12.96  3.1e-10 ***
price        -0.2436     0.0890   -2.74    0.014 *  
income        0.3140     0.0433    7.25  1.3e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.7425    4.61  0.00029 ***
price         0.2401     0.0894    2.69  0.01623 *  
farmPrice     0.2556     0.0423    6.05  1.7e-05 ***
trend         0.2529     0.0891    2.84  0.01188 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> print( summary( fitw2sls2, residCov = FALSE, equations = FALSE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.41  0.692      0.565

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.8 3.93 1.98 0.751  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.3832     8.0090   11.78  1.5e-13 ***
demand_price        -0.2302     0.0946   -2.43  0.02042 *  
demand_income        0.3028     0.0430    7.05  3.9e-08 ***
supply_(Intercept)  48.0494    11.8001    4.07  0.00026 ***
supply_price         0.2430     0.1006    2.42  0.02122 *  
supply_farmPrice     0.2625     0.0459    5.72  2.0e-06 ***
supply_trend         0.3028     0.0430    7.05  3.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fitw2sls3, useDfSys = FALSE ), equations = FALSE )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.41  0.692      0.565

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 66.8 3.93 1.98 0.751  0.721
supply 20 16 98.4 6.15 2.48 0.633  0.564

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.97   0.00
supply   0.00   6.13

The covariance matrix of the residuals
       demand supply
demand   3.93   4.56
supply   4.56   6.15

The correlations of the residuals
       demand supply
demand  1.000  0.927
supply  0.927  1.000


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.3832     8.0090   11.78  1.3e-09 ***
demand_price        -0.2302     0.0946   -2.43  0.02634 *  
demand_income        0.3028     0.0430    7.05  2.0e-06 ***
supply_(Intercept)  48.0494    11.8001    4.07  0.00089 ***
supply_price         0.2430     0.1006    2.42  0.02802 *  
supply_farmPrice     0.2625     0.0459    5.72  3.2e-05 ***
supply_trend         0.3028     0.0430    7.05  2.8e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fitw2sls4e ), residCov = FALSE )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.44   0.69      0.546

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.2 6.26 2.50 0.626  0.556


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3470     5.7579   16.56  < 2e-16 ***
price        -0.2428     0.0621   -3.91  0.00041 ***
income        0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.97 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.945 MSE: 3.879 Root MSE: 1.97 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4366     7.5360    6.16  4.7e-07 ***
price         0.2572     0.0621    4.14  0.00021 ***
farmPrice     0.2642     0.0407    6.48  1.8e-07 ***
trend         0.3059     0.0360    8.49  5.1e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.225 MSE: 6.264 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> 
> print( summary( fitw2sls5, useDfSys = FALSE, residCov = FALSE ) )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.57   0.69      0.575

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  65.9 3.88 1.97 0.754  0.725
supply 20 16 100.3 6.27 2.50 0.626  0.556


W2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.3043     6.3056   15.11  2.7e-11 ***
price        -0.2428     0.0684   -3.55   0.0025 ** 
income        0.3063     0.0394    7.78  5.4e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.969 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.931 MSE: 3.878 Root MSE: 1.969 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


W2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.4229     8.3296    5.57  4.2e-05 ***
price         0.2572     0.0684    3.76   0.0017 ** 
farmPrice     0.2642     0.0455    5.80  2.7e-05 ***
trend         0.3063     0.0394    7.78  8.0e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.503 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.255 MSE: 6.266 Root MSE: 2.503 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> 
> print( summary( fitw2slsd1, useDfSys = TRUE ), residCov = FALSE,
+    equations = FALSE )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 106.7894    11.1435    9.58  4.7e-11 ***
demand_price        -0.4116     0.1448   -2.84  0.00764 ** 
demand_income        0.3617     0.0564    6.41  2.9e-07 ***
supply_(Intercept)  49.5324    12.0105    4.12  0.00024 ***
supply_price         0.2401     0.0999    2.40  0.02208 *  
supply_farmPrice     0.2556     0.0473    5.41  5.5e-06 ***
supply_trend         0.2529     0.0997    2.54  0.01605 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fitw2slsd2e, equations = TRUE ), equations = FALSE )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    3.45   0.69      0.535

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.7 3.81 1.95 0.759  0.730
supply 20 16 101.3 6.33 2.52 0.622  0.551

The covariance matrix of the residuals used for estimation
       demand supply
demand   3.22   0.00
supply   0.00   5.02

The covariance matrix of the residuals
       demand supply
demand   3.24   3.60
supply   3.60   5.06

The correlations of the residuals
       demand supply
demand  1.000  0.888
supply  0.888  1.000


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 104.4638     9.7929   10.67  2.2e-12 ***
demand_price        -0.3630     0.1220   -2.98   0.0053 ** 
demand_income        0.3357     0.0444    7.57  8.6e-09 ***
supply_(Intercept)  47.0706    10.6890    4.40   0.0001 ***
supply_price         0.2449     0.0910    2.69   0.0109 *  
supply_farmPrice     0.2671     0.0416    6.41  2.5e-07 ***
supply_trend         0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fitw2slsd3e, equations = FALSE ), residCov = FALSE )

systemfit results 
method: W2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    3.45   0.69      0.535

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.7 3.81 1.95 0.759  0.730
supply 20 16 101.3 6.33 2.52 0.622  0.551


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 104.4638     9.7929   10.67  2.2e-12 ***
demand_price        -0.3630     0.1220   -2.98   0.0053 ** 
demand_income        0.3357     0.0444    7.57  8.6e-09 ***
supply_(Intercept)  47.0706    10.6890    4.40   0.0001 ***
supply_price         0.2449     0.0910    2.69   0.0109 *  
supply_farmPrice     0.2671     0.0416    6.41  2.5e-07 ***
supply_trend         0.3357     0.0444    7.57  8.6e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> 
> ## ****************** residuals **************************
> print( residuals( fitw2sls1e ) )
   demand  supply
1   0.843 -0.4348
2  -0.698 -1.2131
3   2.359  1.7090
4   1.490  0.7956
5   2.139  1.5942
6   1.277  0.6595
7   1.571  1.4346
8  -3.066 -4.8724
9  -1.125 -2.3975
10  2.492  3.1427
11 -0.108  0.0689
12 -2.292 -1.3978
13 -1.598 -1.1136
14 -0.271  1.1684
15  1.958  3.4865
16 -3.430 -3.8285
17 -0.313  0.6793
18 -2.151 -2.7713
19  1.592  2.6668
20 -0.668  0.6235
> print( residuals( fitw2sls1e$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.843 -0.698  2.359  1.490  2.139  1.277  1.571 -3.066 -1.125  2.492 -0.108 
    12     13     14     15     16     17     18     19     20 
-2.292 -1.598 -0.271  1.958 -3.430 -0.313 -2.151  1.592 -0.668 
> 
> print( residuals( fitw2sls2 ) )
   demand  supply
1   0.726  0.0287
2  -0.754 -0.8185
3   2.304  2.0561
4   1.437  1.0966
5   2.191  1.7764
6   1.317  0.8056
7   1.620  1.5441
8  -3.015 -4.8526
9  -1.087 -2.3957
10  2.513  3.1658
11 -0.265  0.1722
12 -2.506 -1.2753
13 -1.781 -1.0688
14 -0.332  1.1028
15  2.086  3.2370
16 -3.325 -4.1563
17 -0.144  0.2984
18 -2.128 -3.1286
19  1.662  2.2767
20 -0.518  0.1355
> print( residuals( fitw2sls2$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
 0.0287 -0.8185  2.0561  1.0966  1.7764  0.8056  1.5441 -4.8526 -2.3957  3.1658 
     11      12      13      14      15      16      17      18      19      20 
 0.1722 -1.2753 -1.0688  1.1028  3.2370 -4.1563  0.2984 -3.1286  2.2767  0.1355 
> 
> print( residuals( fitw2sls3 ) )
   demand  supply
1   0.726  0.0287
2  -0.754 -0.8185
3   2.304  2.0561
4   1.437  1.0966
5   2.191  1.7764
6   1.317  0.8056
7   1.620  1.5441
8  -3.015 -4.8526
9  -1.087 -2.3957
10  2.513  3.1658
11 -0.265  0.1722
12 -2.506 -1.2753
13 -1.781 -1.0688
14 -0.332  1.1028
15  2.086  3.2370
16 -3.325 -4.1563
17 -0.144  0.2984
18 -2.128 -3.1286
19  1.662  2.2767
20 -0.518  0.1355
> print( residuals( fitw2sls3$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.726 -0.754  2.304  1.437  2.191  1.317  1.620 -3.015 -1.087  2.513 -0.265 
    12     13     14     15     16     17     18     19     20 
-2.506 -1.781 -0.332  2.086 -3.325 -0.144 -2.128  1.662 -0.518 
> 
> print( residuals( fitw2sls4e ) )
   demand  supply
1   0.761  0.0514
2  -0.700 -0.8567
3   2.350  2.0266
4   1.492  1.0504
5   2.159  1.7988
6   1.301  0.8085
7   1.616  1.5253
8  -2.986 -4.9339
9  -1.130 -2.3600
10  2.429  3.2858
11 -0.284  0.2948
12 -2.458 -1.2168
13 -1.705 -1.0756
14 -0.327  1.1348
15  2.007  3.2835
16 -3.368 -4.1646
17 -0.312  0.4480
18 -2.099 -3.2018
19  1.694  2.1807
20 -0.439 -0.0794
> print( residuals( fitw2sls4e$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
 0.0514 -0.8567  2.0266  1.0504  1.7988  0.8085  1.5253 -4.9339 -2.3600  3.2858 
     11      12      13      14      15      16      17      18      19      20 
 0.2948 -1.2168 -1.0756  1.1348  3.2835 -4.1646  0.4480 -3.2018  2.1807 -0.0794 
> 
> print( residuals( fitw2sls5 ) )
   demand  supply
1   0.765  0.0551
2  -0.701 -0.8537
3   2.350  2.0293
4   1.491  1.0527
5   2.158  1.8003
6   1.300  0.8097
7   1.614  1.5262
8  -2.991 -4.9339
9  -1.129 -2.3600
10  2.433  3.2862
11 -0.275  0.2958
12 -2.450 -1.2157
13 -1.700 -1.0752
14 -0.324  1.1344
15  2.005  3.2816
16 -3.371 -4.1672
17 -0.311  0.4452
18 -2.102 -3.2047
19  1.688  2.1776
20 -0.451 -0.0835
> print( residuals( fitw2sls5$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.765 -0.701  2.350  1.491  2.158  1.300  1.614 -2.991 -1.129  2.433 -0.275 
    12     13     14     15     16     17     18     19     20 
-2.450 -1.700 -0.324  2.005 -3.371 -0.311 -2.102  1.688 -0.451 
> 
> print( residuals( fitw2slsd1 ) )
    demand  supply
1   1.3775 -0.4348
2   0.0125 -1.2131
3   2.9728  1.7090
4   2.2121  0.7956
5   1.6920  1.5942
6   1.0407  0.6595
7   1.4768  1.4346
8  -2.7583 -4.8724
9  -1.6807 -2.3975
10  1.4265  3.1427
11 -0.2029  0.0689
12 -1.5123 -1.3978
13 -0.4958 -1.1136
14 -0.1528  1.1684
15  0.8692  3.4865
16 -4.0547 -3.8285
17 -2.5309  0.6793
18 -1.8070 -2.7713
19  1.9299  2.6668
20  0.1853  0.6235
> print( residuals( fitw2slsd1$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
-0.4348 -1.2131  1.7090  0.7956  1.5942  0.6595  1.4346 -4.8724 -2.3975  3.1427 
     11      12      13      14      15      16      17      18      19      20 
 0.0689 -1.3978 -1.1136  1.1684  3.4865 -3.8285  0.6793 -2.7713  2.6668  0.6235 
> 
> print( residuals( fitw2slsd2e ) )
   demand  supply
1   1.100  0.3346
2  -0.192 -0.5581
3   2.785  2.2852
4   2.012  1.2953
5   1.849  1.8966
6   1.145  0.9020
7   1.573  1.6164
8  -2.722 -4.8395
9  -1.531 -2.3946
10  1.629  3.1810
11 -0.448  0.2403
12 -1.988 -1.1944
13 -0.972 -1.0393
14 -0.271  1.0594
15  1.251  3.0723
16 -3.782 -4.3726
17 -1.904  0.0471
18 -1.823 -3.3644
19  1.992  2.0193
20  0.298 -0.1866
> print( residuals( fitw2slsd2e$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 1.100 -0.192  2.785  2.012  1.849  1.145  1.573 -2.722 -1.531  1.629 -0.448 
    12     13     14     15     16     17     18     19     20 
-1.988 -0.972 -0.271  1.251 -3.782 -1.904 -1.823  1.992  0.298 
> 
> print( residuals( fitw2slsd3e ) )
   demand  supply
1   1.100  0.3346
2  -0.192 -0.5581
3   2.785  2.2852
4   2.012  1.2953
5   1.849  1.8966
6   1.145  0.9020
7   1.573  1.6164
8  -2.722 -4.8395
9  -1.531 -2.3946
10  1.629  3.1810
11 -0.448  0.2403
12 -1.988 -1.1944
13 -0.972 -1.0393
14 -0.271  1.0594
15  1.251  3.0723
16 -3.782 -4.3726
17 -1.904  0.0471
18 -1.823 -3.3644
19  1.992  2.0193
20  0.298 -0.1866
> print( residuals( fitw2slsd3e$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
 0.3346 -0.5581  2.2852  1.2953  1.8966  0.9020  1.6164 -4.8395 -2.3946  3.1810 
     11      12      13      14      15      16      17      18      19      20 
 0.2403 -1.1944 -1.0393  1.0594  3.0723 -4.3726  0.0471 -3.3644  2.0193 -0.1866 
> 
> 
> ## *************** coefficients *********************
> print( round( coef( fitw2sls1e ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            94.633             -0.244              0.314             49.532 
      supply_price   supply_farmPrice       supply_trend 
             0.240              0.256              0.253 
> print( round( coef( fitw2sls1e$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     49.532       0.240       0.256       0.253 
> 
> print( round( coef( fitw2slsd2e ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
           104.464             -0.363              0.336             47.071 
      supply_price   supply_farmPrice       supply_trend 
             0.245              0.267              0.336 
> print( round( coef( fitw2slsd2e$eq[[ 1 ]] ), digits = 6 ) )
(Intercept)       price      income 
    104.464      -0.363       0.336 
> 
> print( round( coef( fitw2slsd3e ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
           104.464             -0.363              0.336             47.071 
      supply_price   supply_farmPrice       supply_trend 
             0.245              0.267              0.336 
> print( round( coef( fitw2slsd3e, modified.regMat = TRUE ), digits = 6 ) )
     C1      C2      C3      C4      C5      C6 
104.464  -0.363   0.336  47.071   0.245   0.267 
> print( round( coef( fitw2slsd3e$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     47.071       0.245       0.267       0.336 
> 
> print( round( coef( fitw2sls4 ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            95.304             -0.243              0.306             46.423 
      supply_price   supply_farmPrice       supply_trend 
             0.257              0.264              0.306 
> print( round( coef( fitw2sls4$eq[[ 1 ]] ), digits = 6 ) )
(Intercept)       price      income 
     95.304      -0.243       0.306 
> 
> print( round( coef( fitw2sls5 ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            95.304             -0.243              0.306             46.423 
      supply_price   supply_farmPrice       supply_trend 
             0.257              0.264              0.306 
> print( round( coef( fitw2sls5, modified.regMat = TRUE ), digits = 6 ) )
    C1     C2     C3     C4     C5     C6 
95.304 -0.243  0.306 46.423  0.257  0.264 
> print( round( coef( fitw2sls5$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     46.423       0.257       0.264       0.306 
> 
> 
> ## *************** coefficients with stats *********************
> print( round( coef( summary( fitw2sls1e, useDfSys = FALSE ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   94.633     7.3027   12.96 0.000000
demand_price         -0.244     0.0890   -2.74 0.014016
demand_income         0.314     0.0433    7.25 0.000001
supply_(Intercept)   49.532    10.7425    4.61 0.000289
supply_price          0.240     0.0894    2.69 0.016234
supply_farmPrice      0.256     0.0423    6.05 0.000017
supply_trend          0.253     0.0891    2.84 0.011883
> print( round( coef( summary( fitw2sls1e$eq[[ 2 ]], useDfSys = FALSE ) ),
+    digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   49.532    10.7425    4.61 0.000289
price          0.240     0.0894    2.69 0.016234
farmPrice      0.256     0.0423    6.05 0.000017
trend          0.253     0.0891    2.84 0.011883
> 
> print( round( coef( summary( fitw2slsd2e ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)  104.464     9.7929   10.67  0.00000
demand_price         -0.363     0.1220   -2.98  0.00534
demand_income         0.336     0.0444    7.57  0.00000
supply_(Intercept)   47.071    10.6890    4.40  0.00010
supply_price          0.245     0.0910    2.69  0.01093
supply_farmPrice      0.267     0.0416    6.41  0.00000
supply_trend          0.336     0.0444    7.57  0.00000
> print( round( coef( summary( fitw2slsd2e$eq[[ 1 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)  104.464     9.7929   10.67  0.00000
price         -0.363     0.1220   -2.98  0.00534
income         0.336     0.0444    7.57  0.00000
> 
> print( round( coef( summary( fitw2slsd3e, useDfSys = FALSE ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)  104.464     9.7929   10.67 0.000000
demand_price         -0.363     0.1220   -2.98 0.008475
demand_income         0.336     0.0444    7.57 0.000001
supply_(Intercept)   47.071    10.6890    4.40 0.000444
supply_price          0.245     0.0910    2.69 0.016014
supply_farmPrice      0.267     0.0416    6.41 0.000009
supply_trend          0.336     0.0444    7.57 0.000001
> print( round( coef( summary( fitw2slsd3e, useDfSys = FALSE ),
+    modified.regMat = TRUE ), digits = 6 ) )
   Estimate Std. Error t value Pr(>|t|)
C1  104.464     9.7929   10.67       NA
C2   -0.363     0.1220   -2.98       NA
C3    0.336     0.0444    7.57       NA
C4   47.071    10.6890    4.40       NA
C5    0.245     0.0910    2.69       NA
C6    0.267     0.0416    6.41       NA
> print( round( coef( summary( fitw2slsd3e$eq[[ 2 ]], useDfSys = FALSE ) ),
+    digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   47.071    10.6890    4.40 0.000444
price          0.245     0.0910    2.69 0.016014
farmPrice      0.267     0.0416    6.41 0.000009
trend          0.336     0.0444    7.57 0.000001
> 
> print( round( coef( summary( fitw2sls4 ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   95.304     6.3056   15.11 0.000000
demand_price         -0.243     0.0684   -3.55 0.001128
demand_income         0.306     0.0394    7.78 0.000000
supply_(Intercept)   46.423     8.3296    5.57 0.000003
supply_price          0.257     0.0684    3.76 0.000622
supply_farmPrice      0.264     0.0455    5.80 0.000001
supply_trend          0.306     0.0394    7.78 0.000000
> print( round( coef( summary( fitw2sls4$eq[[ 1 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   95.304     6.3056   15.11  0.00000
price         -0.243     0.0684   -3.55  0.00113
income         0.306     0.0394    7.78  0.00000
> 
> print( round( coef( summary( fitw2sls5 ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   95.304     6.3056   15.11 0.000000
demand_price         -0.243     0.0684   -3.55 0.001128
demand_income         0.306     0.0394    7.78 0.000000
supply_(Intercept)   46.423     8.3296    5.57 0.000003
supply_price          0.257     0.0684    3.76 0.000622
supply_farmPrice      0.264     0.0455    5.80 0.000001
supply_trend          0.306     0.0394    7.78 0.000000
> print( round( coef( summary( fitw2sls5 ), modified.regMat = TRUE ), digits = 6 ) )
   Estimate Std. Error t value Pr(>|t|)
C1   95.304     6.3056   15.11 0.000000
C2   -0.243     0.0684   -3.55 0.001128
C3    0.306     0.0394    7.78 0.000000
C4   46.423     8.3296    5.57 0.000003
C5    0.257     0.0684    3.76 0.000622
C6    0.264     0.0455    5.80 0.000001
> print( round( coef( summary( fitw2sls5$eq[[ 2 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   46.423     8.3296    5.57 0.000003
price          0.257     0.0684    3.76 0.000622
farmPrice      0.264     0.0455    5.80 0.000001
trend          0.306     0.0394    7.78 0.000000
> 
> 
> ## *********** variance covariance matrix of the coefficients *******
> print( round( vcov( fitw2sls1e ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            53.3287     -0.57241       0.04191
demand_price                  -0.5724      0.00791      -0.00225
demand_income                  0.0419     -0.00225       0.00187
supply_(Intercept)             0.0000      0.00000       0.00000
supply_price                   0.0000      0.00000       0.00000
supply_farmPrice               0.0000      0.00000       0.00000
supply_trend                   0.0000      0.00000       0.00000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)              0.000     0.000000         0.000000
demand_price                    0.000     0.000000         0.000000
demand_income                   0.000     0.000000         0.000000
supply_(Intercept)            115.402    -0.876328        -0.259055
supply_price                   -0.876     0.007989         0.000749
supply_farmPrice               -0.259     0.000749         0.001786
supply_trend                   -0.236     0.000463         0.001101
                   supply_trend
demand_(Intercept)     0.000000
demand_price           0.000000
demand_income          0.000000
supply_(Intercept)    -0.236183
supply_price           0.000463
supply_farmPrice       0.001101
supply_trend           0.007945
> print( round( vcov( fitw2sls1e$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)     115.402 -0.876328 -0.259055 -0.236183
price            -0.876  0.007989  0.000749  0.000463
farmPrice        -0.259  0.000749  0.001786  0.001101
trend            -0.236  0.000463  0.001101  0.007945
> 
> print( round( vcov( fitw2sls2 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           64.14482    -0.679629      0.041312
demand_price                 -0.67963     0.008954     -0.002214
demand_income                 0.04131    -0.002214      0.001847
supply_(Intercept)           -1.22810     0.065809     -0.054894
supply_price                  0.00241    -0.000129      0.000108
supply_farmPrice              0.00573    -0.000307      0.000256
supply_trend                  0.04131    -0.002214      0.001847
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -1.2281     0.002409         0.005727
demand_price                   0.0658    -0.000129        -0.000307
demand_income                 -0.0549     0.000108         0.000256
supply_(Intercept)           139.2416    -1.098376        -0.294954
supply_price                  -1.0984     0.010116         0.000884
supply_farmPrice              -0.2950     0.000884         0.002109
supply_trend                  -0.0549     0.000108         0.000256
                   supply_trend
demand_(Intercept)     0.041312
demand_price          -0.002214
demand_income          0.001847
supply_(Intercept)    -0.054894
supply_price           0.000108
supply_farmPrice       0.000256
supply_trend           0.001847
> print( round( vcov( fitw2sls2$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     64.1448 -0.67963  0.04131
price           -0.6796  0.00895 -0.00221
income           0.0413 -0.00221  0.00185
> 
> print( round( vcov( fitw2sls3e ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           54.51421    -0.577209      0.034718
demand_price                 -0.57721     0.007585     -0.001860
demand_income                 0.03472    -0.001860      0.001552
supply_(Intercept)           -1.03208     0.055305     -0.046132
supply_price                  0.00202    -0.000108      0.000090
supply_farmPrice              0.00481    -0.000258      0.000215
supply_trend                  0.03472    -0.001860      0.001552
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -1.0321     0.002024         0.004813
demand_price                   0.0553    -0.000108        -0.000258
demand_income                 -0.0461     0.000090         0.000215
supply_(Intercept)           111.4592    -0.878830        -0.236271
supply_price                  -0.8788     0.008093         0.000708
supply_farmPrice              -0.2363     0.000708         0.001689
supply_trend                  -0.0461     0.000090         0.000215
                   supply_trend
demand_(Intercept)     0.034718
demand_price          -0.001860
demand_income          0.001552
supply_(Intercept)    -0.046132
supply_price           0.000090
supply_farmPrice       0.000215
supply_trend           0.001552
> print( round( vcov( fitw2sls3e, modified.regMat = TRUE ), digits = 6 ) )
         C1        C2        C3       C4        C5        C6
C1 54.51421 -0.577209  0.034718  -1.0321  0.002024  0.004813
C2 -0.57721  0.007585 -0.001860   0.0553 -0.000108 -0.000258
C3  0.03472 -0.001860  0.001552  -0.0461  0.000090  0.000215
C4 -1.03208  0.055305 -0.046132 111.4592 -0.878830 -0.236271
C5  0.00202 -0.000108  0.000090  -0.8788  0.008093  0.000708
C6  0.00481 -0.000258  0.000215  -0.2363  0.000708  0.001689
> print( round( vcov( fitw2sls3e$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)    111.4592 -0.878830 -0.236271 -0.046132
price           -0.8788  0.008093  0.000708  0.000090
farmPrice       -0.2363  0.000708  0.001689  0.000215
trend           -0.0461  0.000090  0.000215  0.001552
> 
> print( round( vcov( fitw2sls4 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            39.7610    -0.358128      -0.03842
demand_price                  -0.3581     0.004681      -0.00113
demand_income                 -0.0384    -0.001129       0.00155
supply_(Intercept)            39.6949    -0.480685       0.08595
supply_price                  -0.3581     0.004681      -0.00113
supply_farmPrice              -0.0359     0.000252       0.00011
supply_trend                  -0.0384    -0.001129       0.00155
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            39.6949    -0.358128        -0.035932
demand_price                  -0.4807     0.004681         0.000252
demand_income                  0.0859    -0.001129         0.000110
supply_(Intercept)            69.3817    -0.480685        -0.226588
supply_price                  -0.4807     0.004681         0.000252
supply_farmPrice              -0.2266     0.000252         0.002072
supply_trend                   0.0859    -0.001129         0.000110
                   supply_trend
demand_(Intercept)     -0.03842
demand_price           -0.00113
demand_income           0.00155
supply_(Intercept)      0.08595
supply_price           -0.00113
supply_farmPrice        0.00011
supply_trend            0.00155
> print( round( vcov( fitw2sls4$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     39.7610 -0.35813 -0.03842
price           -0.3581  0.00468 -0.00113
income          -0.0384 -0.00113  0.00155
> 
> print( round( vcov( fitw2sls5 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            39.7610    -0.358128      -0.03842
demand_price                  -0.3581     0.004681      -0.00113
demand_income                 -0.0384    -0.001129       0.00155
supply_(Intercept)            39.6949    -0.480685       0.08595
supply_price                  -0.3581     0.004681      -0.00113
supply_farmPrice              -0.0359     0.000252       0.00011
supply_trend                  -0.0384    -0.001129       0.00155
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            39.6949    -0.358128        -0.035932
demand_price                  -0.4807     0.004681         0.000252
demand_income                  0.0859    -0.001129         0.000110
supply_(Intercept)            69.3817    -0.480685        -0.226588
supply_price                  -0.4807     0.004681         0.000252
supply_farmPrice              -0.2266     0.000252         0.002072
supply_trend                   0.0859    -0.001129         0.000110
                   supply_trend
demand_(Intercept)     -0.03842
demand_price           -0.00113
demand_income           0.00155
supply_(Intercept)      0.08595
supply_price           -0.00113
supply_farmPrice        0.00011
supply_trend            0.00155
> print( round( vcov( fitw2sls5, modified.regMat = TRUE ), digits = 6 ) )
        C1        C2       C3      C4        C5        C6
C1 39.7610 -0.358128 -0.03842 39.6949 -0.358128 -0.035932
C2 -0.3581  0.004681 -0.00113 -0.4807  0.004681  0.000252
C3 -0.0384 -0.001129  0.00155  0.0859 -0.001129  0.000110
C4 39.6949 -0.480685  0.08595 69.3817 -0.480685 -0.226588
C5 -0.3581  0.004681 -0.00113 -0.4807  0.004681  0.000252
C6 -0.0359  0.000252  0.00011 -0.2266  0.000252  0.002072
> print( round( vcov( fitw2sls5$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice    trend
(Intercept)     69.3817 -0.480685 -0.226588  0.08595
price           -0.4807  0.004681  0.000252 -0.00113
farmPrice       -0.2266  0.000252  0.002072  0.00011
trend            0.0859 -0.001129  0.000110  0.00155
> 
> print( round( vcov( fitw2slsd1 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            124.179     -1.51767       0.28519
demand_price                   -1.518      0.02098      -0.00595
demand_income                   0.285     -0.00595       0.00318
supply_(Intercept)              0.000      0.00000       0.00000
supply_price                    0.000      0.00000       0.00000
supply_farmPrice                0.000      0.00000       0.00000
supply_trend                    0.000      0.00000       0.00000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)              0.000     0.000000         0.000000
demand_price                    0.000     0.000000         0.000000
demand_income                   0.000     0.000000         0.000000
supply_(Intercept)            144.253    -1.095410        -0.323818
supply_price                   -1.095     0.009987         0.000936
supply_farmPrice               -0.324     0.000936         0.002233
supply_trend                   -0.295     0.000579         0.001377
                   supply_trend
demand_(Intercept)     0.000000
demand_price           0.000000
demand_income          0.000000
supply_(Intercept)    -0.295229
supply_price           0.000579
supply_farmPrice       0.001377
supply_trend           0.009931
> print( round( vcov( fitw2slsd1$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     124.179 -1.51767  0.28519
price            -1.518  0.02098 -0.00595
income            0.285 -0.00595  0.00318
> 
> print( round( vcov( fitw2slsd2e ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            95.9017    -1.129212      0.176368
demand_price                  -1.1292     0.014881     -0.003682
demand_income                  0.1764    -0.003682      0.001968
supply_(Intercept)            -5.2430     0.109460     -0.058492
supply_price                   0.0103    -0.000215      0.000115
supply_farmPrice               0.0245    -0.000510      0.000273
supply_trend                   0.1764    -0.003682      0.001968
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -5.2430     0.010284         0.024451
demand_price                   0.1095    -0.000215        -0.000510
demand_income                 -0.0585     0.000115         0.000273
supply_(Intercept)           114.2555    -0.898881        -0.243056
supply_price                  -0.8989     0.008273         0.000727
supply_farmPrice              -0.2431     0.000727         0.001733
supply_trend                  -0.0585     0.000115         0.000273
                   supply_trend
demand_(Intercept)     0.176368
demand_price          -0.003682
demand_income          0.001968
supply_(Intercept)    -0.058492
supply_price           0.000115
supply_farmPrice       0.000273
supply_trend           0.001968
> print( round( vcov( fitw2slsd2e$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)    114.2555 -0.898881 -0.243056 -0.058492
price           -0.8989  0.008273  0.000727  0.000115
farmPrice       -0.2431  0.000727  0.001733  0.000273
trend           -0.0585  0.000115  0.000273  0.001968
> 
> print( round( vcov( fitw2slsd3 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           113.0903    -1.334011      0.210445
demand_price                  -1.3340     0.017622     -0.004394
demand_income                  0.2104    -0.004394      0.002348
supply_(Intercept)            -6.2560     0.130609     -0.069794
supply_price                   0.0123    -0.000256      0.000137
supply_farmPrice               0.0292    -0.000609      0.000325
supply_trend                   0.2104    -0.004394      0.002348
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -6.2560     0.012271         0.029175
demand_price                   0.1306    -0.000256        -0.000609
demand_income                 -0.0698     0.000137         0.000325
supply_(Intercept)           142.7207    -1.123408        -0.303360
supply_price                  -1.1234     0.010341         0.000908
supply_farmPrice              -0.3034     0.000908         0.002165
supply_trend                  -0.0698     0.000137         0.000325
                   supply_trend
demand_(Intercept)     0.210445
demand_price          -0.004394
demand_income          0.002348
supply_(Intercept)    -0.069794
supply_price           0.000137
supply_farmPrice       0.000325
supply_trend           0.002348
> print( round( vcov( fitw2slsd3, modified.regMat = TRUE ), digits = 6 ) )
         C1        C2        C3       C4        C5        C6
C1 113.0903 -1.334011  0.210445  -6.2560  0.012271  0.029175
C2  -1.3340  0.017622 -0.004394   0.1306 -0.000256 -0.000609
C3   0.2104 -0.004394  0.002348  -0.0698  0.000137  0.000325
C4  -6.2560  0.130609 -0.069794 142.7207 -1.123408 -0.303360
C5   0.0123 -0.000256  0.000137  -1.1234  0.010341  0.000908
C6   0.0292 -0.000609  0.000325  -0.3034  0.000908  0.002165
> print( round( vcov( fitw2slsd3$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)      113.09 -1.33401  0.21044
price             -1.33  0.01762 -0.00439
income             0.21 -0.00439  0.00235
> 
> 
> ## *********** confidence intervals of coefficients *************
> print( confint( fitw2sls1e, useDfSys = TRUE ) )
                    2.5 %  97.5 %
demand_(Intercept) 79.776 109.491
demand_price       -0.425  -0.063
demand_income       0.226   0.402
supply_(Intercept) 27.677  71.388
supply_price        0.058   0.422
supply_farmPrice    0.170   0.342
supply_trend        0.072   0.434
> print( confint( fitw2sls1e$eq[[ 1 ]], level = 0.9, useDfSys = TRUE ) )
               5 %    95 %
(Intercept) 82.275 106.992
price       -0.394  -0.093
income       0.241   0.387
> 
> print( confint( fitw2sls2, level = 0.9 ) )
                      5 %    95 %
demand_(Intercept) 78.107 110.660
demand_price       -0.422  -0.038
demand_income       0.215   0.390
supply_(Intercept) 24.069  72.030
supply_price        0.039   0.447
supply_farmPrice    0.169   0.356
supply_trend        0.215   0.390
> print( confint( fitw2sls2$eq[[ 2 ]], level = 0.99 ) )
             0.5 % 99.5 %
(Intercept) 15.854 80.245
price       -0.031  0.517
farmPrice    0.137  0.388
trend        0.186  0.420
> 
> print( confint( fitw2sls3, level = 0.99 ) )
                    0.5 %  99.5 %
demand_(Intercept) 78.107 110.660
demand_price       -0.422  -0.038
demand_income       0.215   0.390
supply_(Intercept) 24.069  72.030
supply_price        0.039   0.447
supply_farmPrice    0.169   0.356
supply_trend        0.215   0.390
> print( confint( fitw2sls3$eq[[ 1 ]], level = 0.5 ) )
              25 %   75 %
(Intercept) 88.923 99.844
price       -0.295 -0.166
income       0.274  0.332
> 
> print( confint( fitw2sls4e, level = 0.5, useDfSys = TRUE ) )
                     25 %    75 %
demand_(Intercept) 83.658 107.036
demand_price       -0.369  -0.117
demand_income       0.233   0.379
supply_(Intercept) 31.138  61.736
supply_price        0.131   0.383
supply_farmPrice    0.181   0.347
supply_trend        0.233   0.379
> print( confint( fitw2sls4e$eq[[ 2 ]], level = 0.25, useDfSys = TRUE ) )
            37.5 % 62.5 %
(Intercept) 44.016 48.857
price        0.237  0.277
farmPrice    0.251  0.277
trend        0.294  0.317
> 
> print( confint( fitw2sls5, level = 0.25 ) )
                   37.5 %  62.5 %
demand_(Intercept) 82.503 108.105
demand_price       -0.382  -0.104
demand_income       0.226   0.386
supply_(Intercept) 29.513  63.333
supply_price        0.118   0.396
supply_farmPrice    0.172   0.357
supply_trend        0.226   0.386
> print( confint( fitw2sls5$eq[[ 1 ]], level = 0.975 ) )
             1.3 %  98.8 %
(Intercept) 80.537 110.072
price       -0.403  -0.083
income       0.214   0.399
> 
> print( confint( fitw2slsd1, level = 0.975 ) )
                    1.3 %  98.8 %
demand_(Intercept) 83.279 130.300
demand_price       -0.717  -0.106
demand_income       0.243   0.481
supply_(Intercept) 24.071  74.994
supply_price        0.028   0.452
supply_farmPrice    0.155   0.356
supply_trend        0.042   0.464
> print( confint( fitw2slsd1$eq[[ 2 ]], level = 0.999 ) )
             0.1 %  100 %
(Intercept)  1.310 97.755
price       -0.161  0.641
farmPrice    0.066  0.445
trend       -0.147  0.653
> 
> print( confint( fitw2slsd2e, level = 0.999, useDfSys = TRUE ) )
                    0.1 %   100 %
demand_(Intercept) 84.562 124.365
demand_price       -0.611  -0.115
demand_income       0.246   0.426
supply_(Intercept) 25.348  68.793
supply_price        0.060   0.430
supply_farmPrice    0.182   0.352
supply_trend        0.246   0.426
> print( confint( fitw2slsd2e$eq[[ 1 ]], level = 0.01, useDfSys = TRUE ) )
             49.5 %  50.5 %
(Intercept) 104.340 104.587
price        -0.365  -0.362
income        0.335   0.336
> 
> print( confint( fitw2slsd3e, level = 0.01, useDfSys = TRUE ) )
                   49.5 %  50.5 %
demand_(Intercept) 84.562 124.365
demand_price       -0.611  -0.115
demand_income       0.246   0.426
supply_(Intercept) 25.348  68.793
supply_price        0.060   0.430
supply_farmPrice    0.182   0.352
supply_trend        0.246   0.426
> print( confint( fitw2slsd3e$eq[[ 2 ]], useDfSys = TRUE ) )
             2.5 % 97.5 %
(Intercept) 25.348 68.793
price        0.060  0.430
farmPrice    0.182  0.352
trend        0.246  0.426
> 
> 
> ## *********** fitted values *************
> print( fitted( fitw2sls1e ) )
   demand supply
1    97.6   98.9
2    99.9  100.4
3    99.8  100.5
4   100.0  100.7
5   102.1  102.6
6   102.0  102.6
7   102.4  102.6
8   103.0  104.8
9   101.5  102.7
10  100.3   99.7
11   95.5   95.4
12   94.7   93.8
13   96.1   95.6
14   99.0   97.6
15  103.8  102.3
16  103.7  104.1
17  103.8  102.8
18  102.1  102.7
19  103.6  102.6
20  106.9  105.6
> print( fitted( fitw2sls1e$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.6  99.9  99.8 100.0 102.1 102.0 102.4 103.0 101.5 100.3  95.5  94.7  96.1 
   14    15    16    17    18    19    20 
 99.0 103.8 103.7 103.8 102.1 103.6 106.9 
> 
> print( fitted( fitw2sls2 ) )
   demand supply
1    97.8   98.5
2    99.9  100.0
3    99.9  100.1
4   100.1  100.4
5   102.0  102.5
6   101.9  102.4
7   102.4  102.4
8   102.9  104.8
9   101.4  102.7
10  100.3   99.7
11   95.7   95.3
12   94.9   93.7
13   96.3   95.6
14   99.1   97.7
15  103.7  102.6
16  103.5  104.4
17  103.7  103.2
18  102.1  103.1
19  103.6  102.9
20  106.8  106.1
> print( fitted( fitw2sls2$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.5 100.0 100.1 100.4 102.5 102.4 102.4 104.8 102.7  99.7  95.3  93.7  95.6 
   14    15    16    17    18    19    20 
 97.7 102.6 104.4 103.2 103.1 102.9 106.1 
> 
> print( fitted( fitw2sls3 ) )
   demand supply
1    97.8   98.5
2    99.9  100.0
3    99.9  100.1
4   100.1  100.4
5   102.0  102.5
6   101.9  102.4
7   102.4  102.4
8   102.9  104.8
9   101.4  102.7
10  100.3   99.7
11   95.7   95.3
12   94.9   93.7
13   96.3   95.6
14   99.1   97.7
15  103.7  102.6
16  103.5  104.4
17  103.7  103.2
18  102.1  103.1
19  103.6  102.9
20  106.8  106.1
> print( fitted( fitw2sls3$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.8  99.9  99.9 100.1 102.0 101.9 102.4 102.9 101.4 100.3  95.7  94.9  96.3 
   14    15    16    17    18    19    20 
 99.1 103.7 103.5 103.7 102.1 103.6 106.8 
> 
> print( fitted( fitw2sls4e ) )
   demand supply
1    97.7   98.4
2    99.9  100.0
3    99.8  100.1
4   100.0  100.5
5   102.1  102.4
6   101.9  102.4
7   102.4  102.5
8   102.9  104.8
9   101.5  102.7
10  100.4   99.5
11   95.7   95.1
12   94.9   93.6
13   96.2   95.6
14   99.1   97.6
15  103.8  102.5
16  103.6  104.4
17  103.8  103.1
18  102.0  103.1
19  103.5  103.0
20  106.7  106.3
> print( fitted( fitw2sls4e$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.4 100.0 100.1 100.5 102.4 102.4 102.5 104.8 102.7  99.5  95.1  93.6  95.6 
   14    15    16    17    18    19    20 
 97.6 102.5 104.4 103.1 103.1 103.0 106.3 
> 
> print( fitted( fitw2sls5 ) )
   demand supply
1    97.7   98.4
2    99.9  100.0
3    99.8  100.1
4   100.0  100.5
5   102.1  102.4
6   101.9  102.4
7   102.4  102.5
8   102.9  104.8
9   101.5  102.7
10  100.4   99.5
11   95.7   95.1
12   94.9   93.6
13   96.2   95.6
14   99.1   97.6
15  103.8  102.5
16  103.6  104.4
17  103.8  103.1
18  102.0  103.1
19  103.5  103.0
20  106.7  106.3
> print( fitted( fitw2sls5$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.7  99.9  99.8 100.0 102.1 101.9 102.4 102.9 101.5 100.4  95.7  94.9  96.2 
   14    15    16    17    18    19    20 
 99.1 103.8 103.6 103.8 102.0 103.5 106.7 
> 
> print( fitted( fitw2slsd1 ) )
   demand supply
1    97.1   98.9
2    99.2  100.4
3    99.2  100.5
4    99.3  100.7
5   102.5  102.6
6   102.2  102.6
7   102.5  102.6
8   102.7  104.8
9   102.0  102.7
10  101.4   99.7
11   95.6   95.4
12   93.9   93.8
13   95.0   95.6
14   98.9   97.6
15  104.9  102.3
16  104.3  104.1
17  106.1  102.8
18  101.7  102.7
19  103.3  102.6
20  106.0  105.6
> print( fitted( fitw2slsd1$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.9 100.4 100.5 100.7 102.6 102.6 102.6 104.8 102.7  99.7  95.4  93.8  95.6 
   14    15    16    17    18    19    20 
 97.6 102.3 104.1 102.8 102.7 102.6 105.6 
> 
> print( fitted( fitw2slsd2e ) )
   demand supply
1    97.4   98.2
2    99.4   99.7
3    99.4   99.9
4    99.5  100.2
5   102.4  102.3
6   102.1  102.3
7   102.4  102.4
8   102.6  104.7
9   101.9  102.7
10  101.2   99.6
11   95.9   95.2
12   94.4   93.6
13   95.5   95.6
14   99.0   97.7
15  104.5  102.7
16  104.0  104.6
17  105.4  103.5
18  101.8  103.3
19  103.2  103.2
20  105.9  106.4
> print( fitted( fitw2slsd2e$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.4  99.4  99.4  99.5 102.4 102.1 102.4 102.6 101.9 101.2  95.9  94.4  95.5 
   14    15    16    17    18    19    20 
 99.0 104.5 104.0 105.4 101.8 103.2 105.9 
> 
> print( fitted( fitw2slsd3e ) )
   demand supply
1    97.4   98.2
2    99.4   99.7
3    99.4   99.9
4    99.5  100.2
5   102.4  102.3
6   102.1  102.3
7   102.4  102.4
8   102.6  104.7
9   101.9  102.7
10  101.2   99.6
11   95.9   95.2
12   94.4   93.6
13   95.5   95.6
14   99.0   97.7
15  104.5  102.7
16  104.0  104.6
17  105.4  103.5
18  101.8  103.3
19  103.2  103.2
20  105.9  106.4
> print( fitted( fitw2slsd3e$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.2  99.7  99.9 100.2 102.3 102.3 102.4 104.7 102.7  99.6  95.2  93.6  95.6 
   14    15    16    17    18    19    20 
 97.7 102.7 104.6 103.5 103.3 103.2 106.4 
> 
> 
> ## *********** predicted values *************
> predictData <- Kmenta
> predictData$consump <- NULL
> predictData$price <- Kmenta$price * 0.9
> predictData$income <- Kmenta$income * 1.1
> 
> print( predict( fitw2sls1e, se.fit = TRUE, interval = "prediction",
+    useDfSys = TRUE ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         97.6         0.609       93.5      101.8        98.9         0.965
2         99.9         0.553       95.7      104.0       100.4         0.952
3         99.8         0.520       95.7      103.9       100.5         0.861
4        100.0         0.558       95.9      104.2       100.7         0.839
5        102.1         0.476       98.0      106.2       102.6         0.818
6        102.0         0.437       97.9      106.1       102.6         0.723
7        102.4         0.454       98.3      106.5       102.6         0.658
8        103.0         0.567       98.8      107.1       104.8         0.889
9        101.5         0.502       97.3      105.6       102.7         0.723
10       100.3         0.758       96.0      104.6        99.7         0.915
11        95.5         0.888       91.2       99.9        95.4         1.098
12        94.7         0.928       90.3       99.1        93.8         1.277
13        96.1         0.844       91.8      100.5        95.6         1.137
14        99.0         0.477       94.9      103.1        97.6         0.820
15       103.8         0.731       99.6      108.1       102.3         0.804
16       103.7         0.587       99.5      107.8       104.1         0.837
17       103.8         1.243       99.1      108.6       102.8         1.489
18       102.1         0.506       97.9      106.2       102.7         0.884
19       103.6         0.641       99.4      107.8       102.6         1.010
20       106.9         1.204      102.2      111.6       105.6         1.550
   supply.lwr supply.upr
1        93.5      104.3
2        95.0      105.8
3        95.2      105.8
4        95.4      106.0
5        97.4      107.9
6        97.4      107.8
7        97.4      107.7
8        99.5      110.1
9        97.5      108.0
10       94.3      105.0
11       89.9      100.8
12       88.2       99.5
13       90.1      101.2
14       92.3      102.9
15       97.1      107.6
16       98.8      109.3
17       97.0      108.7
18       97.4      108.0
19       97.2      108.0
20       99.7      111.5
> print( predict( fitw2sls1e$eq[[ 1 ]], se.fit = TRUE, interval = "prediction",
+    useDfSys = TRUE ) )
     fit se.fit   lwr   upr
1   97.6  0.609  93.5 101.8
2   99.9  0.553  95.7 104.0
3   99.8  0.520  95.7 103.9
4  100.0  0.558  95.9 104.2
5  102.1  0.476  98.0 106.2
6  102.0  0.437  97.9 106.1
7  102.4  0.454  98.3 106.5
8  103.0  0.567  98.8 107.1
9  101.5  0.502  97.3 105.6
10 100.3  0.758  96.0 104.6
11  95.5  0.888  91.2  99.9
12  94.7  0.928  90.3  99.1
13  96.1  0.844  91.8 100.5
14  99.0  0.477  94.9 103.1
15 103.8  0.731  99.6 108.1
16 103.7  0.587  99.5 107.8
17 103.8  1.243  99.1 108.6
18 102.1  0.506  97.9 106.2
19 103.6  0.641  99.4 107.8
20 106.9  1.204 102.2 111.6
> 
> print( predict( fitw2sls2, se.pred = TRUE, interval = "confidence",
+    level = 0.999, newdata = predictData ) )
   demand.pred demand.se.pred demand.lwr demand.upr supply.pred supply.se.pred
1        102.7           2.22       99.1        106        96.0           2.75
2        105.3           2.22      101.7        109        97.5           2.64
3        105.2           2.23      101.5        109        97.6           2.65
4        105.4           2.22      101.9        109        97.9           2.62
5        107.3           2.51      101.8        113       100.1           2.83
6        107.3           2.46      102.0        112       100.0           2.77
7        107.8           2.44      102.7        113       100.0           2.71
8        108.6           2.40      103.7        113       102.2           2.65
9        106.6           2.52      101.0        112       100.4           2.87
10       105.1           2.65       98.8        111        97.4           3.10
11       100.1           2.41       95.2        105        93.0           3.18
12        99.5           2.21       96.0        103        91.3           3.15
13       101.2           2.12       98.5        104        93.1           2.95
14       104.1           2.31       99.8        108        95.3           2.91
15       109.0           2.73      102.3        116       100.2           2.92
16       109.0           2.61      102.9        115       102.0           2.80
17       108.6           3.08      100.1        117       101.1           3.37
18       107.6           2.35      103.0        112       100.5           2.65
19       109.3           2.44      104.2        114       100.4           2.64
20       113.2           2.66      106.8        120       103.3           2.58
   supply.lwr supply.upr
1        91.7      100.3
2        94.2      100.7
3        94.2      101.0
4        94.8      101.0
5        95.1      105.0
6        95.6      104.4
7        96.1      103.9
8        98.8      105.6
9        95.2      105.6
10       90.7      104.1
11       85.9      100.1
12       84.3       98.3
13       87.3       98.9
14       89.7      100.8
15       94.7      105.8
16       97.3      106.6
17       92.9      109.4
18       97.1      103.9
19       97.1      103.6
20      100.7      105.9
> print( predict( fitw2sls2$eq[[ 2 ]], se.pred = TRUE, interval = "confidence",
+    level = 0.999, newdata = predictData ) )
     fit se.pred   lwr   upr
1   96.0    2.75  91.7 100.3
2   97.5    2.64  94.2 100.7
3   97.6    2.65  94.2 101.0
4   97.9    2.62  94.8 101.0
5  100.1    2.83  95.1 105.0
6  100.0    2.77  95.6 104.4
7  100.0    2.71  96.1 103.9
8  102.2    2.65  98.8 105.6
9  100.4    2.87  95.2 105.6
10  97.4    3.10  90.7 104.1
11  93.0    3.18  85.9 100.1
12  91.3    3.15  84.3  98.3
13  93.1    2.95  87.3  98.9
14  95.3    2.91  89.7 100.8
15 100.2    2.92  94.7 105.8
16 102.0    2.80  97.3 106.6
17 101.1    3.37  92.9 109.4
18 100.5    2.65  97.1 103.9
19 100.4    2.64  97.1 103.6
20 103.3    2.58 100.7 105.9
> 
> print( predict( fitw2sls3, se.pred = TRUE, interval = "prediction",
+    level = 0.975 ) )
   demand.pred demand.se.pred demand.lwr demand.upr supply.pred supply.se.pred
1         97.8           2.08       92.9        103        98.5           2.57
2         99.9           2.07       95.1        105       100.0           2.61
3         99.9           2.06       95.0        105       100.1           2.59
4        100.1           2.07       95.2        105       100.4           2.60
5        102.0           2.05       97.2        107       102.5           2.63
6        101.9           2.04       97.1        107       102.4           2.60
7        102.4           2.04       97.6        107       102.4           2.58
8        102.9           2.08       98.0        108       104.8           2.68
9        101.4           2.06       96.6        106       102.7           2.61
10       100.3           2.15       95.3        105        99.7           2.69
11        95.7           2.19       90.6        101        95.3           2.77
12        94.9           2.20       89.8        100        93.7           2.86
13        96.3           2.16       91.2        101        95.6           2.79
14        99.1           2.05       94.3        104        97.7           2.64
15       103.7           2.13       98.7        109       102.6           2.60
16       103.5           2.08       98.7        108       104.4           2.59
17       103.7           2.39       98.1        109       103.2           2.91
18       102.1           2.06       97.2        107       103.1           2.59
19       103.6           2.10       98.6        108       102.9           2.64
20       106.8           2.37      101.2        112       106.1           2.90
   supply.lwr supply.upr
1        92.4        104
2        93.9        106
3        94.0        106
4        94.3        106
5        96.3        109
6        96.3        109
7        96.4        109
8        98.5        111
9        96.6        109
10       93.4        106
11       88.8        102
12       87.0        100
13       89.1        102
14       91.5        104
15       96.5        109
16       98.3        110
17       96.4        110
18       97.0        109
19       96.8        109
20       99.3        113
> print( predict( fitw2sls3$eq[[ 1 ]], se.pred = TRUE, interval = "prediction",
+    level = 0.975 ) )
     fit se.pred   lwr upr
1   97.8    2.08  92.9 103
2   99.9    2.07  95.1 105
3   99.9    2.06  95.0 105
4  100.1    2.07  95.2 105
5  102.0    2.05  97.2 107
6  101.9    2.04  97.1 107
7  102.4    2.04  97.6 107
8  102.9    2.08  98.0 108
9  101.4    2.06  96.6 106
10 100.3    2.15  95.3 105
11  95.7    2.19  90.6 101
12  94.9    2.20  89.8 100
13  96.3    2.16  91.2 101
14  99.1    2.05  94.3 104
15 103.7    2.13  98.7 109
16 103.5    2.08  98.7 108
17 103.7    2.39  98.1 109
18 102.1    2.06  97.2 107
19 103.6    2.10  98.6 108
20 106.8    2.37 101.2 112
> 
> print( predict( fitw2sls4e, se.fit = TRUE, interval = "confidence",
+    level = 0.25, useDfSys = TRUE ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         97.7         0.552       97.5       97.9        98.4         0.611
2         99.9         0.484       99.7      100.0       100.0         0.700
3         99.8         0.465       99.7      100.0       100.1         0.652
4        100.0         0.488       99.9      100.2       100.5         0.664
5        102.1         0.443      101.9      102.2       102.4         0.769
6        101.9         0.425      101.8      102.1       102.4         0.695
7        102.4         0.447      102.2      102.5       102.5         0.639
8        102.9         0.547      102.7      103.1       104.8         0.821
9        101.5         0.458      101.3      101.6       102.7         0.716
10       100.4         0.648      100.2      100.6        99.5         0.743
11        95.7         0.847       95.4       96.0        95.1         0.944
12        94.9         0.823       94.6       95.1        93.6         1.254
13        96.2         0.695       96.0       96.5        95.6         1.154
14        99.1         0.467       98.9       99.2        97.6         0.814
15       103.8         0.590      103.6      104.0       102.5         0.675
16       103.6         0.520      103.4      103.8       104.4         0.659
17       103.8         0.919      103.5      104.1       103.1         1.196
18       102.0         0.487      101.9      102.2       103.1         0.587
19       103.5         0.615      103.3      103.7       103.0         0.664
20       106.7         1.126      106.3      107.0       106.3         0.909
   supply.lwr supply.upr
1        98.2       98.6
2        99.8      100.3
3        99.9      100.3
4       100.2      100.7
5       102.2      102.7
6       102.2      102.7
7       102.3      102.7
8       104.6      105.1
9       102.5      102.9
10       99.3       99.8
11       94.8       95.4
12       93.2       94.0
13       95.2       96.0
14       97.4       97.9
15      102.3      102.7
16      104.2      104.6
17      102.7      103.5
18      102.9      103.3
19      102.8      103.3
20      106.0      106.6
> print( predict( fitw2sls4e$eq[[ 2 ]], se.fit = TRUE, interval = "confidence",
+    level = 0.25, useDfSys = TRUE ) )
     fit se.fit   lwr   upr
1   98.4  0.611  98.2  98.6
2  100.0  0.700  99.8 100.3
3  100.1  0.652  99.9 100.3
4  100.5  0.664 100.2 100.7
5  102.4  0.769 102.2 102.7
6  102.4  0.695 102.2 102.7
7  102.5  0.639 102.3 102.7
8  104.8  0.821 104.6 105.1
9  102.7  0.716 102.5 102.9
10  99.5  0.743  99.3  99.8
11  95.1  0.944  94.8  95.4
12  93.6  1.254  93.2  94.0
13  95.6  1.154  95.2  96.0
14  97.6  0.814  97.4  97.9
15 102.5  0.675 102.3 102.7
16 104.4  0.659 104.2 104.6
17 103.1  1.196 102.7 103.5
18 103.1  0.587 102.9 103.3
19 103.0  0.664 102.8 103.3
20 106.3  0.909 106.0 106.6
> 
> print( predict( fitw2sls5, se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = predictData ) )
   demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1        102.8         0.781           2.12      101.4        104        95.8
2        105.4         0.812           2.13      104.0        107        97.4
3        105.3         0.824           2.13      103.8        107        97.5
4        105.6         0.820           2.13      104.1        107        97.8
5        107.5         1.186           2.30      106.0        109        99.9
6        107.4         1.133           2.27      105.9        109        99.9
7        108.0         1.141           2.28      106.4        110        99.9
8        108.7         1.143           2.28      107.2        110       102.1
9        106.8         1.179           2.30      105.2        108       100.2
10       105.3         1.307           2.36      103.7        107        97.2
11       100.3         1.108           2.26       98.7        102        92.7
12        99.6         0.841           2.14       98.2        101        91.1
13       101.3         0.638           2.07       99.9        103        93.0
14       104.3         0.914           2.17      102.8        106        95.1
15       109.3         1.440           2.44      107.6        111       100.1
16       109.2         1.333           2.38      107.6        111       101.9
17       108.9         1.742           2.63      107.1        111       100.9
18       107.8         1.049           2.23      106.2        109       100.5
19       109.5         1.216           2.31      107.9        111       100.3
20       113.3         1.669           2.58      111.6        115       103.4
   supply.se.fit supply.se.pred supply.lwr supply.upr
1          0.825           2.64       94.1       97.6
2          0.696           2.60       95.6       99.1
3          0.712           2.60       95.7       99.2
4          0.674           2.59       96.0       99.5
5          1.087           2.73       98.1      101.8
6          0.979           2.69       98.0      101.7
7          0.874           2.65       98.1      101.7
8          0.871           2.65      100.3      103.9
9          1.143           2.75       98.4      102.1
10         1.338           2.84       95.3       99.1
11         1.483           2.91       90.8       94.7
12         1.645           3.00       89.1       93.1
13         1.440           2.89       91.0       94.9
14         1.247           2.80       93.2       97.0
15         1.222           2.79       98.2      102.0
16         1.104           2.74      100.0      103.7
17         1.808           3.09       98.7      103.0
18         0.861           2.65       98.7      102.3
19         0.861           2.65       98.5      102.1
20         0.666           2.59      101.6      105.2
> print( predict( fitw2sls5$eq[[ 1 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = predictData ) )
     fit se.fit se.pred   lwr upr
1  102.8  0.781    2.12 101.4 104
2  105.4  0.812    2.13 104.0 107
3  105.3  0.824    2.13 103.8 107
4  105.6  0.820    2.13 104.1 107
5  107.5  1.186    2.30 106.0 109
6  107.4  1.133    2.27 105.9 109
7  108.0  1.141    2.28 106.4 110
8  108.7  1.143    2.28 107.2 110
9  106.8  1.179    2.30 105.2 108
10 105.3  1.307    2.36 103.7 107
11 100.3  1.108    2.26  98.7 102
12  99.6  0.841    2.14  98.2 101
13 101.3  0.638    2.07  99.9 103
14 104.3  0.914    2.17 102.8 106
15 109.3  1.440    2.44 107.6 111
16 109.2  1.333    2.38 107.6 111
17 108.9  1.742    2.63 107.1 111
18 107.8  1.049    2.23 106.2 109
19 109.5  1.216    2.31 107.9 111
20 113.3  1.669    2.58 111.6 115
> 
> print( predict( fitw2slsd1, se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.99 ) )
   demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1         97.1         0.751           2.13       94.9       99.3        98.9
2         99.2         0.757           2.13       97.0      101.4       100.4
3         99.2         0.692           2.11       97.2      101.2       100.5
4         99.3         0.766           2.13       97.1      101.5       100.7
5        102.5         0.595           2.08      100.8      104.3       102.6
6        102.2         0.503           2.05      100.7      103.7       102.6
7        102.5         0.503           2.05      101.1      104.0       102.6
8        102.7         0.653           2.10      100.8      104.5       104.8
9        102.0         0.655           2.10      100.1      103.9       102.7
10       101.4         1.074           2.26       98.3      104.5        99.7
11        95.6         0.978           2.22       92.8       98.5        95.4
12        93.9         1.134           2.29       90.7       97.2        93.8
13        95.0         1.162           2.31       91.7       98.4        95.6
14        98.9         0.530           2.06       97.4      100.4        97.6
15       104.9         1.061           2.26      101.9      108.0       102.3
16       104.3         0.757           2.13      102.1      106.5       104.1
17       106.1         1.963           2.80      100.4      111.7       102.8
18       101.7         0.597           2.08      100.0      103.5       102.7
19       103.3         0.736           2.12      101.2      105.4       102.6
20       106.0         1.430           2.45      101.9      110.2       105.6
   supply.se.fit supply.se.pred supply.lwr supply.upr
1          1.079           2.68       95.8      102.1
2          1.064           2.68       97.3      103.5
3          0.962           2.64       97.6      103.3
4          0.938           2.63       98.0      103.4
5          0.914           2.62      100.0      105.3
6          0.808           2.59      100.2      104.9
7          0.736           2.57      100.4      104.7
8          0.994           2.65      101.9      107.7
9          0.808           2.59      100.4      105.1
10         1.023           2.66       96.7      102.7
11         1.228           2.75       91.8       99.0
12         1.428           2.84       89.7       98.0
13         1.272           2.77       91.9       99.4
14         0.917           2.62       94.9      100.3
15         0.899           2.62       99.7      104.9
16         0.936           2.63      101.3      106.8
17         1.665           2.97       98.0      107.7
18         0.988           2.65       99.8      105.6
19         1.129           2.70       99.3      105.9
20         1.733           3.01      100.5      110.7
> print( predict( fitw2slsd1$eq[[ 2 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.99 ) )
     fit se.fit se.pred   lwr   upr
1   98.9  1.079    2.68  95.8 102.1
2  100.4  1.064    2.68  97.3 103.5
3  100.5  0.962    2.64  97.6 103.3
4  100.7  0.938    2.63  98.0 103.4
5  102.6  0.914    2.62 100.0 105.3
6  102.6  0.808    2.59 100.2 104.9
7  102.6  0.736    2.57 100.4 104.7
8  104.8  0.994    2.65 101.9 107.7
9  102.7  0.808    2.59 100.4 105.1
10  99.7  1.023    2.66  96.7 102.7
11  95.4  1.228    2.75  91.8  99.0
12  93.8  1.428    2.84  89.7  98.0
13  95.6  1.272    2.77  91.9  99.4
14  97.6  0.917    2.62  94.9 100.3
15 102.3  0.899    2.62  99.7 104.9
16 104.1  0.936    2.63 101.3 106.8
17 102.8  1.665    2.97  98.0 107.7
18 102.7  0.988    2.65  99.8 105.6
19 102.6  1.129    2.70  99.3 105.9
20 105.6  1.733    3.01 100.5 110.7
> 
> print( predict( fitw2slsd2e, se.fit = TRUE, interval = "prediction",
+    level = 0.9, newdata = predictData, useDfSys = TRUE ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1          104         1.214      100.1        108        95.7         1.100
2          106         1.169      102.6        110        97.2         0.835
3          106         1.216      102.5        110        97.3         0.864
4          107         1.169      102.7        110        97.6         0.789
5          109         1.897      104.7        114        99.9         1.242
6          109         1.773      104.6        114        99.9         1.115
7          110         1.718      105.2        114        99.9         0.983
8          110         1.552      105.8        114       102.2         0.843
9          109         1.939      104.0        113       100.4         1.310
10         107         2.229      102.5        112        97.4         1.683
11         102         1.655       97.5        106        92.9         1.794
12         101         1.125       96.8        104        91.2         1.750
13         102         0.879       98.5        106        93.1         1.449
14         106         1.480      101.5        110        95.3         1.383
15         111         2.331      106.3        117       100.4         1.395
16         111         2.064      106.3        116       102.2         1.175
17         112         3.001      105.7        118       101.4         2.074
18         109         1.475      104.9        113       100.7         0.861
19         111         1.589      106.5        115       100.6         0.829
20         114         1.756      109.9        119       103.6         0.680
   supply.lwr supply.upr
1        91.1      100.3
2        92.7      101.7
3        92.8      101.8
4        93.2      102.1
5        95.2      104.7
6        95.3      104.6
7        95.3      104.5
8        97.7      106.7
9        95.6      105.2
10       92.3      102.5
11       87.7       98.1
12       86.0       96.4
13       88.1       98.0
14       90.4      100.1
15       95.5      105.3
16       97.5      106.9
17       95.8      106.9
18       96.2      105.2
19       96.1      105.1
20       99.2      108.0
> print( predict( fitw2slsd2e$eq[[ 1 ]], se.fit = TRUE, interval = "prediction",
+    level = 0.9, newdata = predictData, useDfSys = TRUE ) )
   fit se.fit   lwr upr
1  104  1.214 100.1 108
2  106  1.169 102.6 110
3  106  1.216 102.5 110
4  107  1.169 102.7 110
5  109  1.897 104.7 114
6  109  1.773 104.6 114
7  110  1.718 105.2 114
8  110  1.552 105.8 114
9  109  1.939 104.0 113
10 107  2.229 102.5 112
11 102  1.655  97.5 106
12 101  1.125  96.8 104
13 102  0.879  98.5 106
14 106  1.480 101.5 110
15 111  2.331 106.3 117
16 111  2.064 106.3 116
17 112  3.001 105.7 118
18 109  1.475 104.9 113
19 111  1.589 106.5 115
20 114  1.756 109.9 119
> 
> print( predict( fitw2slsd3e, se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.01, useDfSys = TRUE ) )
   demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1         97.4         0.622           2.05       97.4       97.4        98.2
2         99.4         0.654           2.06       99.4       99.4        99.7
3         99.4         0.598           2.04       99.4       99.4        99.9
4         99.5         0.663           2.06       99.5       99.5       100.2
5        102.4         0.515           2.02      102.4      102.4       102.3
6        102.1         0.442           2.00      102.1      102.1       102.3
7        102.4         0.444           2.00      102.4      102.4       102.4
8        102.6         0.587           2.04      102.6      102.6       104.7
9        101.9         0.573           2.03      101.9      101.9       102.7
10       101.2         0.948           2.17      101.2      101.2        99.6
11        95.9         0.849           2.13       95.9       95.9        95.2
12        94.4         0.914           2.15       94.4       94.4        93.6
13        95.5         0.943           2.17       95.5       95.5        95.6
14        99.0         0.464           2.01       99.0       99.1        97.7
15       104.5         0.883           2.14      104.5      104.6       102.7
16       104.0         0.631           2.05      104.0      104.0       104.6
17       105.4         1.665           2.56      105.4      105.5       103.5
18       101.8         0.538           2.02      101.7      101.8       103.3
19       103.2         0.661           2.06      103.2      103.3       103.2
20       105.9         1.284           2.34      105.9      106.0       106.4
   supply.se.fit supply.se.pred supply.lwr supply.upr
1          0.652           2.60       98.1       98.2
2          0.740           2.62       99.7       99.8
3          0.682           2.61       99.8       99.9
4          0.708           2.61      100.2      100.2
5          0.782           2.63      102.3      102.4
6          0.699           2.61      102.3      102.4
7          0.648           2.60      102.3      102.4
8          0.906           2.67      104.7      104.8
9          0.736           2.62      102.7      102.8
10         0.931           2.68       99.6       99.7
11         1.107           2.75       95.2       95.2
12         1.287           2.83       93.6       93.7
13         1.157           2.77       95.5       95.6
14         0.829           2.65       97.7       97.7
15         0.717           2.62      102.7      102.8
16         0.676           2.61      104.6      104.6
17         1.392           2.88      103.4      103.5
18         0.699           2.61      103.3      103.3
19         0.822           2.65      103.2      103.2
20         1.376           2.87      106.4      106.5
> print( predict( fitw2slsd3e$eq[[ 2 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.01, useDfSys = TRUE ) )
     fit se.fit se.pred   lwr   upr
1   98.2  0.652    2.60  98.1  98.2
2   99.7  0.740    2.62  99.7  99.8
3   99.9  0.682    2.61  99.8  99.9
4  100.2  0.708    2.61 100.2 100.2
5  102.3  0.782    2.63 102.3 102.4
6  102.3  0.699    2.61 102.3 102.4
7  102.4  0.648    2.60 102.3 102.4
8  104.7  0.906    2.67 104.7 104.8
9  102.7  0.736    2.62 102.7 102.8
10  99.6  0.931    2.68  99.6  99.7
11  95.2  1.107    2.75  95.2  95.2
12  93.6  1.287    2.83  93.6  93.7
13  95.6  1.157    2.77  95.5  95.6
14  97.7  0.829    2.65  97.7  97.7
15 102.7  0.717    2.62 102.7 102.8
16 104.6  0.676    2.61 104.6 104.6
17 103.5  1.392    2.88 103.4 103.5
18 103.3  0.699    2.61 103.3 103.3
19 103.2  0.822    2.65 103.2 103.2
20 106.4  1.376    2.87 106.4 106.5
> 
> # predict just one observation
> smallData <- data.frame( price = 130, income = 150, farmPrice = 120,
+    trend = 25 )
> 
> print( predict( fitw2sls1e, newdata = smallData ) )
  demand.pred supply.pred
1         110         118
> print( predict( fitw2sls1e$eq[[ 1 ]], newdata = smallData ) )
  fit
1 110
> 
> print( predict( fitw2sls2, se.fit = TRUE, level = 0.9,
+    newdata = smallData ) )
  demand.pred demand.se.fit supply.pred supply.se.fit
1         110          2.52         119          3.53
> print( predict( fitw2sls2$eq[[ 1 ]], se.pred = TRUE, level = 0.99,
+    newdata = smallData ) )
  fit se.pred
1 110    3.21
> 
> print( predict( fitw2sls3, interval = "prediction", level = 0.975,
+    newdata = smallData ) )
  demand.pred demand.lwr demand.upr supply.pred supply.lwr supply.upr
1         110        102        117         119        109        129
> print( predict( fitw2sls3$eq[[ 1 ]], interval = "confidence", level = 0.8,
+    newdata = smallData ) )
  fit lwr upr
1 110 107 113
> 
> print( predict( fitw2sls4e, se.fit = TRUE, interval = "confidence",
+    level = 0.999, newdata = smallData ) )
  demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         110          2.08        102        117         119          2.11
  supply.lwr supply.upr
1        112        127
> print( predict( fitw2sls4e$eq[[ 2 ]], se.pred = TRUE, interval = "prediction",
+    level = 0.75, newdata = smallData ) )
  fit se.pred lwr upr
1 119    3.27 115 123
> 
> print( predict( fitw2sls5, se.fit = TRUE, interval = "prediction",
+    newdata = smallData ) )
  demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         110          2.26        104        116         119          2.33
  supply.lwr supply.upr
1        112        126
> print( predict( fitw2sls5$eq[[ 1 ]], se.pred = TRUE, interval = "confidence",
+    newdata = smallData ) )
  fit se.pred lwr upr
1 110       3 105 114
> 
> print( predict( fitw2slsd2e, se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = smallData ) )
  demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1         108          2.71           3.34        105        110         119
  supply.se.fit supply.se.pred supply.lwr supply.upr
1          3.22           4.08        117        122
> print( predict( fitw2slsd2e$eq[[ 1 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.25, newdata = smallData ) )
  fit se.fit se.pred lwr upr
1 108   2.71    3.34 107 109
> 
> 
> ## ************ correlation of predicted values ***************
> print( correlation.systemfit( fitw2sls1e, 1, 2 ) )
      [,1]
 [1,]    0
 [2,]    0
 [3,]    0
 [4,]    0
 [5,]    0
 [6,]    0
 [7,]    0
 [8,]    0
 [9,]    0
[10,]    0
[11,]    0
[12,]    0
[13,]    0
[14,]    0
[15,]    0
[16,]    0
[17,]    0
[18,]    0
[19,]    0
[20,]    0
> 
> print( correlation.systemfit( fitw2sls2, 2, 1 ) )
           [,1]
 [1,]  0.413453
 [2,]  0.153759
 [3,]  0.152962
 [4,]  0.112671
 [5,] -0.071442
 [6,] -0.053943
 [7,] -0.050961
 [8,] -0.005442
 [9,] -0.000476
[10,] -0.001894
[11,]  0.047351
[12,]  0.064973
[13,]  0.024591
[14,] -0.028036
[15,]  0.175326
[16,]  0.254878
[17,]  0.104540
[18,]  0.065579
[19,]  0.147008
[20,]  0.124593
> 
> print( correlation.systemfit( fitw2sls3, 1, 2 ) )
           [,1]
 [1,]  0.413453
 [2,]  0.153759
 [3,]  0.152962
 [4,]  0.112671
 [5,] -0.071442
 [6,] -0.053943
 [7,] -0.050961
 [8,] -0.005442
 [9,] -0.000476
[10,] -0.001894
[11,]  0.047351
[12,]  0.064973
[13,]  0.024591
[14,] -0.028036
[15,]  0.175326
[16,]  0.254878
[17,]  0.104540
[18,]  0.065579
[19,]  0.147008
[20,]  0.124593
> 
> print( correlation.systemfit( fitw2sls4e, 2, 1 ) )
          [,1]
 [1,]  0.38438
 [2,]  0.30697
 [3,]  0.26690
 [4,]  0.30163
 [5,] -0.02768
 [6,] -0.05086
 [7,] -0.05895
 [8,]  0.10102
 [9,]  0.10072
[10,]  0.45547
[11,]  0.10817
[12,]  0.00552
[13,]  0.04219
[14,] -0.04054
[15,]  0.42100
[16,]  0.24974
[17,]  0.65722
[18,]  0.24286
[19,]  0.34336
[20,]  0.54717
> 
> print( correlation.systemfit( fitw2sls5, 1, 2 ) )
          [,1]
 [1,]  0.38030
 [2,]  0.30892
 [3,]  0.26808
 [4,]  0.30325
 [5,] -0.02730
 [6,] -0.05035
 [7,] -0.05831
 [8,]  0.10036
 [9,]  0.10045
[10,]  0.45492
[11,]  0.10525
[12,]  0.00394
[13,]  0.04171
[14,] -0.04037
[15,]  0.41958
[16,]  0.24706
[17,]  0.65619
[18,]  0.23872
[19,]  0.33729
[20,]  0.54239
> 
> print( correlation.systemfit( fitw2slsd1, 2, 1 ) )
      [,1]
 [1,]    0
 [2,]    0
 [3,]    0
 [4,]    0
 [5,]    0
 [6,]    0
 [7,]    0
 [8,]    0
 [9,]    0
[10,]    0
[11,]    0
[12,]    0
[13,]    0
[14,]    0
[15,]    0
[16,]    0
[17,]    0
[18,]    0
[19,]    0
[20,]    0
> 
> print( correlation.systemfit( fitw2slsd2e, 1, 2 ) )
           [,1]
 [1,]  0.482214
 [2,]  0.253368
 [3,]  0.242824
 [4,]  0.195411
 [5,] -0.107828
 [6,] -0.074958
 [7,] -0.055696
 [8,] -0.002037
 [9,] -0.000921
[10,] -0.008040
[11,]  0.040999
[12,]  0.075418
[13,]  0.029702
[14,] -0.030775
[15,]  0.229063
[16,]  0.318607
[17,]  0.156734
[18,] -0.023016
[19,]  0.068128
[20,]  0.047481
> 
> print( correlation.systemfit( fitw2slsd3e, 2, 1 ) )
           [,1]
 [1,]  0.482214
 [2,]  0.253368
 [3,]  0.242824
 [4,]  0.195411
 [5,] -0.107828
 [6,] -0.074958
 [7,] -0.055696
 [8,] -0.002037
 [9,] -0.000921
[10,] -0.008040
[11,]  0.040999
[12,]  0.075418
[13,]  0.029702
[14,] -0.030775
[15,]  0.229063
[16,]  0.318607
[17,]  0.156734
[18,] -0.023016
[19,]  0.068128
[20,]  0.047481
> 
> 
> ## ************ LOG-Likelihood values ***************
> print( logLik( fitw2sls1e ) )
'log Lik.' -67.6 (df=9)
> 
> print( logLik( fitw2sls2 ) )
'log Lik.' -65.2 (df=8)
> 
> print( logLik( fitw2sls3 ) )
'log Lik.' -65.2 (df=8)
> 
> print( logLik( fitw2sls4e ) )
'log Lik.' -65.7 (df=7)
> 
> print( logLik( fitw2sls5 ) )
'log Lik.' -65.6 (df=7)
> 
> print( logLik( fitw2slsd1 ) )
'log Lik.' -75.1 (df=9)
> 
> print( logLik( fitw2slsd2e ) )
'log Lik.' -69.1 (df=8)
> 
> print( logLik( fitw2slsd3e ) )
'log Lik.' -69.1 (df=8)
> 
> 
> ## ************** F tests ****************
> # testing first restriction
> print( linearHypothesis( fitw2sls1, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.31   0.58
> linearHypothesis( fitw2sls1, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.31   0.58
> 
> print( linearHypothesis( fitw2slsd1e, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2slsd1e

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.92   0.35
> linearHypothesis( fitw2slsd1e, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2slsd1e

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.92   0.35
> 
> # testing second restriction
> restrOnly2m <- matrix(0,1,7)
> restrOnly2q <- 0.5
> restrOnly2m[1,2] <- -1
> restrOnly2m[1,5] <-  1
> restrictOnly2 <- "- demand_price + supply_price = 0.5"
> # first restriction not imposed 
> print( linearHypothesis( fitw2sls1e, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.01   0.91
> linearHypothesis( fitw2sls1e, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.01   0.91
> 
> print( linearHypothesis( fitw2slsd1, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.74   0.39
> linearHypothesis( fitw2slsd1, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.74   0.39
> 
> # first restriction imposed
> print( linearHypothesis( fitw2sls2, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls2

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.04   0.85
> linearHypothesis( fitw2sls2, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls2

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.04   0.85
> 
> print( linearHypothesis( fitw2sls3, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls3

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.04   0.85
> linearHypothesis( fitw2sls3, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls3

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.04   0.85
> 
> print( linearHypothesis( fitw2slsd2e, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd2e

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.42   0.52
> linearHypothesis( fitw2slsd2e, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd2e

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.42   0.52
> 
> print( linearHypothesis( fitw2slsd3e, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd3e

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.42   0.52
> linearHypothesis( fitw2slsd3e, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd3e

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.42   0.52
> 
> # testing both of the restrictions
> print( linearHypothesis( fitw2sls1e, restr2m, restr2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.18   0.84
> linearHypothesis( fitw2sls1e, restrict2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.18   0.84
> 
> print( linearHypothesis( fitw2slsd1, restr2m, restr2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.65   0.53
> linearHypothesis( fitw2slsd1, restrict2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.65   0.53
> 
> 
> ## ************** Wald tests ****************
> # testing first restriction
> print( linearHypothesis( fitw2sls1, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> linearHypothesis( fitw2sls1, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> 
> print( linearHypothesis( fitw2slsd1e, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2slsd1e

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  1.11       0.29
> linearHypothesis( fitw2slsd1e, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fitw2slsd1e

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  1.11       0.29
> 
> # testing second restriction
> # first restriction not imposed
> print( linearHypothesis( fitw2sls1e, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.02        0.9
> linearHypothesis( fitw2sls1e, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.02        0.9
> 
> print( linearHypothesis( fitw2slsd1, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.74       0.39
> linearHypothesis( fitw2slsd1, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.74       0.39
> # first restriction imposed
> print( linearHypothesis( fitw2sls2, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls2

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.04       0.85
> linearHypothesis( fitw2sls2, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls2

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.04       0.85
> 
> print( linearHypothesis( fitw2sls3, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls3

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.04       0.85
> linearHypothesis( fitw2sls3, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls3

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.04       0.85
> 
> print( linearHypothesis( fitw2slsd2e, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd2e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.49       0.48
> linearHypothesis( fitw2slsd2e, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd2e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.49       0.48
> 
> print( linearHypothesis( fitw2slsd3e, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd3e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.49       0.48
> linearHypothesis( fitw2slsd3e, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd3e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.49       0.48
> 
> # testing both of the restrictions
> print( linearHypothesis( fitw2sls1e, restr2m, restr2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2  0.43       0.81
> linearHypothesis( fitw2sls1e, restrict2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2sls1e

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2  0.43       0.81
> 
> print( linearHypothesis( fitw2slsd1, restr2m, restr2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2   1.3       0.52
> linearHypothesis( fitw2slsd1, restrict2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fitw2slsd1

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2   1.3       0.52
> 
> 
> ## ****************** model frame **************************
> print( mf <- model.frame( fitw2sls1e ) )
   consump price income farmPrice trend
1     98.5 100.3   87.4      98.0     1
2     99.2 104.3   97.6      99.1     2
3    102.2 103.4   96.7      99.1     3
4    101.5 104.5   98.2      98.1     4
5    104.2  98.0   99.8     110.8     5
6    103.2  99.5  100.5     108.2     6
7    104.0 101.1  103.2     105.6     7
8     99.9 104.8  107.8     109.8     8
9    100.3  96.4   96.6     108.7     9
10   102.8  91.2   88.9     100.6    10
11    95.4  93.1   75.1      81.0    11
12    92.4  98.8   76.9      68.6    12
13    94.5 102.9   84.6      70.9    13
14    98.8  98.8   90.6      81.4    14
15   105.8  95.1  103.1     102.3    15
16   100.2  98.5  105.1     105.0    16
17   103.5  86.5   96.4     110.5    17
18    99.9 104.0  104.4      92.5    18
19   105.2 105.8  110.7      89.3    19
20   106.2 113.5  127.1      93.0    20
> print( mf1 <- model.frame( fitw2sls1e$eq[[ 1 ]] ) )
   consump price income
1     98.5 100.3   87.4
2     99.2 104.3   97.6
3    102.2 103.4   96.7
4    101.5 104.5   98.2
5    104.2  98.0   99.8
6    103.2  99.5  100.5
7    104.0 101.1  103.2
8     99.9 104.8  107.8
9    100.3  96.4   96.6
10   102.8  91.2   88.9
11    95.4  93.1   75.1
12    92.4  98.8   76.9
13    94.5 102.9   84.6
14    98.8  98.8   90.6
15   105.8  95.1  103.1
16   100.2  98.5  105.1
17   103.5  86.5   96.4
18    99.9 104.0  104.4
19   105.2 105.8  110.7
20   106.2 113.5  127.1
> print( attributes( mf1 )$terms )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> print( mf2 <- model.frame( fitw2sls1e$eq[[ 2 ]] ) )
   consump price farmPrice trend
1     98.5 100.3      98.0     1
2     99.2 104.3      99.1     2
3    102.2 103.4      99.1     3
4    101.5 104.5      98.1     4
5    104.2  98.0     110.8     5
6    103.2  99.5     108.2     6
7    104.0 101.1     105.6     7
8     99.9 104.8     109.8     8
9    100.3  96.4     108.7     9
10   102.8  91.2     100.6    10
11    95.4  93.1      81.0    11
12    92.4  98.8      68.6    12
13    94.5 102.9      70.9    13
14    98.8  98.8      81.4    14
15   105.8  95.1     102.3    15
16   100.2  98.5     105.0    16
17   103.5  86.5     110.5    17
18    99.9 104.0      92.5    18
19   105.2 105.8      89.3    19
20   106.2 113.5      93.0    20
> print( attributes( mf2 )$terms )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> print( all.equal( mf, model.frame( fitw2sls2 ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fitw2sls2$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2sls3 ) ) )
[1] TRUE
> print( all.equal( mf1, model.frame( fitw2sls3$eq[[ 1 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2sls4e ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fitw2sls4e$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2sls5 ) ) )
[1] TRUE
> print( all.equal( mf1, model.frame( fitw2sls5$eq[[ 1 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2slsd1 ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fitw2slsd1$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2slsd2e ) ) )
[1] TRUE
> print( all.equal( mf1, model.frame( fitw2slsd2e$eq[[ 1 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fitw2slsd3e ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fitw2slsd3e$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> fitw2sls1e$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fitw2sls1e$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> fitw2sls4Sym$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fitw2sls4Sym$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> fitw2sls5$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fitw2sls5$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> 
> ## **************** model matrix ************************
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fitw2sls1e$eq[[ 1 ]]$x ) )
[1] TRUE
> print( mm <- model.matrix( fitw2sls1e ) )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1                   1        100.3          87.4                  0
demand_2                   1        104.3          97.6                  0
demand_3                   1        103.4          96.7                  0
demand_4                   1        104.5          98.2                  0
demand_5                   1         98.0          99.8                  0
demand_6                   1         99.5         100.5                  0
demand_7                   1        101.1         103.2                  0
demand_8                   1        104.8         107.8                  0
demand_9                   1         96.4          96.6                  0
demand_10                  1         91.2          88.9                  0
demand_11                  1         93.1          75.1                  0
demand_12                  1         98.8          76.9                  0
demand_13                  1        102.9          84.6                  0
demand_14                  1         98.8          90.6                  0
demand_15                  1         95.1         103.1                  0
demand_16                  1         98.5         105.1                  0
demand_17                  1         86.5          96.4                  0
demand_18                  1        104.0         104.4                  0
demand_19                  1        105.8         110.7                  0
demand_20                  1        113.5         127.1                  0
supply_1                   0          0.0           0.0                  1
supply_2                   0          0.0           0.0                  1
supply_3                   0          0.0           0.0                  1
supply_4                   0          0.0           0.0                  1
supply_5                   0          0.0           0.0                  1
supply_6                   0          0.0           0.0                  1
supply_7                   0          0.0           0.0                  1
supply_8                   0          0.0           0.0                  1
supply_9                   0          0.0           0.0                  1
supply_10                  0          0.0           0.0                  1
supply_11                  0          0.0           0.0                  1
supply_12                  0          0.0           0.0                  1
supply_13                  0          0.0           0.0                  1
supply_14                  0          0.0           0.0                  1
supply_15                  0          0.0           0.0                  1
supply_16                  0          0.0           0.0                  1
supply_17                  0          0.0           0.0                  1
supply_18                  0          0.0           0.0                  1
supply_19                  0          0.0           0.0                  1
supply_20                  0          0.0           0.0                  1
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0            0
demand_2           0.0              0.0            0
demand_3           0.0              0.0            0
demand_4           0.0              0.0            0
demand_5           0.0              0.0            0
demand_6           0.0              0.0            0
demand_7           0.0              0.0            0
demand_8           0.0              0.0            0
demand_9           0.0              0.0            0
demand_10          0.0              0.0            0
demand_11          0.0              0.0            0
demand_12          0.0              0.0            0
demand_13          0.0              0.0            0
demand_14          0.0              0.0            0
demand_15          0.0              0.0            0
demand_16          0.0              0.0            0
demand_17          0.0              0.0            0
demand_18          0.0              0.0            0
demand_19          0.0              0.0            0
demand_20          0.0              0.0            0
supply_1         100.3             98.0            1
supply_2         104.3             99.1            2
supply_3         103.4             99.1            3
supply_4         104.5             98.1            4
supply_5          98.0            110.8            5
supply_6          99.5            108.2            6
supply_7         101.1            105.6            7
supply_8         104.8            109.8            8
supply_9          96.4            108.7            9
supply_10         91.2            100.6           10
supply_11         93.1             81.0           11
supply_12         98.8             68.6           12
supply_13        102.9             70.9           13
supply_14         98.8             81.4           14
supply_15         95.1            102.3           15
supply_16         98.5            105.0           16
supply_17         86.5            110.5           17
supply_18        104.0             92.5           18
supply_19        105.8             89.3           19
supply_20        113.5             93.0           20
> print( mm1 <- model.matrix( fitw2sls1e$eq[[ 1 ]] ) )
   (Intercept) price income
1            1 100.3   87.4
2            1 104.3   97.6
3            1 103.4   96.7
4            1 104.5   98.2
5            1  98.0   99.8
6            1  99.5  100.5
7            1 101.1  103.2
8            1 104.8  107.8
9            1  96.4   96.6
10           1  91.2   88.9
11           1  93.1   75.1
12           1  98.8   76.9
13           1 102.9   84.6
14           1  98.8   90.6
15           1  95.1  103.1
16           1  98.5  105.1
17           1  86.5   96.4
18           1 104.0  104.4
19           1 105.8  110.7
20           1 113.5  127.1
attr(,"assign")
[1] 0 1 2
> print( mm2 <- model.matrix( fitw2sls1e$eq[[ 2 ]] ) )
   (Intercept) price farmPrice trend
1            1 100.3      98.0     1
2            1 104.3      99.1     2
3            1 103.4      99.1     3
4            1 104.5      98.1     4
5            1  98.0     110.8     5
6            1  99.5     108.2     6
7            1 101.1     105.6     7
8            1 104.8     109.8     8
9            1  96.4     108.7     9
10           1  91.2     100.6    10
11           1  93.1      81.0    11
12           1  98.8      68.6    12
13           1 102.9      70.9    13
14           1  98.8      81.4    14
15           1  95.1     102.3    15
16           1  98.5     105.0    16
17           1  86.5     110.5    17
18           1 104.0      92.5    18
19           1 105.8      89.3    19
20           1 113.5      93.0    20
attr(,"assign")
[1] 0 1 2 3
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fitw2sls1 ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls1$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls1$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fitw2sls1$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fitw2sls2e$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fitw2sls2e ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls2e$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls2e$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fitw2sls2Sym ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls2Sym$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls2Sym$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fitw2sls2Sym$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fitw2slsd3$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fitw2slsd3 ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2slsd3$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2slsd3$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fitw2slsd3e ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2slsd3e$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2slsd3e$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fitw2slsd3e$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fitw2sls4$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fitw2sls4 ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls4$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls4$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fitw2sls4e ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls4e$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls4e$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fitw2sls4e$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fitw2sls5$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fitw2sls5 ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls5$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls5$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fitw2sls5e ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fitw2sls5e$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fitw2sls5e$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fitw2sls5e$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # matrices of instrumental variables
> model.matrix( fitw2sls1, which = "z" )
          demand_(Intercept) demand_income demand_farmPrice demand_trend
demand_1                   1          87.4             98.0            1
demand_2                   1          97.6             99.1            2
demand_3                   1          96.7             99.1            3
demand_4                   1          98.2             98.1            4
demand_5                   1          99.8            110.8            5
demand_6                   1         100.5            108.2            6
demand_7                   1         103.2            105.6            7
demand_8                   1         107.8            109.8            8
demand_9                   1          96.6            108.7            9
demand_10                  1          88.9            100.6           10
demand_11                  1          75.1             81.0           11
demand_12                  1          76.9             68.6           12
demand_13                  1          84.6             70.9           13
demand_14                  1          90.6             81.4           14
demand_15                  1         103.1            102.3           15
demand_16                  1         105.1            105.0           16
demand_17                  1          96.4            110.5           17
demand_18                  1         104.4             92.5           18
demand_19                  1         110.7             89.3           19
demand_20                  1         127.1             93.0           20
supply_1                   0           0.0              0.0            0
supply_2                   0           0.0              0.0            0
supply_3                   0           0.0              0.0            0
supply_4                   0           0.0              0.0            0
supply_5                   0           0.0              0.0            0
supply_6                   0           0.0              0.0            0
supply_7                   0           0.0              0.0            0
supply_8                   0           0.0              0.0            0
supply_9                   0           0.0              0.0            0
supply_10                  0           0.0              0.0            0
supply_11                  0           0.0              0.0            0
supply_12                  0           0.0              0.0            0
supply_13                  0           0.0              0.0            0
supply_14                  0           0.0              0.0            0
supply_15                  0           0.0              0.0            0
supply_16                  0           0.0              0.0            0
supply_17                  0           0.0              0.0            0
supply_18                  0           0.0              0.0            0
supply_19                  0           0.0              0.0            0
supply_20                  0           0.0              0.0            0
          supply_(Intercept) supply_income supply_farmPrice supply_trend
demand_1                   0           0.0              0.0            0
demand_2                   0           0.0              0.0            0
demand_3                   0           0.0              0.0            0
demand_4                   0           0.0              0.0            0
demand_5                   0           0.0              0.0            0
demand_6                   0           0.0              0.0            0
demand_7                   0           0.0              0.0            0
demand_8                   0           0.0              0.0            0
demand_9                   0           0.0              0.0            0
demand_10                  0           0.0              0.0            0
demand_11                  0           0.0              0.0            0
demand_12                  0           0.0              0.0            0
demand_13                  0           0.0              0.0            0
demand_14                  0           0.0              0.0            0
demand_15                  0           0.0              0.0            0
demand_16                  0           0.0              0.0            0
demand_17                  0           0.0              0.0            0
demand_18                  0           0.0              0.0            0
demand_19                  0           0.0              0.0            0
demand_20                  0           0.0              0.0            0
supply_1                   1          87.4             98.0            1
supply_2                   1          97.6             99.1            2
supply_3                   1          96.7             99.1            3
supply_4                   1          98.2             98.1            4
supply_5                   1          99.8            110.8            5
supply_6                   1         100.5            108.2            6
supply_7                   1         103.2            105.6            7
supply_8                   1         107.8            109.8            8
supply_9                   1          96.6            108.7            9
supply_10                  1          88.9            100.6           10
supply_11                  1          75.1             81.0           11
supply_12                  1          76.9             68.6           12
supply_13                  1          84.6             70.9           13
supply_14                  1          90.6             81.4           14
supply_15                  1         103.1            102.3           15
supply_16                  1         105.1            105.0           16
supply_17                  1          96.4            110.5           17
supply_18                  1         104.4             92.5           18
supply_19                  1         110.7             89.3           19
supply_20                  1         127.1             93.0           20
> model.matrix( fitw2sls1$eq[[ 1 ]], which = "z" )
   (Intercept) income farmPrice trend
1            1   87.4      98.0     1
2            1   97.6      99.1     2
3            1   96.7      99.1     3
4            1   98.2      98.1     4
5            1   99.8     110.8     5
6            1  100.5     108.2     6
7            1  103.2     105.6     7
8            1  107.8     109.8     8
9            1   96.6     108.7     9
10           1   88.9     100.6    10
11           1   75.1      81.0    11
12           1   76.9      68.6    12
13           1   84.6      70.9    13
14           1   90.6      81.4    14
15           1  103.1     102.3    15
16           1  105.1     105.0    16
17           1   96.4     110.5    17
18           1  104.4      92.5    18
19           1  110.7      89.3    19
20           1  127.1      93.0    20
attr(,"assign")
[1] 0 1 2 3
> model.matrix( fitw2sls1$eq[[ 2 ]], which = "z" )
   (Intercept) income farmPrice trend
1            1   87.4      98.0     1
2            1   97.6      99.1     2
3            1   96.7      99.1     3
4            1   98.2      98.1     4
5            1   99.8     110.8     5
6            1  100.5     108.2     6
7            1  103.2     105.6     7
8            1  107.8     109.8     8
9            1   96.6     108.7     9
10           1   88.9     100.6    10
11           1   75.1      81.0    11
12           1   76.9      68.6    12
13           1   84.6      70.9    13
14           1   90.6      81.4    14
15           1  103.1     102.3    15
16           1  105.1     105.0    16
17           1   96.4     110.5    17
18           1  104.4      92.5    18
19           1  110.7      89.3    19
20           1  127.1      93.0    20
attr(,"assign")
[1] 0 1 2 3
> 
> # matrices of fitted regressors
> model.matrix( fitw2sls5e, which = "xHat" )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1                   1         99.6          87.4                  0
demand_2                   1        105.1          97.6                  0
demand_3                   1        103.8          96.7                  0
demand_4                   1        104.5          98.2                  0
demand_5                   1         98.7          99.8                  0
demand_6                   1         99.6         100.5                  0
demand_7                   1        102.0         103.2                  0
demand_8                   1        102.2         107.8                  0
demand_9                   1         94.6          96.6                  0
demand_10                  1         92.7          88.9                  0
demand_11                  1         92.4          75.1                  0
demand_12                  1         98.9          76.9                  0
demand_13                  1        102.2          84.6                  0
demand_14                  1        100.3          90.6                  0
demand_15                  1         97.6         103.1                  0
demand_16                  1         96.9         105.1                  0
demand_17                  1         87.7          96.4                  0
demand_18                  1        101.1         104.4                  0
demand_19                  1        106.1         110.7                  0
demand_20                  1        114.4         127.1                  0
supply_1                   0          0.0           0.0                  1
supply_2                   0          0.0           0.0                  1
supply_3                   0          0.0           0.0                  1
supply_4                   0          0.0           0.0                  1
supply_5                   0          0.0           0.0                  1
supply_6                   0          0.0           0.0                  1
supply_7                   0          0.0           0.0                  1
supply_8                   0          0.0           0.0                  1
supply_9                   0          0.0           0.0                  1
supply_10                  0          0.0           0.0                  1
supply_11                  0          0.0           0.0                  1
supply_12                  0          0.0           0.0                  1
supply_13                  0          0.0           0.0                  1
supply_14                  0          0.0           0.0                  1
supply_15                  0          0.0           0.0                  1
supply_16                  0          0.0           0.0                  1
supply_17                  0          0.0           0.0                  1
supply_18                  0          0.0           0.0                  1
supply_19                  0          0.0           0.0                  1
supply_20                  0          0.0           0.0                  1
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0            0
demand_2           0.0              0.0            0
demand_3           0.0              0.0            0
demand_4           0.0              0.0            0
demand_5           0.0              0.0            0
demand_6           0.0              0.0            0
demand_7           0.0              0.0            0
demand_8           0.0              0.0            0
demand_9           0.0              0.0            0
demand_10          0.0              0.0            0
demand_11          0.0              0.0            0
demand_12          0.0              0.0            0
demand_13          0.0              0.0            0
demand_14          0.0              0.0            0
demand_15          0.0              0.0            0
demand_16          0.0              0.0            0
demand_17          0.0              0.0            0
demand_18          0.0              0.0            0
demand_19          0.0              0.0            0
demand_20          0.0              0.0            0
supply_1          99.6             98.0            1
supply_2         105.1             99.1            2
supply_3         103.8             99.1            3
supply_4         104.5             98.1            4
supply_5          98.7            110.8            5
supply_6          99.6            108.2            6
supply_7         102.0            105.6            7
supply_8         102.2            109.8            8
supply_9          94.6            108.7            9
supply_10         92.7            100.6           10
supply_11         92.4             81.0           11
supply_12         98.9             68.6           12
supply_13        102.2             70.9           13
supply_14        100.3             81.4           14
supply_15         97.6            102.3           15
supply_16         96.9            105.0           16
supply_17         87.7            110.5           17
supply_18        101.1             92.5           18
supply_19        106.1             89.3           19
supply_20        114.4             93.0           20
> model.matrix( fitw2sls5e$eq[[ 1 ]], which = "xHat" )
   (Intercept) price income
1            1  99.6   87.4
2            1 105.1   97.6
3            1 103.8   96.7
4            1 104.5   98.2
5            1  98.7   99.8
6            1  99.6  100.5
7            1 102.0  103.2
8            1 102.2  107.8
9            1  94.6   96.6
10           1  92.7   88.9
11           1  92.4   75.1
12           1  98.9   76.9
13           1 102.2   84.6
14           1 100.3   90.6
15           1  97.6  103.1
16           1  96.9  105.1
17           1  87.7   96.4
18           1 101.1  104.4
19           1 106.1  110.7
20           1 114.4  127.1
> model.matrix( fitw2sls5e$eq[[ 2 ]], which = "xHat" )
   (Intercept) price farmPrice trend
1            1  99.6      98.0     1
2            1 105.1      99.1     2
3            1 103.8      99.1     3
4            1 104.5      98.1     4
5            1  98.7     110.8     5
6            1  99.6     108.2     6
7            1 102.0     105.6     7
8            1 102.2     109.8     8
9            1  94.6     108.7     9
10           1  92.7     100.6    10
11           1  92.4      81.0    11
12           1  98.9      68.6    12
13           1 102.2      70.9    13
14           1 100.3      81.4    14
15           1  97.6     102.3    15
16           1  96.9     105.0    16
17           1  87.7     110.5    17
18           1 101.1      92.5    18
19           1 106.1      89.3    19
20           1 114.4      93.0    20
> 
> 
> ## **************** formulas ************************
> formula( fitw2sls1e )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2sls1e$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fitw2sls2 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2sls2$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fitw2sls3 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2sls3$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fitw2sls4e )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2sls4e$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fitw2sls5 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2sls5$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fitw2slsd1 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2slsd1$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fitw2slsd2e )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2slsd2e$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fitw2slsd3e )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fitw2slsd3e$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> 
> ## **************** model terms *******************
> terms( fitw2sls1e )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2sls1e$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fitw2sls2 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2sls2$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fitw2sls3 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2sls3$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fitw2sls4e )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2sls4e$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fitw2sls5 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2sls5$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fitw2slsd1 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2slsd1$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fitw2slsd2e )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2slsd2e$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fitw2slsd3e )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fitw2slsd3e$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> 
> ## **************** terms of instruments *******************
> fitw2sls1e$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2sls2$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2sls3$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2sls4e$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2sls5$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2slsd1$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fitw2slsd2e$eq[[ 1 ]]$termsInst
~income + farmPrice
attr(,"variables")
list(income, farmPrice)
attr(,"factors")
          income farmPrice
income         1         0
farmPrice      0         1
attr(,"term.labels")
[1] "income"    "farmPrice"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice)
attr(,"dataClasses")
   income farmPrice 
"numeric" "numeric" 
> 
> fitw2slsd3e$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> 
> ## **************** estfun ************************
> library( "sandwich" )
> 
> estfun( fitw2sls1 )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1             0.17426       17.362        15.231             0.0000
demand_2            -0.12666      -13.314       -12.362             0.0000
demand_3             0.63211       65.603        61.125             0.0000
demand_4             0.38686       40.439        37.990             0.0000
demand_5             0.59421       58.619        59.302             0.0000
demand_6             0.34231       34.111        34.403             0.0000
demand_7             0.46340       47.253        47.822             0.0000
demand_8            -0.95225      -97.353      -102.653             0.0000
demand_9            -0.40681      -38.486       -39.297             0.0000
demand_10            0.73846       68.469        65.649             0.0000
demand_11           -0.07078       -6.540        -5.315             0.0000
demand_12           -0.58541      -57.907       -45.018             0.0000
demand_13           -0.46025      -47.020       -38.937             0.0000
demand_14            0.02562        2.569         2.322             0.0000
demand_15            0.66403       64.824        68.462             0.0000
demand_16           -0.98546      -95.483      -103.572             0.0000
demand_17           -0.00533       -0.468        -0.514             0.0000
demand_18           -0.74266      -75.053       -77.534             0.0000
demand_19            0.43017       45.625        47.620             0.0000
demand_20           -0.11583      -13.250       -14.722             0.0000
supply_1             0.00000        0.000         0.000            -0.0444
supply_2             0.00000        0.000         0.000            -0.2348
supply_3             0.00000        0.000         0.000             0.2691
supply_4             0.00000        0.000         0.000             0.1308
supply_5             0.00000        0.000         0.000             0.2381
supply_6             0.00000        0.000         0.000             0.1015
supply_7             0.00000        0.000         0.000             0.2015
supply_8             0.00000        0.000         0.000            -0.7062
supply_9             0.00000        0.000         0.000            -0.3238
supply_10            0.00000        0.000         0.000             0.4611
supply_11            0.00000        0.000         0.000             0.0385
supply_12            0.00000        0.000         0.000            -0.2360
supply_13            0.00000        0.000         0.000            -0.1548
supply_14            0.00000        0.000         0.000             0.1330
supply_15            0.00000        0.000         0.000             0.4778
supply_16            0.00000        0.000         0.000            -0.5719
supply_17            0.00000        0.000         0.000             0.0648
supply_18            0.00000        0.000         0.000            -0.3413
supply_19            0.00000        0.000         0.000             0.4299
supply_20            0.00000        0.000         0.000             0.0672
          supply_price supply_farmPrice supply_trend
demand_1          0.00             0.00       0.0000
demand_2          0.00             0.00       0.0000
demand_3          0.00             0.00       0.0000
demand_4          0.00             0.00       0.0000
demand_5          0.00             0.00       0.0000
demand_6          0.00             0.00       0.0000
demand_7          0.00             0.00       0.0000
demand_8          0.00             0.00       0.0000
demand_9          0.00             0.00       0.0000
demand_10         0.00             0.00       0.0000
demand_11         0.00             0.00       0.0000
demand_12         0.00             0.00       0.0000
demand_13         0.00             0.00       0.0000
demand_14         0.00             0.00       0.0000
demand_15         0.00             0.00       0.0000
demand_16         0.00             0.00       0.0000
demand_17         0.00             0.00       0.0000
demand_18         0.00             0.00       0.0000
demand_19         0.00             0.00       0.0000
demand_20         0.00             0.00       0.0000
supply_1         -4.42            -4.35      -0.0444
supply_2        -24.68           -23.27      -0.4696
supply_3         27.93            26.67       0.8073
supply_4         13.67            12.83       0.5230
supply_5         23.49            26.38       1.1905
supply_6         10.12            10.99       0.6093
supply_7         20.55            21.28       1.4107
supply_8        -72.20           -77.54      -5.6498
supply_9        -30.64           -35.20      -2.9145
supply_10        42.75            46.39       4.6109
supply_11         3.56             3.12       0.4235
supply_12       -23.35           -16.19      -2.8326
supply_13       -15.81           -10.97      -2.0121
supply_14        13.34            10.83       1.8621
supply_15        46.64            48.88       7.1671
supply_16       -55.42           -60.05      -9.1508
supply_17         5.68             7.16       1.1011
supply_18       -34.49           -31.57      -6.1438
supply_19        45.59            38.39       8.1674
supply_20         7.69             6.25       1.3448
> round( colSums( estfun( fitw2sls1 ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> estfun( fitw2sls1e )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1             0.20502        20.43        17.918             0.0000
demand_2            -0.14901       -15.66       -14.543             0.0000
demand_3             0.74366        77.18        71.912             0.0000
demand_4             0.45513        47.57        44.694             0.0000
demand_5             0.69907        68.96        69.767             0.0000
demand_6             0.40272        40.13        40.474             0.0000
demand_7             0.54517        55.59        56.262             0.0000
demand_8            -1.12030      -114.53      -120.768             0.0000
demand_9            -0.47860       -45.28       -46.232             0.0000
demand_10            0.86877        80.55        77.234             0.0000
demand_11           -0.08327        -7.69        -6.253             0.0000
demand_12           -0.68871       -68.13       -52.962             0.0000
demand_13           -0.54147       -55.32       -45.808             0.0000
demand_14            0.03015         3.02         2.731             0.0000
demand_15            0.78121        76.26        80.543             0.0000
demand_16           -1.15937      -112.33      -121.850             0.0000
demand_17           -0.00627        -0.55        -0.605             0.0000
demand_18           -0.87372       -88.30       -91.217             0.0000
demand_19            0.50608        53.68        56.023             0.0000
demand_20           -0.13627       -15.59       -17.320             0.0000
supply_1             0.00000         0.00         0.000            -0.0554
supply_2             0.00000         0.00         0.000            -0.2935
supply_3             0.00000         0.00         0.000             0.3364
supply_4             0.00000         0.00         0.000             0.1634
supply_5             0.00000         0.00         0.000             0.2976
supply_6             0.00000         0.00         0.000             0.1269
supply_7             0.00000         0.00         0.000             0.2519
supply_8             0.00000         0.00         0.000            -0.8828
supply_9             0.00000         0.00         0.000            -0.4048
supply_10            0.00000         0.00         0.000             0.5764
supply_11            0.00000         0.00         0.000             0.0481
supply_12            0.00000         0.00         0.000            -0.2951
supply_13            0.00000         0.00         0.000            -0.1935
supply_14            0.00000         0.00         0.000             0.1663
supply_15            0.00000         0.00         0.000             0.5973
supply_16            0.00000         0.00         0.000            -0.7149
supply_17            0.00000         0.00         0.000             0.0810
supply_18            0.00000         0.00         0.000            -0.4267
supply_19            0.00000         0.00         0.000             0.5373
supply_20            0.00000         0.00         0.000             0.0841
          supply_price supply_farmPrice supply_trend
demand_1          0.00             0.00       0.0000
demand_2          0.00             0.00       0.0000
demand_3          0.00             0.00       0.0000
demand_4          0.00             0.00       0.0000
demand_5          0.00             0.00       0.0000
demand_6          0.00             0.00       0.0000
demand_7          0.00             0.00       0.0000
demand_8          0.00             0.00       0.0000
demand_9          0.00             0.00       0.0000
demand_10         0.00             0.00       0.0000
demand_11         0.00             0.00       0.0000
demand_12         0.00             0.00       0.0000
demand_13         0.00             0.00       0.0000
demand_14         0.00             0.00       0.0000
demand_15         0.00             0.00       0.0000
demand_16         0.00             0.00       0.0000
demand_17         0.00             0.00       0.0000
demand_18         0.00             0.00       0.0000
demand_19         0.00             0.00       0.0000
demand_20         0.00             0.00       0.0000
supply_1         -5.52            -5.43      -0.0554
supply_2        -30.85           -29.09      -0.5870
supply_3         34.91            33.33       1.0091
supply_4         17.09            16.03       0.6538
supply_5         29.36            32.98       1.4882
supply_6         12.65            13.73       0.7616
supply_7         25.69            26.60       1.7633
supply_8        -90.25           -96.93      -7.0623
supply_9        -38.30           -44.00      -3.6431
supply_10        53.44            57.98       5.7636
supply_11         4.45             3.90       0.5294
supply_12       -29.19           -20.24      -3.5407
supply_13       -19.77           -13.72      -2.5151
supply_14        16.67            13.53       2.3277
supply_15        58.30            61.10       8.9588
supply_16       -69.27           -75.07     -11.4386
supply_17         7.10             8.95       1.3763
supply_18       -43.12           -39.47      -7.6797
supply_19        56.99            47.98      10.2092
supply_20         9.62             7.82       1.6810
> round( colSums( estfun( fitw2sls1e ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> estfun( fitw2slsd1e )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1             -0.2141       -20.39        -18.71             0.0000
demand_2             -0.5971       -59.32        -58.28             0.0000
demand_3              0.3342        33.06         32.31             0.0000
demand_4              0.0923         9.21          9.06             0.0000
demand_5              0.3748        36.34         37.40             0.0000
demand_6              0.1317        12.91         13.23             0.0000
demand_7              0.2982        29.80         30.78             0.0000
demand_8             -1.3110      -132.05       -141.32             0.0000
demand_9             -0.5322       -51.18        -51.41             0.0000
demand_10             0.8995        85.57         79.97             0.0000
demand_11             0.1399        13.25         10.51             0.0000
demand_12            -0.4189       -41.49        -32.21             0.0000
demand_13            -0.2903       -29.54        -24.56             0.0000
demand_14             0.2709        27.46         24.55             0.0000
demand_15             0.9535        96.13         98.30             0.0000
demand_16            -0.9012       -90.95        -94.71             0.0000
demand_17             0.3566        34.08         34.37             0.0000
demand_18            -0.5159       -53.75        -53.86             0.0000
demand_19             0.8239        88.84         91.20             0.0000
demand_20             0.1054        12.00         13.39             0.0000
supply_1              0.0000         0.00          0.00            -0.0554
supply_2              0.0000         0.00          0.00            -0.2935
supply_3              0.0000         0.00          0.00             0.3364
supply_4              0.0000         0.00          0.00             0.1634
supply_5              0.0000         0.00          0.00             0.2976
supply_6              0.0000         0.00          0.00             0.1269
supply_7              0.0000         0.00          0.00             0.2519
supply_8              0.0000         0.00          0.00            -0.8828
supply_9              0.0000         0.00          0.00            -0.4048
supply_10             0.0000         0.00          0.00             0.5764
supply_11             0.0000         0.00          0.00             0.0481
supply_12             0.0000         0.00          0.00            -0.2951
supply_13             0.0000         0.00          0.00            -0.1935
supply_14             0.0000         0.00          0.00             0.1663
supply_15             0.0000         0.00          0.00             0.5973
supply_16             0.0000         0.00          0.00            -0.7149
supply_17             0.0000         0.00          0.00             0.0810
supply_18             0.0000         0.00          0.00            -0.4267
supply_19             0.0000         0.00          0.00             0.5373
supply_20             0.0000         0.00          0.00             0.0841
          supply_price supply_farmPrice supply_trend
demand_1          0.00             0.00       0.0000
demand_2          0.00             0.00       0.0000
demand_3          0.00             0.00       0.0000
demand_4          0.00             0.00       0.0000
demand_5          0.00             0.00       0.0000
demand_6          0.00             0.00       0.0000
demand_7          0.00             0.00       0.0000
demand_8          0.00             0.00       0.0000
demand_9          0.00             0.00       0.0000
demand_10         0.00             0.00       0.0000
demand_11         0.00             0.00       0.0000
demand_12         0.00             0.00       0.0000
demand_13         0.00             0.00       0.0000
demand_14         0.00             0.00       0.0000
demand_15         0.00             0.00       0.0000
demand_16         0.00             0.00       0.0000
demand_17         0.00             0.00       0.0000
demand_18         0.00             0.00       0.0000
demand_19         0.00             0.00       0.0000
demand_20         0.00             0.00       0.0000
supply_1         -5.52            -5.43      -0.0554
supply_2        -30.85           -29.09      -0.5870
supply_3         34.91            33.33       1.0091
supply_4         17.09            16.03       0.6538
supply_5         29.36            32.98       1.4882
supply_6         12.65            13.73       0.7616
supply_7         25.69            26.60       1.7633
supply_8        -90.25           -96.93      -7.0623
supply_9        -38.30           -44.00      -3.6431
supply_10        53.44            57.98       5.7636
supply_11         4.45             3.90       0.5294
supply_12       -29.19           -20.24      -3.5407
supply_13       -19.77           -13.72      -2.5151
supply_14        16.67            13.53       2.3277
supply_15        58.30            61.10       8.9588
supply_16       -69.27           -75.07     -11.4386
supply_17         7.10             8.95       1.3763
supply_18       -43.12           -39.47      -7.6797
supply_19        56.99            47.98      10.2092
supply_20         9.62             7.82       1.6810
> round( colSums( estfun( fitw2slsd1e ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> 
> ## **************** bread ************************
> bread( fitw2sls1 )
     demand_(Intercept) demand_price demand_income supply_(Intercept)
[1,]            2509.59      -26.937        1.9721                0.0
[2,]             -26.94        0.372       -0.1057                0.0
[3,]               1.97       -0.106        0.0881                0.0
[4,]               0.00        0.000        0.0000             5770.1
[5,]               0.00        0.000        0.0000              -43.8
[6,]               0.00        0.000        0.0000              -13.0
[7,]               0.00        0.000        0.0000              -11.8
     supply_price supply_farmPrice supply_trend
[1,]       0.0000           0.0000       0.0000
[2,]       0.0000           0.0000       0.0000
[3,]       0.0000           0.0000       0.0000
[4,]     -43.8164         -12.9527     -11.8092
[5,]       0.3995           0.0374       0.0232
[6,]       0.0374           0.0893       0.0551
[7,]       0.0232           0.0551       0.3972
> 
> bread( fitw2sls1e )
     demand_(Intercept) demand_price demand_income supply_(Intercept)
[1,]            2133.15     -22.8963        1.6763               0.00
[2,]             -22.90       0.3165       -0.0898               0.00
[3,]               1.68      -0.0898        0.0749               0.00
[4,]               0.00       0.0000        0.0000            4616.09
[5,]               0.00       0.0000        0.0000             -35.05
[6,]               0.00       0.0000        0.0000             -10.36
[7,]               0.00       0.0000        0.0000              -9.45
     supply_price supply_farmPrice supply_trend
[1,]       0.0000           0.0000       0.0000
[2,]       0.0000           0.0000       0.0000
[3,]       0.0000           0.0000       0.0000
[4,]     -35.0531         -10.3622      -9.4473
[5,]       0.3196           0.0300       0.0185
[6,]       0.0300           0.0714       0.0441
[7,]       0.0185           0.0441       0.3178
> 
> bread( fitw2slsd1e )
     demand_(Intercept) demand_price demand_income supply_(Intercept)
[1,]             4222.1      -51.601         9.696               0.00
[2,]              -51.6        0.713        -0.202               0.00
[3,]                9.7       -0.202         0.108               0.00
[4,]                0.0        0.000         0.000            4616.09
[5,]                0.0        0.000         0.000             -35.05
[6,]                0.0        0.000         0.000             -10.36
[7,]                0.0        0.000         0.000              -9.45
     supply_price supply_farmPrice supply_trend
[1,]       0.0000           0.0000       0.0000
[2,]       0.0000           0.0000       0.0000
[3,]       0.0000           0.0000       0.0000
[4,]     -35.0531         -10.3622      -9.4473
[5,]       0.3196           0.0300       0.0185
[6,]       0.0300           0.0714       0.0441
[7,]       0.0185           0.0441       0.3178
> 
> proc.time()
   user  system elapsed 
   4.00    0.12    4.11 
