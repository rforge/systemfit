
R version 3.2.2 (2015-08-14) -- "Fire Safety"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library( systemfit )
Loading required package: Matrix
Loading required package: car
Loading required package: lmtest
Loading required package: zoo

Attaching package: 'zoo'

The following objects are masked from 'package:base':

    as.Date, as.Date.numeric

> options( digits = 3 )
> 
> data( "Kmenta" )
> useMatrix <- FALSE
> 
> demand <- consump ~ price + income
> supply <- consump ~ price + farmPrice + trend
> inst <- ~ income + farmPrice + trend
> inst1  <- ~ income + farmPrice
> instlist <- list( inst1, inst )
> system <- list( demand = demand, supply = supply )
> restrm <- matrix(0,1,7)  # restriction matrix "R"
> restrm[1,3] <-  1
> restrm[1,7] <- -1
> restrict <- "demand_income - supply_trend = 0"
> restr2m <- matrix(0,2,7)  # restriction matrix "R" 2
> restr2m[1,3] <-  1
> restr2m[1,7] <- -1
> restr2m[2,2] <- -1
> restr2m[2,5] <-  1
> restr2q <- c( 0, 0.5 )  # restriction vector "q" 2
> restrict2 <- c( "demand_income - supply_trend = 0",
+    "- demand_price + supply_price = 0.5" )
> tc <- matrix(0,7,6)
> tc[1,1] <- 1
> tc[2,2] <- 1
> tc[3,3] <- 1
> tc[4,4] <- 1
> tc[5,5] <- 1
> tc[6,6] <- 1
> tc[7,3] <- 1
> restr3m <- matrix(0,1,6)  # restriction matrix "R" 2
> restr3m[1,2] <- -1
> restr3m[1,5] <-  1
> restr3q <- c( 0.5 )  # restriction vector "q" 2
> restrict3 <- "- C2 + C5 = 0.5"
> 
> # It is not possible to estimate 2SLS with systemfit exactly
> # as EViews does, because EViews uses
> # methodResidCov == "geomean" for the coefficient covariance matrix and
> # methodResidCov == "noDfCor" for the residual covariance matrix.
> # systemfit uses always the same formulas for both calculations.
> 
> ## *************** 2SLS estimation ************************
> ## ************ 2SLS estimation (default)*********************
> fit2sls1 <- systemfit( system, "2SLS", data = Kmenta, inst = inst,
+    x = TRUE, useMatrix = useMatrix )
> print( summary( fit2sls1 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.87   4.36
supply   4.36   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.9208   11.95  1.1e-09 ***
price        -0.2436     0.0965   -2.52    0.022 *  
income        0.3140     0.0469    6.69  3.8e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12   0.0008 ***
price         0.2401     0.0999    2.40   0.0288 *  
farmPrice     0.2556     0.0473    5.41  5.8e-05 ***
trend         0.2529     0.0997    2.54   0.0219 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2sls1 )
[1] 40
> 
> ## *************** 2SLS estimation (singleEqSigma=F)*******************
> fit2sls1s <- systemfit( system, "2SLS", data = Kmenta, inst = inst,
+    singleEqSigma = FALSE, useMatrix = useMatrix )
> print( summary( fit2sls1s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.87   4.36
supply   4.36   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)   94.633      8.935   10.59  6.6e-09 ***
price         -0.244      0.109   -2.24    0.039 *  
income         0.314      0.053    5.93  1.6e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.8404    4.57  0.00032 ***
price         0.2401     0.0902    2.66  0.01706 *  
farmPrice     0.2556     0.0426    5.99  1.9e-05 ***
trend         0.2529     0.0899    2.81  0.01253 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2sls1s )
[1] 40
> 
> ## ********************* 2SLS (useDfSys = TRUE) *****************
> print( summary( fit2sls1, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.87   4.36
supply   4.36   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.9208   11.95  1.6e-13 ***
price        -0.2436     0.0965   -2.52    0.017 *  
income        0.3140     0.0469    6.69  1.3e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12  0.00024 ***
price         0.2401     0.0999    2.40  0.02208 *  
farmPrice     0.2556     0.0473    5.41  5.5e-06 ***
trend         0.2529     0.0997    2.54  0.01605 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2sls1 )
[1] 40
> 
> ## ********************* 2SLS (methodResidCov = "noDfCor" ) *****************
> fit2sls1r <- systemfit( system, "2SLS", data = Kmenta, inst = inst,
+    methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2sls1r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    2.97  0.697      0.525

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.29   3.59
supply   3.59   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.3027   12.96  3.1e-10 ***
price        -0.2436     0.0890   -2.74    0.014 *  
income        0.3140     0.0433    7.25  1.3e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.7425    4.61  0.00029 ***
price         0.2401     0.0894    2.69  0.01623 *  
farmPrice     0.2556     0.0423    6.05  1.7e-05 ***
trend         0.2529     0.0891    2.84  0.01188 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2sls1r )
[1] 40
> 
> ## *************** 2SLS (methodResidCov="noDfCor", singleEqSigma=F) *************
> fit2sls1rs <- systemfit( system, "2SLS", data = Kmenta, inst = inst,
+    methodResidCov = "noDfCor", singleEqSigma = FALSE, useMatrix = useMatrix )
> print( summary( fit2sls1rs ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    2.97  0.697      0.525

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.29   3.59
supply   3.59   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     8.1158   11.66  1.6e-09 ***
price        -0.2436     0.0989   -2.46    0.025 *  
income        0.3140     0.0481    6.53  5.2e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324     9.8463    5.03  0.00012 ***
price         0.2401     0.0819    2.93  0.00980 ** 
farmPrice     0.2556     0.0387    6.60  6.1e-06 ***
trend         0.2529     0.0817    3.10  0.00694 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2sls1rs )
[1] 40
> 
> ## ********************* 2SLS with restriction ********************
> ## **************** 2SLS with restriction (default)********************
> fit2sls2 <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, useMatrix = useMatrix )
> print( summary( fit2sls2 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166     3.6  0.691      0.553

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.97   4.55
supply   4.55   6.13

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.8693   10.63  2.4e-12 ***
price        -0.2247     0.1034   -2.17    0.037 *  
income        0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843    10.5384    4.57  6.1e-05 ***
price         0.2427     0.0896    2.71    0.011 *  
farmPrice     0.2619     0.0411    6.38  2.8e-07 ***
trend         0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls2 )
[1] 40
> # the same with symbolically specified restrictions
> fit2sls2Sym <- systemfit( system, "2SLS", data = Kmenta,
+    restrict.matrix = restrict, inst = inst, useMatrix = useMatrix )
> all.equal( fit2sls2, fit2sls2Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> nobs( fit2sls2Sym )
[1] 40
> 
> ## ************* 2SLS with restriction (singleEqSigma=T) *****************
> fit2sls2s <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, singleEqSigma = TRUE, x = TRUE,
+    useMatrix = useMatrix )
> print( summary( fit2sls2s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166     3.6  0.691      0.553

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.97   4.55
supply   4.55   6.13

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.0090   11.77  1.5e-13 ***
price        -0.2247     0.0946   -2.37    0.023 *  
income        0.2983     0.0430    6.94  5.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843    11.8001    4.08  0.00025 ***
price         0.2427     0.1006    2.41  0.02135 *  
farmPrice     0.2619     0.0459    5.70  2.1e-06 ***
trend         0.2983     0.0430    6.94  5.3e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls2s )
[1] 40
> 
> ## ********************* 2SLS with restriction (useDfSys=T) **************
> print( summary( fit2sls2, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166     3.6  0.691      0.553

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.97   4.55
supply   4.55   6.13

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.8693   10.63  2.4e-12 ***
price        -0.2247     0.1034   -2.17    0.037 *  
income        0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843    10.5384    4.57  6.1e-05 ***
price         0.2427     0.0896    2.71    0.011 *  
farmPrice     0.2619     0.0411    6.38  2.8e-07 ***
trend         0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls2 )
[1] 40
> 
> ## ********************* 2SLS with restriction (methodResidCov = "noDfCor") **************
> fit2sls2r <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2sls2r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    2.45  0.691      0.526

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.37   3.75
supply   3.75   4.91

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.1771   11.53  2.7e-13 ***
price        -0.2247     0.0954   -2.36    0.024 *  
income        0.2983     0.0419    7.13  3.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843     9.7159    4.96  1.9e-05 ***
price         0.2427     0.0826    2.94   0.0059 ** 
farmPrice     0.2619     0.0379    6.92  5.7e-08 ***
trend         0.2983     0.0419    7.13  3.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls2r )
[1] 40
> 
> ## ******** 2SLS with restriction (methodResidCov="noDfCor", singleEqSigma=TRUE) *********
> fit2sls2rs <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = inst, methodResidCov = "noDfCor", singleEqSigma = TRUE,
+    useMatrix = useMatrix )
> print( summary( fit2sls2rs ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    2.45  0.691      0.526

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.37   3.75
supply   3.75   4.91

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     7.3834   12.77  1.6e-14 ***
price        -0.2247     0.0871   -2.58    0.014 *  
income        0.2983     0.0394    7.57  8.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843    10.5574    4.56  6.3e-05 ***
price         0.2427     0.0900    2.70    0.011 *  
farmPrice     0.2619     0.0411    6.37  2.8e-07 ***
trend         0.2983     0.0394    7.57  8.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls2rs )
[1] 40
> 
> ## ********************* 2SLS with restriction via restrict.regMat ******************
> ## *************** 2SLS with restriction via restrict.regMat (default )***************
> fit2sls3 <- systemfit( system, "2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = inst, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2sls3, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    2.45  0.691      0.526

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.37   3.75
supply   3.75   4.91

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.1771   11.53  2.7e-13 ***
price        -0.2247     0.0954   -2.36    0.024 *  
income        0.2983     0.0419    7.13  3.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843     9.7159    4.96  1.9e-05 ***
price         0.2427     0.0826    2.94   0.0059 ** 
farmPrice     0.2619     0.0379    6.92  5.7e-08 ***
trend         0.2983     0.0419    7.13  3.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> nobs( fit2sls3 )
[1] 40
> 
> 
> ## ***************** 2SLS with 2 restrictions *******************
> ## ************** 2SLS with 2 restrictions (default) **************
> fit2sls4 <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, useMatrix = useMatrix )
> print( summary( fit2sls4 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.4189   14.91  < 2e-16 ***
price        -0.2433     0.0663   -3.67  0.00081 ***
income        0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.8941    5.90  1.1e-06 ***
price         0.2567     0.0663    3.87  0.00045 ***
farmPrice     0.2637     0.0398    6.62  1.2e-07 ***
trend         0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls4 )
[1] 40
> # the same with symbolically specified restrictions
> fit2sls4Sym <- systemfit( system, "2SLS", data = Kmenta,
+    restrict.matrix = restrict2, inst = inst, useMatrix = useMatrix )
> all.equal( fit2sls4, fit2sls4Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> nobs( fit2sls4Sym )
[1] 40
> 
> ## ************ 2SLS with 2 restrictions (singleEqSigma=T) **************
> fit2sls4s <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, singleEqSigma = TRUE,
+    useMatrix = useMatrix )
> print( summary( fit2sls4s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.3056   15.18  < 2e-16 ***
price        -0.2433     0.0684   -3.56   0.0011 ** 
income        0.3027     0.0394    7.69  5.1e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     8.3296    5.59  2.7e-06 ***
price         0.2567     0.0684    3.75  0.00064 ***
farmPrice     0.2637     0.0455    5.79  1.5e-06 ***
trend         0.3027     0.0394    7.69  5.1e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls4s )
[1] 40
> 
> ## ***************** 2SLS with 2 restrictions (useDfSys=T) **************
> print( summary( fit2sls4, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.4189   14.91  < 2e-16 ***
price        -0.2433     0.0663   -3.67  0.00081 ***
income        0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.8941    5.90  1.1e-06 ***
price         0.2567     0.0663    3.87  0.00045 ***
farmPrice     0.2637     0.0398    6.62  1.2e-07 ***
trend         0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls4 )
[1] 40
> 
> ## ***************** 2SLS with 2 restrictions (methodResidCov="noDfCor") **************
> fit2sls4r <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, methodResidCov = "noDfCor",
+    x = TRUE, useMatrix = useMatrix )
> print( summary( fit2sls4r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.57   0.69       0.54

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.30   3.73
supply   3.73   5.00

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.0044   15.94  < 2e-16 ***
price        -0.2433     0.0621   -3.92  0.00039 ***
income        0.3027     0.0382    7.93  2.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.3842    6.31  3.1e-07 ***
price         0.2567     0.0621    4.14  0.00021 ***
farmPrice     0.2637     0.0373    7.08  3.0e-08 ***
trend         0.3027     0.0382    7.93  2.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls4r )
[1] 40
> 
> ## ***** 2SLS with 2 restrictions (methodResidCov="noDfCor", singleEqSigma=T) *******
> fit2sls4rs <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr2m,
+    restrict.rhs = restr2q, inst = inst, methodResidCov = "noDfCor",
+    singleEqSigma = TRUE, useMatrix = useMatrix )
> print( summary( fit2sls4rs ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.57   0.69       0.54

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.30   3.73
supply   3.73   5.00

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     5.7579   16.62  < 2e-16 ***
price        -0.2433     0.0621   -3.92    4e-04 ***
income        0.3027     0.0360    8.40  6.6e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.5360    6.18  4.5e-07 ***
price         0.2567     0.0621    4.13  0.00021 ***
farmPrice     0.2637     0.0407    6.47  1.8e-07 ***
trend         0.3027     0.0360    8.40  6.6e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls4rs )
[1] 40
> 
> ## ************* 2SLS with 2 restrictions via R and restrict.regMat ******************
> ## ******** 2SLS with 2 restrictions via R and restrict.regMat (default) *************
> fit2sls5 <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    useMatrix = useMatrix )
> print( summary( fit2sls5 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.4189   14.91  < 2e-16 ***
price        -0.2433     0.0663   -3.67  0.00081 ***
income        0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.8941    5.90  1.1e-06 ***
price         0.2567     0.0663    3.87  0.00045 ***
farmPrice     0.2637     0.0398    6.62  1.2e-07 ***
trend         0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls5 )
[1] 40
> # the same with symbolically specified restrictions
> fit2sls5Sym <- systemfit( system, "2SLS", data = Kmenta,
+    restrict.matrix = restrict3, restrict.regMat = tc, inst = inst,
+    useMatrix = useMatrix )
> all.equal( fit2sls5, fit2sls5Sym )
[1] "Component \"call\": target, current do not match when deparsed"
> nobs( fit2sls5Sym )
[1] 40
> 
> ## ******* 2SLS with 2 restrictions via R and restrict.regMat (singleEqSigma=T) ******
> fit2sls5s <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    singleEqSigma = TRUE, useMatrix = useMatrix )
> print( summary( fit2sls5s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.3056   15.18  < 2e-16 ***
price        -0.2433     0.0684   -3.56   0.0011 ** 
income        0.3027     0.0394    7.69  5.1e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     8.3296    5.59  2.7e-06 ***
price         0.2567     0.0684    3.75  0.00064 ***
farmPrice     0.2637     0.0455    5.79  1.5e-06 ***
trend         0.3027     0.0394    7.69  5.1e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls5s )
[1] 40
> 
> ## ********** 2SLS with 2 restrictions via R and restrict.regMat (useDfSys=T) *******
> print( summary( fit2sls5, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.89   4.53
supply   4.53   6.25

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.4189   14.91  < 2e-16 ***
price        -0.2433     0.0663   -3.67  0.00081 ***
income        0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.8941    5.90  1.1e-06 ***
price         0.2567     0.0663    3.87  0.00045 ***
farmPrice     0.2637     0.0398    6.62  1.2e-07 ***
trend         0.3027     0.0408    7.42  1.1e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls5 )
[1] 40
> 
> ## ************* 2SLS with 2 restrictions via R and restrict.regMat (methodResidCov="noDfCor") *********
> fit2sls5r <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2sls5r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.57   0.69       0.54

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.30   3.73
supply   3.73   5.00

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     6.0044   15.94  < 2e-16 ***
price        -0.2433     0.0621   -3.92  0.00039 ***
income        0.3027     0.0382    7.93  2.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.3842    6.31  3.1e-07 ***
price         0.2567     0.0621    4.14  0.00021 ***
farmPrice     0.2637     0.0373    7.08  3.0e-08 ***
trend         0.3027     0.0382    7.93  2.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls5r )
[1] 40
> 
> ## ** 2SLS with 2 restrictions via R and restrict.regMat (methodResidCov="noDfCor", singleEqSigma=T) **
> fit2sls5rs <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restr3m,
+    restrict.rhs = restr3q, restrict.regMat = tc, inst = inst,
+    methodResidCov = "noDfCor", singleEqSigma = TRUE,
+    x = TRUE, useMatrix = useMatrix )
> print( summary( fit2sls5rs ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.57   0.69       0.54

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557

The covariance matrix of the residuals
       demand supply
demand   3.30   3.73
supply   3.73   5.00

The correlations of the residuals
       demand supply
demand  1.000  0.919
supply  0.919  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  95.7059     5.7579   16.62  < 2e-16 ***
price        -0.2433     0.0621   -3.92    4e-04 ***
income        0.3027     0.0360    8.40  6.6e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.972 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081 MSE: 3.887 Root MSE: 1.972 
Multiple R-Squared: 0.754 Adjusted R-Squared: 0.725 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  46.5637     7.5360    6.18  4.5e-07 ***
price         0.2567     0.0621    4.13  0.00021 ***
farmPrice     0.2637     0.0407    6.47  1.8e-07 ***
trend         0.3027     0.0360    8.40  6.6e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.5 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.971 MSE: 6.248 Root MSE: 2.5 
Multiple R-Squared: 0.627 Adjusted R-Squared: 0.557 

> nobs( fit2sls5rs )
[1] 40
> 
> ## *********** 2SLS estimation with different instruments **************
> ## ******* 2SLS estimation with different instruments (default) *********
> fit2slsd1 <- systemfit( system, "2SLS", data = Kmenta, inst = instlist,
+    useMatrix = useMatrix )
> print( summary( fit2slsd1 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.97   3.84
supply   3.84   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 106.7894    11.1435    9.58  2.9e-08 ***
price        -0.4116     0.1448   -2.84    0.011 *  
income        0.3617     0.0564    6.41  6.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12   0.0008 ***
price         0.2401     0.0999    2.40   0.0288 *  
farmPrice     0.2556     0.0473    5.41  5.8e-05 ***
trend         0.2529     0.0997    2.54   0.0219 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2slsd1 )
[1] 40
> 
> ## *********** 2SLS estimation with different instruments (singleEqSigma=F)*****
> fit2slsd1s <- systemfit( system, "2SLS", data = Kmenta, inst = instlist,
+    singleEqSigma = FALSE, useMatrix = useMatrix )
> print( summary( fit2slsd1s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.97   3.84
supply   3.84   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 106.7894    12.4749    8.56  1.4e-07 ***
price        -0.4116     0.1622   -2.54    0.021 *  
income        0.3617     0.0631    5.73  2.5e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.8976    4.55  0.00033 ***
price         0.2401     0.0907    2.65  0.01755 *  
farmPrice     0.2556     0.0429    5.96    2e-05 ***
trend         0.2529     0.0904    2.80  0.01292 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2slsd1s )
[1] 40
> 
> ## ********* 2SLS estimation with different instruments (useDfSys=T) *******
> print( summary( fit2slsd1, useDfSys = TRUE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.97   3.84
supply   3.84   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 106.7894    11.1435    9.58  4.7e-11 ***
price        -0.4116     0.1448   -2.84   0.0076 ** 
income        0.3617     0.0564    6.41  2.9e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12  0.00024 ***
price         0.2401     0.0999    2.40  0.02208 *  
farmPrice     0.2556     0.0473    5.41  5.5e-06 ***
trend         0.2529     0.0997    2.54  0.01605 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2slsd1 )
[1] 40
> 
> ## ********* 2SLS estimation with different instruments (methodResidCov="noDfCor") ******
> fit2slsd1r <- systemfit( system, "2SLS", data = Kmenta, inst = instlist,
+    methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2slsd1r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    6.29  0.694        0.5

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.37   3.16
supply   3.16   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  106.789     10.274   10.39  8.8e-09 ***
price         -0.412      0.134   -3.08   0.0068 ** 
income         0.362      0.052    6.95  2.3e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    10.7425    4.61  0.00029 ***
price         0.2401     0.0894    2.69  0.01623 *  
farmPrice     0.2556     0.0423    6.05  1.7e-05 ***
trend         0.2529     0.0891    2.84  0.01188 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2slsd1r )
[1] 40
> 
> ## 2SLS estimation with different instruments (methodResidCov="noDfCor",singleEqSigma=F)
> fit2slsd1r <- systemfit( system, "2SLS", data = Kmenta, inst = instlist,
+    methodResidCov = "noDfCor", singleEqSigma = FALSE,
+    useMatrix = useMatrix )
> print( summary( fit2slsd1r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    6.29  0.694        0.5

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.37   3.16
supply   3.16   4.83

The correlations of the residuals
       demand supply
demand  1.000  0.784
supply  0.784  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 106.7894    11.3309    9.42  3.7e-08 ***
price        -0.4116     0.1473   -2.79    0.012 *  
income        0.3617     0.0574    6.31  7.9e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.992 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.447 MSE: 3.967 Root MSE: 1.992 
Multiple R-Squared: 0.748 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324     9.8982    5.00  0.00013 ***
price         0.2401     0.0824    2.92  0.01012 *  
farmPrice     0.2556     0.0389    6.56  6.5e-06 ***
trend         0.2529     0.0821    3.08  0.00718 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> nobs( fit2slsd1r )
[1] 40
> 
> ## **** 2SLS estimation with different instruments and restriction *******
> ## ** 2SLS estimation with different instruments and restriction (default) ****
> fit2slsd2 <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, useMatrix = useMatrix )
> print( summary( fit2slsd2 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    4.89  0.693       0.56

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.79   4.35
supply   4.35   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    11.8930    8.71  3.5e-10 ***
price        -0.3449     0.1455   -2.37    0.024 *  
income        0.3260     0.0511    6.38  2.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592    10.5362    4.49  7.7e-05 ***
price         0.2443     0.0894    2.73   0.0099 ** 
farmPrice     0.2657     0.0411    6.47  2.1e-07 ***
trend         0.3260     0.0511    6.38  2.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd2 )
[1] 40
> 
> ## 2SLS estimation with different instruments and restriction (singleEqSigma=T)
> fit2slsd2s <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, singleEqSigma = TRUE, useMatrix = useMatrix )
> print( summary( fit2slsd2s ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    4.89  0.693       0.56

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.79   4.35
supply   4.35   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    10.6344    9.74  2.3e-11 ***
price        -0.3449     0.1327   -2.60    0.014 *  
income        0.3260     0.0485    6.73  9.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592    11.9466    3.96  0.00036 ***
price         0.2443     0.1017    2.40  0.02188 *  
farmPrice     0.2657     0.0465    5.71  2.0e-06 ***
trend         0.3260     0.0485    6.73  9.9e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd2s )
[1] 40
> 
> ## **** 2SLS estimation with different instruments and restriction (useDfSys=F)
> print( summary( fit2slsd2, useDfSys = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    4.89  0.693       0.56

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.79   4.35
supply   4.35   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    11.8930    8.71  1.1e-07 ***
price        -0.3449     0.1455   -2.37     0.03 *  
income        0.3260     0.0511    6.38  6.9e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592    10.5362    4.49  0.00037 ***
price         0.2443     0.0894    2.73  0.01475 *  
farmPrice     0.2657     0.0411    6.47  7.8e-06 ***
trend         0.3260     0.0511    6.38  9.1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd2 )
[1] 40
> 
> ## **** 2SLS estimation with different instruments and restriction (methodResidCov="noDfCor")
> fit2slsd2r <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2slsd2r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.32  0.693      0.537

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.22   3.58
supply   3.58   5.02

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    10.9648    9.45  4.9e-11 ***
price        -0.3449     0.1341   -2.57    0.015 *  
income        0.3260     0.0471    6.92  5.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592     9.7139    4.88  2.5e-05 ***
price         0.2443     0.0824    2.96   0.0055 ** 
farmPrice     0.2657     0.0379    7.01  4.3e-08 ***
trend         0.3260     0.0471    6.92  5.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd2r )
[1] 40
> 
> ## 2SLS estimation with different instr. and restr. (methodResidCov="noDfCor", singleEqSigma=T)
> fit2slsd2rs <- systemfit( system, "2SLS", data = Kmenta, restrict.matrix = restrm,
+    inst = instlist, methodResidCov = "noDfCor", singleEqSigma = TRUE,
+    useMatrix = useMatrix )
> print( summary( fit2slsd2rs ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.32  0.693      0.537

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.22   3.58
supply   3.58   5.02

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936     9.7929   10.58  2.7e-12 ***
price        -0.3449     0.1220   -2.83   0.0078 ** 
income        0.3260     0.0444    7.35  1.6e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592    10.6890    4.43  9.3e-05 ***
price         0.2443     0.0910    2.69    0.011 *  
farmPrice     0.2657     0.0416    6.38  2.8e-07 ***
trend         0.3260     0.0444    7.35  1.6e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd2rs )
[1] 40
> 
> ## **** 2SLS estimation with different instruments and restriction via restrict.regMat *
> ## 2SLS estimation with different instruments and restriction via restrict.regMat (default)
> fit2slsd3 <- systemfit( system, "2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = instlist, useMatrix = useMatrix )
> print( summary( fit2slsd3 ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    4.89  0.693       0.56

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.79   4.35
supply   4.35   6.27

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    11.8930    8.71  3.5e-10 ***
price        -0.3449     0.1455   -2.37    0.024 *  
income        0.3260     0.0511    6.38  2.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592    10.5362    4.49  7.7e-05 ***
price         0.2443     0.0894    2.73   0.0099 ** 
farmPrice     0.2657     0.0411    6.47  2.1e-07 ***
trend         0.3260     0.0511    6.38  2.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd3 )
[1] 40
> 
> ## **** 2SLS estimation with different instr. and restr. via restrict.regMat (methodResidCov="noDfCor")
> fit2slsd3r <- systemfit( system, "2SLS", data = Kmenta, restrict.regMat = tc,
+    inst = instlist, methodResidCov = "noDfCor", useMatrix = useMatrix )
> print( summary( fit2slsd3r ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.32  0.693      0.537

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556

The covariance matrix of the residuals
       demand supply
demand   3.22   3.58
supply   3.58   5.02

The correlations of the residuals
       demand supply
demand  1.000  0.891
supply  0.891  1.000


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice

            Estimate Std. Error t value Pr(>|t|)    
(Intercept) 103.5936    10.9648    9.45  4.9e-11 ***
price        -0.3449     0.1341   -2.57    0.015 *  
income        0.3260     0.0471    6.92  5.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.947 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445 MSE: 3.791 Root MSE: 1.947 
Multiple R-Squared: 0.76 Adjusted R-Squared: 0.731 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  47.3592     9.7139    4.88  2.5e-05 ***
price         0.2443     0.0824    2.96   0.0055 ** 
farmPrice     0.2657     0.0379    7.01  4.3e-08 ***
trend         0.3260     0.0471    6.92  5.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.504 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.321 MSE: 6.27 Root MSE: 2.504 
Multiple R-Squared: 0.626 Adjusted R-Squared: 0.556 

> nobs( fit2slsd3r )
[1] 40
> 
> 
> ## *********** estimations with a single regressor ************
> fit2slsS1 <- systemfit(
+    list( consump ~ price - 1, price ~ consump + trend ), "2SLS",
+    data = Kmenta, inst = ~ farmPrice + trend + income, useMatrix = useMatrix )
> print( summary( fit2slsS1 ) )

systemfit results 
method: 2SLS 

        N DF  SSR detRCov OLS-R2 McElroy-R2
system 40 36 1544     179  -0.65      0.852

     N DF SSR  MSE RMSE     R2 Adj R2
eq1 20 19 861 45.3 6.73 -2.213 -2.213
eq2 20 17 682 40.1 6.33 -0.022 -0.143

The covariance matrix of the residuals
      eq1   eq2
eq1  45.3 -40.5
eq2 -40.5  40.1

The correlations of the residuals
      eq1   eq2
eq1  1.00 -0.95
eq2 -0.95  1.00


2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ price - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
price    1.006      0.015    66.9   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.734 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 861.48 MSE: 45.341 Root MSE: 6.734 
Multiple R-Squared: -2.213 Adjusted R-Squared: -2.213 


2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ consump + trend
Instruments: ~farmPrice + trend + income

            Estimate Std. Error t value Pr(>|t|)
(Intercept)  55.5365    46.2668    1.20     0.25
consump       0.4453     0.4622    0.96     0.35
trend        -0.0426     0.2496   -0.17     0.87

Residual standard error: 6.335 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 682.257 MSE: 40.133 Root MSE: 6.335 
Multiple R-Squared: -0.022 Adjusted R-Squared: -0.143 

> nobs( fit2slsS1 )
[1] 40
> fit2slsS2 <- systemfit(
+    list( consump ~ price - 1, consump ~ trend - 1 ), "2SLS",
+    data = Kmenta, inst = ~ farmPrice + price + income, useMatrix = useMatrix )
> print( summary( fit2slsS2 ) )

systemfit results 
method: 2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 38 47456  111148  -87.5      -5.28

     N DF   SSR    MSE  RMSE      R2  Adj R2
eq1 20 19   861   45.3  6.73   -2.21   -2.21
eq2 20 19 46595 2452.3 49.52 -172.79 -172.79

The covariance matrix of the residuals
      eq1     eq2
eq1 45.34   -6.33
eq2 -6.33 2452.34

The correlations of the residuals
        eq1     eq2
eq1  1.0000 -0.0448
eq2 -0.0448  1.0000


2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ price - 1
Instruments: ~farmPrice + price + income

      Estimate Std. Error t value Pr(>|t|)    
price    1.006      0.015    66.9   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.733 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 861.449 MSE: 45.339 Root MSE: 6.733 
Multiple R-Squared: -2.213 Adjusted R-Squared: -2.213 


2SLS estimates for 'eq2' (equation 2)
Model Formula: consump ~ trend - 1
Instruments: ~farmPrice + price + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.578      0.934    8.11  1.4e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.521 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 46594.549 MSE: 2452.345 Root MSE: 49.521 
Multiple R-Squared: -172.786 Adjusted R-Squared: -172.786 

> nobs( fit2slsS2 )
[1] 40
> fit2slsS3 <- systemfit(
+    list( consump ~ trend - 1, price ~ trend - 1 ), "2SLS",
+    data = Kmenta, inst = instlist, useMatrix = useMatrix )
> print( summary( fit2slsS3 ) )

systemfit results 
method: 2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 38 97978  687515   -104      -10.6

     N DF   SSR  MSE RMSE     R2 Adj R2
eq1 20 19 50950 2682 51.8 -189.0 -189.0
eq2 20 19 47028 2475 49.8  -69.5  -69.5

The covariance matrix of the residuals
     eq1  eq2
eq1 2682 2439
eq2 2439 2475

The correlations of the residuals
      eq1   eq2
eq1 1.000 0.989
eq2 0.989 1.000


2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ trend - 1
Instruments: ~income + farmPrice

      Estimate Std. Error t value Pr(>|t|)    
trend     8.65       1.05    8.27    1e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 51.784 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 50949.985 MSE: 2681.578 Root MSE: 51.784 
Multiple R-Squared: -189.031 Adjusted R-Squared: -189.031 


2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ trend - 1
Instruments: ~income + farmPrice + trend

      Estimate Std. Error t value Pr(>|t|)    
trend    7.318      0.929    7.88  2.1e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.751 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 47028.107 MSE: 2475.164 Root MSE: 49.751 
Multiple R-Squared: -69.48 Adjusted R-Squared: -69.48 

> nobs( fit2slsS3 )
[1] 40
> fit2slsS4 <- systemfit(
+    list( consump ~ trend - 1, price ~ trend - 1 ), "2SLS",
+    data = Kmenta, inst = ~ farmPrice + trend + income,
+    restrict.matrix = matrix( c( 1, -1 ), nrow = 1 ), useMatrix = useMatrix )
> print( summary( fit2slsS4 ) )

systemfit results 
method: 2SLS 

        N DF   SSR detRCov OLS-R2 McElroy-R2
system 40 39 93548  111736    -99      -1.03

     N DF   SSR  MSE RMSE     R2 Adj R2
eq1 20 19 46514 2448 49.5 -172.5 -172.5
eq2 20 19 47033 2475 49.8  -69.5  -69.5

The covariance matrix of the residuals
     eq1  eq2
eq1 2448 2439
eq2 2439 2475

The correlations of the residuals
      eq1   eq2
eq1 1.000 0.988
eq2 0.988 1.000


2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ trend - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.362      0.646    11.4  5.7e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.478 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 46514.283 MSE: 2448.12 Root MSE: 49.478 
Multiple R-Squared: -172.487 Adjusted R-Squared: -172.487 


2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ trend - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
trend    7.362      0.646    11.4  5.7e-14 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 49.754 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 47033.469 MSE: 2475.446 Root MSE: 49.754 
Multiple R-Squared: -69.488 Adjusted R-Squared: -69.488 

> nobs( fit2slsS4 )
[1] 40
> fit2slsS5 <- systemfit(
+    list( consump ~ 1, price ~ 1 ), "2SLS",
+    data = Kmenta, inst = ~ farmPrice, useMatrix = useMatrix )
> print( summary( fit2slsS1 ) )

systemfit results 
method: 2SLS 

        N DF  SSR detRCov OLS-R2 McElroy-R2
system 40 36 1544     179  -0.65      0.852

     N DF SSR  MSE RMSE     R2 Adj R2
eq1 20 19 861 45.3 6.73 -2.213 -2.213
eq2 20 17 682 40.1 6.33 -0.022 -0.143

The covariance matrix of the residuals
      eq1   eq2
eq1  45.3 -40.5
eq2 -40.5  40.1

The correlations of the residuals
      eq1   eq2
eq1  1.00 -0.95
eq2 -0.95  1.00


2SLS estimates for 'eq1' (equation 1)
Model Formula: consump ~ price - 1
Instruments: ~farmPrice + trend + income

      Estimate Std. Error t value Pr(>|t|)    
price    1.006      0.015    66.9   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.734 on 19 degrees of freedom
Number of observations: 20 Degrees of Freedom: 19 
SSR: 861.48 MSE: 45.341 Root MSE: 6.734 
Multiple R-Squared: -2.213 Adjusted R-Squared: -2.213 


2SLS estimates for 'eq2' (equation 2)
Model Formula: price ~ consump + trend
Instruments: ~farmPrice + trend + income

            Estimate Std. Error t value Pr(>|t|)
(Intercept)  55.5365    46.2668    1.20     0.25
consump       0.4453     0.4622    0.96     0.35
trend        -0.0426     0.2496   -0.17     0.87

Residual standard error: 6.335 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 682.257 MSE: 40.133 Root MSE: 6.335 
Multiple R-Squared: -0.022 Adjusted R-Squared: -0.143 

> 
> 
> ## **************** shorter summaries **********************
> print( summary( fit2sls1, useDfSys = TRUE, residCov = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.6333     7.9208   11.95  1.6e-13 ***
price        -0.2436     0.0965   -2.52    0.017 *  
income        0.3140     0.0469    6.69  1.3e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.966 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729 MSE: 3.866 Root MSE: 1.966 
Multiple R-Squared: 0.755 Adjusted R-Squared: 0.726 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  49.5324    12.0105    4.12  0.00024 ***
price         0.2401     0.0999    2.40  0.02208 *  
farmPrice     0.2556     0.0473    5.41  5.5e-06 ***
trend         0.2529     0.0997    2.54  0.01605 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.458 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633 MSE: 6.04 Root MSE: 2.458 
Multiple R-Squared: 0.64 Adjusted R-Squared: 0.572 

> 
> print( summary( fit2sls1, equations = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    4.36  0.697      0.548

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572

The covariance matrix of the residuals
       demand supply
demand   3.87   4.36
supply   4.36   6.04

The correlations of the residuals
       demand supply
demand  1.000  0.902
supply  0.902  1.000


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.6333     7.9208   11.95  1.1e-09 ***
demand_price        -0.2436     0.0965   -2.52   0.0218 *  
demand_income        0.3140     0.0469    6.69  3.8e-06 ***
supply_(Intercept)  49.5324    12.0105    4.12   0.0008 ***
supply_price         0.2401     0.0999    2.40   0.0288 *  
supply_farmPrice     0.2556     0.0473    5.41  5.8e-05 ***
supply_trend         0.2529     0.0997    2.54   0.0219 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2sls1rs, residCov = FALSE, equations = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 162    2.97  0.697      0.525

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 65.7 3.87 1.97 0.755  0.726
supply 20 16 96.6 6.04 2.46 0.640  0.572


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.6333     8.1158   11.66  1.6e-09 ***
demand_price        -0.2436     0.0989   -2.46  0.02471 *  
demand_income        0.3140     0.0481    6.53  5.2e-06 ***
supply_(Intercept)  49.5324     9.8463    5.03  0.00012 ***
supply_price         0.2401     0.0819    2.93  0.00980 ** 
supply_farmPrice     0.2556     0.0387    6.60  6.1e-06 ***
supply_trend         0.2529     0.0817    3.10  0.00694 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2sls2Sym, useDfSys = FALSE ), equations = FALSE )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166     3.6  0.691      0.553

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565

The covariance matrix of the residuals
       demand supply
demand   3.97   4.55
supply   4.55   6.13

The correlations of the residuals
       demand supply
demand  1.000  0.923
supply  0.923  1.000


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.2816     8.8693   10.63  6.3e-09 ***
demand_price        -0.2247     0.1034   -2.17  0.04425 *  
demand_income        0.2983     0.0454    6.57  4.8e-06 ***
supply_(Intercept)  48.1843    10.5384    4.57  0.00031 ***
supply_price         0.2427     0.0896    2.71  0.01551 *  
supply_farmPrice     0.2619     0.0411    6.38  9.1e-06 ***
supply_trend         0.2983     0.0454    6.57  6.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2sls2 ), residCov = FALSE )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166     3.6  0.691      0.553

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565


2SLS estimates for 'demand' (equation 1)
Model Formula: consump ~ price + income
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  94.2816     8.8693   10.63  2.4e-12 ***
price        -0.2247     0.1034   -2.17    0.037 *  
income        0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.991 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418 MSE: 3.966 Root MSE: 1.991 
Multiple R-Squared: 0.749 Adjusted R-Squared: 0.719 


2SLS estimates for 'supply' (equation 2)
Model Formula: consump ~ price + farmPrice + trend
Instruments: ~income + farmPrice + trend

            Estimate Std. Error t value Pr(>|t|)    
(Intercept)  48.1843    10.5384    4.57  6.1e-05 ***
price         0.2427     0.0896    2.71    0.011 *  
farmPrice     0.2619     0.0411    6.38  2.8e-07 ***
trend         0.2983     0.0454    6.57  1.6e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.477 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155 MSE: 6.135 Root MSE: 2.477 
Multiple R-Squared: 0.634 Adjusted R-Squared: 0.565 

> 
> print( summary( fit2sls3, useDfSys = FALSE, residCov = FALSE,
+    equations = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 166    2.45  0.691      0.526

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.749  0.719
supply 20 16 98.2 6.13 2.48 0.634  0.565


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  94.2816     8.1771   11.53  1.8e-09 ***
demand_price        -0.2247     0.0954   -2.36  0.03071 *  
demand_income        0.2983     0.0419    7.13  1.7e-06 ***
supply_(Intercept)  48.1843     9.7159    4.96  0.00014 ***
supply_price         0.2427     0.0826    2.94  0.00966 ** 
supply_farmPrice     0.2619     0.0379    6.92  3.5e-06 ***
supply_trend         0.2983     0.0419    7.13  2.4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2sls4s ), equations = FALSE, residCov = FALSE )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    3.78   0.69      0.568

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  95.7059     6.3056   15.18  < 2e-16 ***
demand_price        -0.2433     0.0684   -3.56  0.00110 ** 
demand_income        0.3027     0.0394    7.69  5.1e-09 ***
supply_(Intercept)  46.5637     8.3296    5.59  2.7e-06 ***
supply_price         0.2567     0.0684    3.75  0.00064 ***
supply_farmPrice     0.2637     0.0455    5.79  1.5e-06 ***
supply_trend         0.3027     0.0394    7.69  5.1e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2sls5r, equations = FALSE, residCov = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 35 166    2.57   0.69       0.54

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  66.1 3.89 1.97 0.754  0.725
supply 20 16 100.0 6.25 2.50 0.627  0.557


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept)  95.7059     6.0044   15.94  < 2e-16 ***
demand_price        -0.2433     0.0621   -3.92  0.00039 ***
demand_income        0.3027     0.0382    7.93  2.5e-09 ***
supply_(Intercept)  46.5637     7.3842    6.31  3.1e-07 ***
supply_price         0.2567     0.0621    4.14  0.00021 ***
supply_farmPrice     0.2637     0.0373    7.08  3.0e-08 ***
supply_trend         0.3027     0.0382    7.93  2.5e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2slsd1s ), residCov = FALSE, equations = FALSE )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 33 164    9.25  0.694      0.512

        N DF  SSR  MSE RMSE    R2 Adj R2
demand 20 17 67.4 3.97 1.99 0.748  0.719
supply 20 16 96.6 6.04 2.46 0.640  0.572


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 106.7894    12.4749    8.56  1.4e-07 ***
demand_price        -0.4116     0.1622   -2.54  0.02121 *  
demand_income        0.3617     0.0631    5.73  2.5e-05 ***
supply_(Intercept)  49.5324    10.8976    4.55  0.00033 ***
supply_price         0.2401     0.0907    2.65  0.01755 *  
supply_farmPrice     0.2556     0.0429    5.96  2.0e-05 ***
supply_trend         0.2529     0.0904    2.80  0.01292 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2slsd2, residCov = FALSE, equations = FALSE ) )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    4.89  0.693       0.56

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 103.5936    11.8930    8.71  3.5e-10 ***
demand_price        -0.3449     0.1455   -2.37   0.0236 *  
demand_income        0.3260     0.0511    6.38  2.8e-07 ***
supply_(Intercept)  47.3592    10.5362    4.49  7.7e-05 ***
supply_price         0.2443     0.0894    2.73   0.0099 ** 
supply_farmPrice     0.2657     0.0411    6.47  2.1e-07 ***
supply_trend         0.3260     0.0511    6.38  2.8e-07 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> print( summary( fit2slsd3r ), residCov = FALSE, equations = FALSE )

systemfit results 
method: 2SLS 

        N DF SSR detRCov OLS-R2 McElroy-R2
system 40 34 165    3.32  0.693      0.537

        N DF   SSR  MSE RMSE    R2 Adj R2
demand 20 17  64.4 3.79 1.95 0.760  0.731
supply 20 16 100.3 6.27 2.50 0.626  0.556


Coefficients:
                   Estimate Std. Error t value Pr(>|t|)    
demand_(Intercept) 103.5936    10.9648    9.45  4.9e-11 ***
demand_price        -0.3449     0.1341   -2.57   0.0147 *  
demand_income        0.3260     0.0471    6.92  5.7e-08 ***
supply_(Intercept)  47.3592     9.7139    4.88  2.5e-05 ***
supply_price         0.2443     0.0824    2.96   0.0055 ** 
supply_farmPrice     0.2657     0.0379    7.01  4.3e-08 ***
supply_trend         0.3260     0.0471    6.92  5.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> 
> ## ****************** residuals **************************
> print( residuals( fit2sls1 ) )
   demand  supply
1   0.843 -0.4348
2  -0.698 -1.2131
3   2.359  1.7090
4   1.490  0.7956
5   2.139  1.5942
6   1.277  0.6595
7   1.571  1.4346
8  -3.066 -4.8724
9  -1.125 -2.3975
10  2.492  3.1427
11 -0.108  0.0689
12 -2.292 -1.3978
13 -1.598 -1.1136
14 -0.271  1.1684
15  1.958  3.4865
16 -3.430 -3.8285
17 -0.313  0.6793
18 -2.151 -2.7713
19  1.592  2.6668
20 -0.668  0.6235
> print( residuals( fit2sls1$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.843 -0.698  2.359  1.490  2.139  1.277  1.571 -3.066 -1.125  2.492 -0.108 
    12     13     14     15     16     17     18     19     20 
-2.292 -1.598 -0.271  1.958 -3.430 -0.313 -2.151  1.592 -0.668 
> 
> print( residuals( fit2sls2s ) )
   demand  supply
1   0.678 -0.0135
2  -0.777 -0.8544
3   2.281  2.0245
4   1.416  1.0692
5   2.213  1.7598
6   1.334  0.7923
7   1.640  1.5342
8  -2.994 -4.8544
9  -1.072 -2.3959
10  2.522  3.1637
11 -0.330  0.1628
12 -2.593 -1.2864
13 -1.856 -1.0729
14 -0.356  1.1087
15  2.138  3.2597
16 -3.282 -4.1265
17 -0.076  0.3331
18 -2.119 -3.0961
19  1.690  2.3122
20 -0.458  0.1799
> print( residuals( fit2sls2s$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
-0.0135 -0.8544  2.0245  1.0692  1.7598  0.7923  1.5342 -4.8544 -2.3959  3.1637 
     11      12      13      14      15      16      17      18      19      20 
 0.1628 -1.2864 -1.0729  1.1087  3.2597 -4.1265  0.3331 -3.0961  2.3122  0.1799 
> 
> print( residuals( fit2sls3 ) )
   demand  supply
1   0.678 -0.0135
2  -0.777 -0.8544
3   2.281  2.0245
4   1.416  1.0692
5   2.213  1.7598
6   1.334  0.7923
7   1.640  1.5342
8  -2.994 -4.8544
9  -1.072 -2.3959
10  2.522  3.1637
11 -0.330  0.1628
12 -2.593 -1.2864
13 -1.856 -1.0729
14 -0.356  1.1087
15  2.138  3.2597
16 -3.282 -4.1265
17 -0.076  0.3331
18 -2.119 -3.0961
19  1.690  2.3122
20 -0.458  0.1799
> print( residuals( fit2sls3$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.678 -0.777  2.281  1.416  2.213  1.334  1.640 -2.994 -1.072  2.522 -0.330 
    12     13     14     15     16     17     18     19     20 
-2.593 -1.856 -0.356  2.138 -3.282 -0.076 -2.119  1.690 -0.458 
> 
> print( residuals( fit2sls4r ) )
   demand  supply
1   0.729  0.0219
2  -0.698 -0.8806
3   2.349  2.0055
4   1.496  1.0326
5   2.165  1.7870
6   1.310  0.7993
7   1.635  1.5189
8  -2.951 -4.9334
9  -1.134 -2.3609
10  2.397  3.2818
11 -0.359  0.2857
12 -2.524 -1.2257
13 -1.745 -1.0782
14 -0.349  1.1382
15  2.022  3.2981
16 -3.345 -4.1440
17 -0.322  0.4686
18 -2.075 -3.1779
19  1.738  2.2072
20 -0.339 -0.0444
> print( residuals( fit2sls4r$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
 0.0219 -0.8806  2.0055  1.0326  1.7870  0.7993  1.5189 -4.9334 -2.3609  3.2818 
     11      12      13      14      15      16      17      18      19      20 
 0.2857 -1.2257 -1.0782  1.1382  3.2981 -4.1440  0.4686 -3.1779  2.2072 -0.0444 
> 
> print( residuals( fit2sls5rs ) )
   demand  supply
1   0.729  0.0219
2  -0.698 -0.8806
3   2.349  2.0055
4   1.496  1.0326
5   2.165  1.7870
6   1.310  0.7993
7   1.635  1.5189
8  -2.951 -4.9334
9  -1.134 -2.3609
10  2.397  3.2818
11 -0.359  0.2857
12 -2.524 -1.2257
13 -1.745 -1.0782
14 -0.349  1.1382
15  2.022  3.2981
16 -3.345 -4.1440
17 -0.322  0.4686
18 -2.075 -3.1779
19  1.738  2.2072
20 -0.339 -0.0444
> print( residuals( fit2sls5rs$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.729 -0.698  2.349  1.496  2.165  1.310  1.635 -2.951 -1.134  2.397 -0.359 
    12     13     14     15     16     17     18     19     20 
-2.524 -1.745 -0.349  2.022 -3.345 -0.322 -2.075  1.738 -0.339 
> 
> print( residuals( fit2slsd1 ) )
    demand  supply
1   1.3775 -0.4348
2   0.0125 -1.2131
3   2.9728  1.7090
4   2.2121  0.7956
5   1.6920  1.5942
6   1.0407  0.6595
7   1.4768  1.4346
8  -2.7583 -4.8724
9  -1.6807 -2.3975
10  1.4265  3.1427
11 -0.2029  0.0689
12 -1.5123 -1.3978
13 -0.4958 -1.1136
14 -0.1528  1.1684
15  0.8692  3.4865
16 -4.0547 -3.8285
17 -2.5309  0.6793
18 -1.8070 -2.7713
19  1.9299  2.6668
20  0.1853  0.6235
> print( residuals( fit2slsd1$eq[[ 2 ]] ) )
      1       2       3       4       5       6       7       8       9      10 
-0.4348 -1.2131  1.7090  0.7956  1.5942  0.6595  1.4346 -4.8724 -2.3975  3.1427 
     11      12      13      14      15      16      17      18      19      20 
 0.0689 -1.3978 -1.1136  1.1684  3.4865 -3.8285  0.6793 -2.7713  2.6668  0.6235 
> 
> print( residuals( fit2slsd2r ) )
   demand  supply
1   0.996  0.2444
2  -0.268 -0.6349
3   2.715  2.2177
4   1.936  1.2367
5   1.907  1.8612
6   1.184  0.8736
7   1.609  1.5951
8  -2.709 -4.8434
9  -1.476 -2.3949
10  1.705  3.1765
11 -0.540  0.2202
12 -2.167 -1.2182
13 -1.150 -1.0480
14 -0.316  1.0722
15  1.395  3.1209
16 -3.680 -4.3088
17 -1.669  0.1212
18 -1.829 -3.2948
19  2.016  2.0952
20  0.341 -0.0916
> print( residuals( fit2slsd2r$eq[[ 1 ]] ) )
     1      2      3      4      5      6      7      8      9     10     11 
 0.996 -0.268  2.715  1.936  1.907  1.184  1.609 -2.709 -1.476  1.705 -0.540 
    12     13     14     15     16     17     18     19     20 
-2.167 -1.150 -0.316  1.395 -3.680 -1.669 -1.829  2.016  0.341 
> 
> 
> ## *************** coefficients *********************
> print( round( coef( fit2sls1s ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            94.633             -0.244              0.314             49.532 
      supply_price   supply_farmPrice       supply_trend 
             0.240              0.256              0.253 
> print( round( coef( fit2sls1s$eq[[ 1 ]] ), digits = 6 ) )
(Intercept)       price      income 
     94.633      -0.244       0.314 
> 
> print( round( coef( fit2sls2 ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            94.282             -0.225              0.298             48.184 
      supply_price   supply_farmPrice       supply_trend 
             0.243              0.262              0.298 
> print( round( coef( fit2sls2$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     48.184       0.243       0.262       0.298 
> 
> print( round( coef( fit2sls3 ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            94.282             -0.225              0.298             48.184 
      supply_price   supply_farmPrice       supply_trend 
             0.243              0.262              0.298 
> print( round( coef( fit2sls3, modified.regMat = TRUE ), digits = 6 ) )
    C1     C2     C3     C4     C5     C6 
94.282 -0.225  0.298 48.184  0.243  0.262 
> print( round( coef( fit2sls3$eq[[ 1 ]] ), digits = 6 ) )
(Intercept)       price      income 
     94.282      -0.225       0.298 
> 
> print( round( coef( fit2sls4s ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            95.706             -0.243              0.303             46.564 
      supply_price   supply_farmPrice       supply_trend 
             0.257              0.264              0.303 
> print( round( coef( fit2sls4s$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     46.564       0.257       0.264       0.303 
> 
> print( round( coef( fit2sls5r ), digits = 6 ) )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
            95.706             -0.243              0.303             46.564 
      supply_price   supply_farmPrice       supply_trend 
             0.257              0.264              0.303 
> print( round( coef( fit2sls5r, modified.regMat = TRUE ), digits = 6 ) )
    C1     C2     C3     C4     C5     C6 
95.706 -0.243  0.303 46.564  0.257  0.264 
> print( round( coef( fit2sls5r$eq[[ 2 ]] ), digits = 6 ) )
(Intercept)       price   farmPrice       trend 
     46.564       0.257       0.264       0.303 
> 
> 
> ## *************** coefficients with stats *********************
> print( round( coef( summary( fit2sls1s ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   94.633     8.9352   10.59 0.000000
demand_price         -0.244     0.1088   -2.24 0.038916
demand_income         0.314     0.0530    5.93 0.000016
supply_(Intercept)   49.532    10.8404    4.57 0.000315
supply_price          0.240     0.0902    2.66 0.017058
supply_farmPrice      0.256     0.0426    5.99 0.000019
supply_trend          0.253     0.0899    2.81 0.012528
> print( round( coef( summary( fit2sls1s$eq[[ 1 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   94.633      8.935   10.59 0.000000
price         -0.244      0.109   -2.24 0.038916
income         0.314      0.053    5.93 0.000016
> 
> print( round( coef( summary( fit2sls2, useDfSys = FALSE ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   94.282     8.8693   10.63 0.000000
demand_price         -0.225     0.1034   -2.17 0.044246
demand_income         0.298     0.0454    6.57 0.000005
supply_(Intercept)   48.184    10.5384    4.57 0.000313
supply_price          0.243     0.0896    2.71 0.015508
supply_farmPrice      0.262     0.0411    6.38 0.000009
supply_trend          0.298     0.0454    6.57 0.000006
> print( round( coef( summary( fit2sls2$eq[[ 2 ]], useDfSys = FALSE ) ),
+    digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   48.184    10.5384    4.57 0.000313
price          0.243     0.0896    2.71 0.015508
farmPrice      0.262     0.0411    6.38 0.000009
trend          0.298     0.0454    6.57 0.000006
> 
> print( round( coef( summary( fit2sls3 ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   94.282     8.1771   11.53 0.000000
demand_price         -0.225     0.0954   -2.36 0.024352
demand_income         0.298     0.0419    7.13 0.000000
supply_(Intercept)   48.184     9.7159    4.96 0.000019
supply_price          0.243     0.0826    2.94 0.005903
supply_farmPrice      0.262     0.0379    6.92 0.000000
supply_trend          0.298     0.0419    7.13 0.000000
> print( round( coef( summary( fit2sls3 ), modified.regMat = TRUE ), digits = 6 ) )
   Estimate Std. Error t value Pr(>|t|)
C1   94.282     8.1771   11.53 0.000000
C2   -0.225     0.0954   -2.36 0.024352
C3    0.298     0.0419    7.13 0.000000
C4   48.184     9.7159    4.96 0.000019
C5    0.243     0.0826    2.94 0.005903
C6    0.262     0.0379    6.92 0.000000
> print( round( coef( summary( fit2sls3$eq[[ 1 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   94.282     8.1771   11.53   0.0000
price         -0.225     0.0954   -2.36   0.0244
income         0.298     0.0419    7.13   0.0000
> 
> print( round( coef( summary( fit2sls4s ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   95.706     6.3056   15.18 0.000000
demand_price         -0.243     0.0684   -3.56 0.001104
demand_income         0.303     0.0394    7.69 0.000000
supply_(Intercept)   46.564     8.3296    5.59 0.000003
supply_price          0.257     0.0684    3.75 0.000635
supply_farmPrice      0.264     0.0455    5.79 0.000001
supply_trend          0.303     0.0394    7.69 0.000000
> print( round( coef( summary( fit2sls4s$eq[[ 2 ]] ) ), digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   46.564     8.3296    5.59 0.000003
price          0.257     0.0684    3.75 0.000635
farmPrice      0.264     0.0455    5.79 0.000001
trend          0.303     0.0394    7.69 0.000000
> 
> print( round( coef( summary( fit2sls5r, useDfSys = FALSE ) ), digits = 6 ) )
                   Estimate Std. Error t value Pr(>|t|)
demand_(Intercept)   95.706     6.0044   15.94 0.000000
demand_price         -0.243     0.0621   -3.92 0.001102
demand_income         0.303     0.0382    7.93 0.000000
supply_(Intercept)   46.564     7.3842    6.31 0.000010
supply_price          0.257     0.0621    4.14 0.000774
supply_farmPrice      0.264     0.0373    7.08 0.000003
supply_trend          0.303     0.0382    7.93 0.000001
> print( round( coef( summary( fit2sls5r, useDfSys = FALSE ),
+    modified.regMat = TRUE ), digits = 6 ) )
   Estimate Std. Error t value Pr(>|t|)
C1   95.706     6.0044   15.94       NA
C2   -0.243     0.0621   -3.92       NA
C3    0.303     0.0382    7.93       NA
C4   46.564     7.3842    6.31       NA
C5    0.257     0.0621    4.14       NA
C6    0.264     0.0373    7.08       NA
> print( round( coef( summary( fit2sls5r$eq[[ 2 ]], useDfSys = FALSE ) ),
+    digits = 6 ) )
            Estimate Std. Error t value Pr(>|t|)
(Intercept)   46.564     7.3842    6.31 0.000010
price          0.257     0.0621    4.14 0.000774
farmPrice      0.264     0.0373    7.08 0.000003
trend          0.303     0.0382    7.93 0.000001
> 
> 
> ## *********** variance covariance matrix of the coefficients *******
> print( round( vcov( fit2sls1s ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            79.8371     -0.85694       0.06274
demand_price                  -0.8569      0.01185      -0.00336
demand_income                  0.0627     -0.00336       0.00280
supply_(Intercept)             0.0000      0.00000       0.00000
supply_price                   0.0000      0.00000       0.00000
supply_farmPrice               0.0000      0.00000       0.00000
supply_trend                   0.0000      0.00000       0.00000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)              0.000     0.000000         0.000000
demand_price                    0.000     0.000000         0.000000
demand_income                   0.000     0.000000         0.000000
supply_(Intercept)            117.514    -0.892363        -0.263795
supply_price                   -0.892     0.008136         0.000763
supply_farmPrice               -0.264     0.000763         0.001819
supply_trend                   -0.241     0.000472         0.001122
                   supply_trend
demand_(Intercept)     0.000000
demand_price           0.000000
demand_income          0.000000
supply_(Intercept)    -0.240505
supply_price           0.000472
supply_farmPrice       0.001122
supply_trend           0.008090
> print( round( vcov( fit2sls1s$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     79.8371 -0.85694  0.06274
price           -0.8569  0.01185 -0.00336
income           0.0627 -0.00336  0.00280
> 
> print( round( vcov( fit2sls1r ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            53.3287     -0.57241       0.04191
demand_price                  -0.5724      0.00791      -0.00225
demand_income                  0.0419     -0.00225       0.00187
supply_(Intercept)             0.0000      0.00000       0.00000
supply_price                   0.0000      0.00000       0.00000
supply_farmPrice               0.0000      0.00000       0.00000
supply_trend                   0.0000      0.00000       0.00000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)              0.000     0.000000         0.000000
demand_price                    0.000     0.000000         0.000000
demand_income                   0.000     0.000000         0.000000
supply_(Intercept)            115.402    -0.876328        -0.259055
supply_price                   -0.876     0.007989         0.000749
supply_farmPrice               -0.259     0.000749         0.001786
supply_trend                   -0.236     0.000463         0.001101
                   supply_trend
demand_(Intercept)     0.000000
demand_price           0.000000
demand_income          0.000000
supply_(Intercept)    -0.236183
supply_price           0.000463
supply_farmPrice       0.001101
supply_trend           0.007945
> print( round( vcov( fit2sls1r$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)     115.402 -0.876328 -0.259055 -0.236183
price            -0.876  0.007989  0.000749  0.000463
farmPrice        -0.259  0.000749  0.001786  0.001101
trend            -0.236  0.000463  0.001101  0.007945
> 
> print( round( vcov( fit2sls2 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           78.66379    -0.829021      0.046112
demand_price                 -0.82902     0.010698     -0.002471
demand_income                 0.04611    -0.002471      0.002061
supply_(Intercept)           -1.37081     0.073457     -0.061273
supply_price                  0.00269    -0.000144      0.000120
supply_farmPrice              0.00639    -0.000343      0.000286
supply_trend                  0.04611    -0.002471      0.002061
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -1.3708     0.002689         0.006393
demand_price                   0.0735    -0.000144        -0.000343
demand_income                 -0.0613     0.000120         0.000286
supply_(Intercept)           111.0580    -0.872938        -0.236592
supply_price                  -0.8729     0.008032         0.000707
supply_farmPrice              -0.2366     0.000707         0.001686
supply_trend                  -0.0613     0.000120         0.000286
                   supply_trend
demand_(Intercept)     0.046112
demand_price          -0.002471
demand_income          0.002061
supply_(Intercept)    -0.061273
supply_price           0.000120
supply_farmPrice       0.000286
supply_trend           0.002061
> print( round( vcov( fit2sls2$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     78.6638 -0.82902  0.04611
price           -0.8290  0.01070 -0.00247
income           0.0461 -0.00247  0.00206
> 
> print( round( vcov( fit2sls3 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           66.86423    -0.704668      0.039196
demand_price                 -0.70467     0.009094     -0.002100
demand_income                 0.03920    -0.002100      0.001752
supply_(Intercept)           -1.16519     0.062438     -0.052082
supply_price                  0.00229    -0.000122      0.000102
supply_farmPrice              0.00543    -0.000291      0.000243
supply_trend                  0.03920    -0.002100      0.001752
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -1.1652     0.002285         0.005434
demand_price                   0.0624    -0.000122        -0.000291
demand_income                 -0.0521     0.000102         0.000243
supply_(Intercept)            94.3993    -0.741997        -0.201104
supply_price                  -0.7420     0.006827         0.000601
supply_farmPrice              -0.2011     0.000601         0.001433
supply_trend                  -0.0521     0.000102         0.000243
                   supply_trend
demand_(Intercept)     0.039196
demand_price          -0.002100
demand_income          0.001752
supply_(Intercept)    -0.052082
supply_price           0.000102
supply_farmPrice       0.000243
supply_trend           0.001752
> print( round( vcov( fit2sls3, modified.regMat = TRUE ), digits = 6 ) )
         C1        C2        C3      C4        C5        C6
C1 66.86423 -0.704668  0.039196 -1.1652  0.002285  0.005434
C2 -0.70467  0.009094 -0.002100  0.0624 -0.000122 -0.000291
C3  0.03920 -0.002100  0.001752 -0.0521  0.000102  0.000243
C4 -1.16519  0.062438 -0.052082 94.3993 -0.741997 -0.201104
C5  0.00229 -0.000122  0.000102 -0.7420  0.006827  0.000601
C6  0.00543 -0.000291  0.000243 -0.2011  0.000601  0.001433
> print( round( vcov( fit2sls3$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)     94.3993 -0.741997 -0.201104 -0.052082
price           -0.7420  0.006827  0.000601  0.000102
farmPrice       -0.2011  0.000601  0.001433  0.000243
trend           -0.0521  0.000102  0.000243  0.001752
> 
> print( round( vcov( fit2sls4s ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            39.7610    -0.358128      -0.03842
demand_price                  -0.3581     0.004681      -0.00113
demand_income                 -0.0384    -0.001129       0.00155
supply_(Intercept)            39.6949    -0.480685       0.08595
supply_price                  -0.3581     0.004681      -0.00113
supply_farmPrice              -0.0359     0.000252       0.00011
supply_trend                  -0.0384    -0.001129       0.00155
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            39.6949    -0.358128        -0.035932
demand_price                  -0.4807     0.004681         0.000252
demand_income                  0.0859    -0.001129         0.000110
supply_(Intercept)            69.3817    -0.480685        -0.226588
supply_price                  -0.4807     0.004681         0.000252
supply_farmPrice              -0.2266     0.000252         0.002072
supply_trend                   0.0859    -0.001129         0.000110
                   supply_trend
demand_(Intercept)     -0.03842
demand_price           -0.00113
demand_income           0.00155
supply_(Intercept)      0.08595
supply_price           -0.00113
supply_farmPrice        0.00011
supply_trend            0.00155
> print( round( vcov( fit2sls4s$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     39.7610 -0.35813 -0.03842
price           -0.3581  0.00468 -0.00113
income          -0.0384 -0.00113  0.00155
> 
> print( round( vcov( fit2sls5r ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            36.0523    -0.302514     -0.057288
demand_price                  -0.3025     0.003851     -0.000847
demand_income                 -0.0573    -0.000847      0.001456
supply_(Intercept)            34.1121    -0.397307      0.057684
supply_price                  -0.3025     0.003851     -0.000847
supply_farmPrice              -0.0337     0.000218      0.000122
supply_trend                  -0.0573    -0.000847      0.001456
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            34.1121    -0.302514        -0.033671
demand_price                  -0.3973     0.003851         0.000218
demand_income                  0.0577    -0.000847         0.000122
supply_(Intercept)            54.5267    -0.397307        -0.157170
supply_price                  -0.3973     0.003851         0.000218
supply_farmPrice              -0.1572     0.000218         0.001388
supply_trend                   0.0577    -0.000847         0.000122
                   supply_trend
demand_(Intercept)    -0.057288
demand_price          -0.000847
demand_income          0.001456
supply_(Intercept)     0.057684
supply_price          -0.000847
supply_farmPrice       0.000122
supply_trend           0.001456
> print( round( vcov( fit2sls5r, modified.regMat = TRUE ), digits = 6 ) )
        C1        C2        C3      C4        C5        C6
C1 36.0523 -0.302514 -0.057288 34.1121 -0.302514 -0.033671
C2 -0.3025  0.003851 -0.000847 -0.3973  0.003851  0.000218
C3 -0.0573 -0.000847  0.001456  0.0577 -0.000847  0.000122
C4 34.1121 -0.397307  0.057684 54.5267 -0.397307 -0.157170
C5 -0.3025  0.003851 -0.000847 -0.3973  0.003851  0.000218
C6 -0.0337  0.000218  0.000122 -0.1572  0.000218  0.001388
> print( round( vcov( fit2sls5r$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)     54.5267 -0.397307 -0.157170  0.057684
price           -0.3973  0.003851  0.000218 -0.000847
farmPrice       -0.1572  0.000218  0.001388  0.000122
trend            0.0577 -0.000847  0.000122  0.001456
> 
> print( round( vcov( fit2slsd1 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            124.179     -1.51767       0.28519
demand_price                   -1.518      0.02098      -0.00595
demand_income                   0.285     -0.00595       0.00318
supply_(Intercept)              0.000      0.00000       0.00000
supply_price                    0.000      0.00000       0.00000
supply_farmPrice                0.000      0.00000       0.00000
supply_trend                    0.000      0.00000       0.00000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)              0.000     0.000000         0.000000
demand_price                    0.000     0.000000         0.000000
demand_income                   0.000     0.000000         0.000000
supply_(Intercept)            144.253    -1.095410        -0.323818
supply_price                   -1.095     0.009987         0.000936
supply_farmPrice               -0.324     0.000936         0.002233
supply_trend                   -0.295     0.000579         0.001377
                   supply_trend
demand_(Intercept)     0.000000
demand_price           0.000000
demand_income          0.000000
supply_(Intercept)    -0.295229
supply_price           0.000579
supply_farmPrice       0.001377
supply_trend           0.009931
> print( round( vcov( fit2slsd1$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     124.179 -1.51767  0.28519
price            -1.518  0.02098 -0.00595
income            0.285 -0.00595  0.00318
> 
> print( round( vcov( fit2slsd2rs ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)            95.9017    -1.129212      0.176368
demand_price                  -1.1292     0.014881     -0.003682
demand_income                  0.1764    -0.003682      0.001968
supply_(Intercept)            -5.2430     0.109460     -0.058492
supply_price                   0.0103    -0.000215      0.000115
supply_farmPrice               0.0245    -0.000510      0.000273
supply_trend                   0.1764    -0.003682      0.001968
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -5.2430     0.010284         0.024451
demand_price                   0.1095    -0.000215        -0.000510
demand_income                 -0.0585     0.000115         0.000273
supply_(Intercept)           114.2555    -0.898881        -0.243056
supply_price                  -0.8989     0.008273         0.000727
supply_farmPrice              -0.2431     0.000727         0.001733
supply_trend                  -0.0585     0.000115         0.000273
                   supply_trend
demand_(Intercept)     0.176368
demand_price          -0.003682
demand_income          0.001968
supply_(Intercept)    -0.058492
supply_price           0.000115
supply_farmPrice       0.000273
supply_trend           0.001968
> print( round( vcov( fit2slsd2rs$eq[[ 2 ]] ), digits = 6 ) )
            (Intercept)     price farmPrice     trend
(Intercept)    114.2555 -0.898881 -0.243056 -0.058492
price           -0.8989  0.008273  0.000727  0.000115
farmPrice       -0.2431  0.000727  0.001733  0.000273
trend           -0.0585  0.000115  0.000273  0.001968
> 
> print( round( vcov( fit2slsd3 ), digits = 6 ) )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)           141.4425    -1.640068      0.234151
demand_price                  -1.6401     0.021165     -0.004888
demand_income                  0.2342    -0.004888      0.002612
supply_(Intercept)            -6.9607     0.145321     -0.077656
supply_price                   0.0137    -0.000285      0.000152
supply_farmPrice               0.0325    -0.000678      0.000362
supply_trend                   0.2342    -0.004888      0.002612
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)            -6.9607     0.013653         0.032462
demand_price                   0.1453    -0.000285        -0.000678
demand_income                 -0.0777     0.000152         0.000362
supply_(Intercept)           111.0123    -0.869653        -0.237751
supply_price                  -0.8697     0.007995         0.000708
supply_farmPrice              -0.2378     0.000708         0.001688
supply_trend                  -0.0777     0.000152         0.000362
                   supply_trend
demand_(Intercept)     0.234151
demand_price          -0.004888
demand_income          0.002612
supply_(Intercept)    -0.077656
supply_price           0.000152
supply_farmPrice       0.000362
supply_trend           0.002612
> print( round( vcov( fit2slsd3, modified.regMat = TRUE ), digits = 6 ) )
         C1        C2        C3       C4        C5        C6
C1 141.4425 -1.640068  0.234151  -6.9607  0.013653  0.032462
C2  -1.6401  0.021165 -0.004888   0.1453 -0.000285 -0.000678
C3   0.2342 -0.004888  0.002612  -0.0777  0.000152  0.000362
C4  -6.9607  0.145321 -0.077656 111.0123 -0.869653 -0.237751
C5   0.0137 -0.000285  0.000152  -0.8697  0.007995  0.000708
C6   0.0325 -0.000678  0.000362  -0.2378  0.000708  0.001688
> print( round( vcov( fit2slsd3$eq[[ 1 ]] ), digits = 6 ) )
            (Intercept)    price   income
(Intercept)     141.442 -1.64007  0.23415
price            -1.640  0.02116 -0.00489
income            0.234 -0.00489  0.00261
> 
> 
> ## *********** confidence intervals of coefficients *************
> print( confint( fit2sls1 ) )
                    2.5 %  97.5 %
demand_(Intercept) 77.922 111.345
demand_price       -0.447  -0.040
demand_income       0.215   0.413
supply_(Intercept) 24.071  74.994
supply_price        0.028   0.452
supply_farmPrice    0.155   0.356
supply_trend        0.042   0.464
> print( confint( fit2sls1$eq[[ 1 ]], level = 0.9 ) )
               5 %    95 %
(Intercept) 80.854 108.412
price       -0.411  -0.076
income       0.232   0.396
> 
> print( confint( fit2sls2s, level = 0.9 ) )
                      5 %    95 %
demand_(Intercept) 78.005 110.558
demand_price       -0.417  -0.032
demand_income       0.211   0.386
supply_(Intercept) 24.204  72.165
supply_price        0.038   0.447
supply_farmPrice    0.169   0.355
supply_trend        0.211   0.386
> print( confint( fit2sls2s$eq[[ 2 ]], level = 0.99 ) )
             0.5 % 99.5 %
(Intercept) 15.989 80.380
price       -0.032  0.517
farmPrice    0.137  0.387
trend        0.181  0.416
> 
> print( confint( fit2sls3, level = 0.99, useDfSys = TRUE ) )
                    0.5 %  99.5 %
demand_(Intercept) 77.664 110.899
demand_price       -0.419  -0.031
demand_income       0.213   0.383
supply_(Intercept) 28.439  67.929
supply_price        0.075   0.411
supply_farmPrice    0.185   0.339
supply_trend        0.213   0.383
> print( confint( fit2sls3$eq[[ 1 ]], level = 0.5, useDfSys = TRUE ) )
             25 %   75 %
(Intercept) 88.71 99.857
price       -0.29 -0.160
income       0.27  0.327
> 
> print( confint( fit2sls4r, level = 0.5 ) )
                     25 %    75 %
demand_(Intercept) 83.516 107.895
demand_price       -0.369  -0.117
demand_income       0.225   0.380
supply_(Intercept) 31.573  61.554
supply_price        0.131   0.383
supply_farmPrice    0.188   0.339
supply_trend        0.225   0.380
> print( confint( fit2sls4r$eq[[ 2 ]], level = 0.25 ) )
            37.5 % 62.5 %
(Intercept) 44.192 48.935
price        0.237  0.277
farmPrice    0.252  0.276
trend        0.290  0.315
> 
> print( confint( fit2sls5rs, level = 0.25 ) )
                   37.5 %  62.5 %
demand_(Intercept) 84.017 107.395
demand_price       -0.369  -0.117
demand_income       0.230   0.376
supply_(Intercept) 31.265  61.863
supply_price        0.131   0.383
supply_farmPrice    0.181   0.346
supply_trend        0.230   0.376
> print( confint( fit2sls5rs$eq[[ 1 ]], level = 0.975 ) )
             1.3 %  98.8 %
(Intercept) 82.221 109.191
price       -0.389  -0.098
income       0.218   0.387
> 
> print( confint( fit2slsd1, level = 0.975, useDfSys = TRUE ) )
                    1.3 %  98.8 %
demand_(Intercept) 84.118 129.461
demand_price       -0.706  -0.117
demand_income       0.247   0.476
supply_(Intercept) 25.097  73.968
supply_price        0.037   0.443
supply_farmPrice    0.159   0.352
supply_trend        0.050   0.456
> print( confint( fit2slsd1$eq[[ 2 ]], level = 0.999, useDfSys = TRUE ) )
             0.1 %  100 %
(Intercept)  6.163 92.901
price       -0.121  0.601
farmPrice    0.085  0.426
trend       -0.107  0.613
> 
> print( confint( fit2slsd2r, level = 0.999 ) )
                    0.1 %   100 %
demand_(Intercept) 81.311 125.877
demand_price       -0.617  -0.072
demand_income       0.230   0.422
supply_(Intercept) 27.618  67.100
supply_price        0.077   0.412
supply_farmPrice    0.189   0.343
supply_trend        0.230   0.422
> print( confint( fit2slsd2r$eq[[ 1 ]] ) )
             2.5 %  97.5 %
(Intercept) 81.311 125.877
price       -0.617  -0.072
income       0.230   0.422
> 
> 
> ## *********** fitted values *************
> print( fitted( fit2sls1, se.fit = TRUE, interval = "prediction" ) )
   demand supply
1    97.6   98.9
2    99.9  100.4
3    99.8  100.5
4   100.0  100.7
5   102.1  102.6
6   102.0  102.6
7   102.4  102.6
8   103.0  104.8
9   101.5  102.7
10  100.3   99.7
11   95.5   95.4
12   94.7   93.8
13   96.1   95.6
14   99.0   97.6
15  103.8  102.3
16  103.7  104.1
17  103.8  102.8
18  102.1  102.7
19  103.6  102.6
20  106.9  105.6
> print( fitted( fit2sls1$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.6  99.9  99.8 100.0 102.1 102.0 102.4 103.0 101.5 100.3  95.5  94.7  96.1 
   14    15    16    17    18    19    20 
 99.0 103.8 103.7 103.8 102.1 103.6 106.9 
> 
> print( fitted( fit2sls2s ) )
   demand supply
1    97.8   98.5
2   100.0  100.0
3    99.9  100.1
4   100.1  100.4
5   102.0  102.5
6   101.9  102.5
7   102.4  102.5
8   102.9  104.8
9   101.4  102.7
10  100.3   99.7
11   95.8   95.3
12   95.0   93.7
13   96.4   95.6
14   99.1   97.6
15  103.7  102.5
16  103.5  104.4
17  103.6  103.2
18  102.0  103.0
19  103.5  102.9
20  106.7  106.1
> print( fitted( fit2sls2s$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.5 100.0 100.1 100.4 102.5 102.5 102.5 104.8 102.7  99.7  95.3  93.7  95.6 
   14    15    16    17    18    19    20 
 97.6 102.5 104.4 103.2 103.0 102.9 106.1 
> 
> print( fitted( fit2sls3 ) )
   demand supply
1    97.8   98.5
2   100.0  100.0
3    99.9  100.1
4   100.1  100.4
5   102.0  102.5
6   101.9  102.5
7   102.4  102.5
8   102.9  104.8
9   101.4  102.7
10  100.3   99.7
11   95.8   95.3
12   95.0   93.7
13   96.4   95.6
14   99.1   97.6
15  103.7  102.5
16  103.5  104.4
17  103.6  103.2
18  102.0  103.0
19  103.5  102.9
20  106.7  106.1
> print( fitted( fit2sls3$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.8 100.0  99.9 100.1 102.0 101.9 102.4 102.9 101.4 100.3  95.8  95.0  96.4 
   14    15    16    17    18    19    20 
 99.1 103.7 103.5 103.6 102.0 103.5 106.7 
> 
> print( fitted( fit2sls4r ) )
   demand supply
1    97.8   98.5
2    99.9  100.1
3    99.8  100.2
4   100.0  100.5
5   102.1  102.5
6   101.9  102.4
7   102.4  102.5
8   102.9  104.8
9   101.5  102.7
10  100.4   99.5
11   95.8   95.1
12   94.9   93.6
13   96.3   95.6
14   99.1   97.6
15  103.8  102.5
16  103.6  104.4
17  103.8  103.1
18  102.0  103.1
19  103.5  103.0
20  106.6  106.3
> print( fitted( fit2sls4r$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.5 100.1 100.2 100.5 102.5 102.4 102.5 104.8 102.7  99.5  95.1  93.6  95.6 
   14    15    16    17    18    19    20 
 97.6 102.5 104.4 103.1 103.1 103.0 106.3 
> 
> print( fitted( fit2sls5rs ) )
   demand supply
1    97.8   98.5
2    99.9  100.1
3    99.8  100.2
4   100.0  100.5
5   102.1  102.5
6   101.9  102.4
7   102.4  102.5
8   102.9  104.8
9   101.5  102.7
10  100.4   99.5
11   95.8   95.1
12   94.9   93.6
13   96.3   95.6
14   99.1   97.6
15  103.8  102.5
16  103.6  104.4
17  103.8  103.1
18  102.0  103.1
19  103.5  103.0
20  106.6  106.3
> print( fitted( fit2sls5rs$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.8  99.9  99.8 100.0 102.1 101.9 102.4 102.9 101.5 100.4  95.8  94.9  96.3 
   14    15    16    17    18    19    20 
 99.1 103.8 103.6 103.8 102.0 103.5 106.6 
> 
> print( fitted( fit2slsd1 ) )
   demand supply
1    97.1   98.9
2    99.2  100.4
3    99.2  100.5
4    99.3  100.7
5   102.5  102.6
6   102.2  102.6
7   102.5  102.6
8   102.7  104.8
9   102.0  102.7
10  101.4   99.7
11   95.6   95.4
12   93.9   93.8
13   95.0   95.6
14   98.9   97.6
15  104.9  102.3
16  104.3  104.1
17  106.1  102.8
18  101.7  102.7
19  103.3  102.6
20  106.0  105.6
> print( fitted( fit2slsd1$eq[[ 2 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 98.9 100.4 100.5 100.7 102.6 102.6 102.6 104.8 102.7  99.7  95.4  93.8  95.6 
   14    15    16    17    18    19    20 
 97.6 102.3 104.1 102.8 102.7 102.6 105.6 
> 
> print( fitted( fit2slsd2r ) )
   demand supply
1    97.5   98.2
2    99.5   99.8
3    99.4   99.9
4    99.6  100.3
5   102.3  102.4
6   102.1  102.4
7   102.4  102.4
8   102.6  104.7
9   101.8  102.7
10  101.1   99.6
11   96.0   95.2
12   94.6   93.6
13   95.7   95.6
14   99.1   97.7
15  104.4  102.7
16  103.9  104.5
17  105.2  103.4
18  101.8  103.2
19  103.2  103.1
20  105.9  106.3
> print( fitted( fit2slsd2r$eq[[ 1 ]] ) )
    1     2     3     4     5     6     7     8     9    10    11    12    13 
 97.5  99.5  99.4  99.6 102.3 102.1 102.4 102.6 101.8 101.1  96.0  94.6  95.7 
   14    15    16    17    18    19    20 
 99.1 104.4 103.9 105.2 101.8 103.2 105.9 
> 
> 
> ## *********** predicted values *************
> predictData <- Kmenta
> predictData$consump <- NULL
> predictData$price <- Kmenta$price * 0.9
> predictData$income <- Kmenta$income * 1.1
> 
> print( predict( fit2sls1, se.fit = TRUE, interval = "prediction" ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         97.6         0.661       93.3      102.0        98.9         1.079
2         99.9         0.600       95.5      104.2       100.4         1.064
3         99.8         0.564       95.5      104.1       100.5         0.962
4        100.0         0.605       95.7      104.4       100.7         0.938
5        102.1         0.516       97.8      106.4       102.6         0.914
6        102.0         0.474       97.7      106.2       102.6         0.808
7        102.4         0.493       98.1      106.7       102.6         0.736
8        103.0         0.615       98.6      107.3       104.8         0.994
9        101.5         0.544       97.2      105.8       102.7         0.808
10       100.3         0.822       95.8      104.8        99.7         1.023
11        95.5         0.963       90.9      100.2        95.4         1.228
12        94.7         1.006       90.1       99.4        93.8         1.428
13        96.1         0.915       91.6      100.7        95.6         1.272
14        99.0         0.518       94.7      103.3        97.6         0.917
15       103.8         0.793       99.4      108.3       102.3         0.899
16       103.7         0.636       99.3      108.0       104.1         0.936
17       103.8         1.348       98.8      108.9       102.8         1.665
18       102.1         0.549       97.8      106.4       102.7         0.988
19       103.6         0.695       99.2      108.0       102.6         1.129
20       106.9         1.306      101.9      111.9       105.6         1.733
   supply.lwr supply.upr
1        93.2      104.6
2        94.7      106.1
3        94.9      106.0
4        95.1      106.3
5        97.1      108.2
6        97.1      108.1
7        97.1      108.0
8        99.2      110.4
9        97.3      108.2
10       94.0      105.3
11       89.5      101.2
12       87.8       99.8
13       89.8      101.5
14       92.0      103.1
15       96.8      107.9
16       98.5      109.6
17       96.5      109.1
18       97.1      108.3
19       96.8      108.3
20       99.2      112.0
> print( predict( fit2sls1$eq[[ 1 ]], se.fit = TRUE, interval = "prediction" ) )
     fit se.fit   lwr   upr
1   97.6  0.661  93.3 102.0
2   99.9  0.600  95.5 104.2
3   99.8  0.564  95.5 104.1
4  100.0  0.605  95.7 104.4
5  102.1  0.516  97.8 106.4
6  102.0  0.474  97.7 106.2
7  102.4  0.493  98.1 106.7
8  103.0  0.615  98.6 107.3
9  101.5  0.544  97.2 105.8
10 100.3  0.822  95.8 104.8
11  95.5  0.963  90.9 100.2
12  94.7  1.006  90.1  99.4
13  96.1  0.915  91.6 100.7
14  99.0  0.518  94.7 103.3
15 103.8  0.793  99.4 108.3
16 103.7  0.636  99.3 108.0
17 103.8  1.348  98.8 108.9
18 102.1  0.549  97.8 106.4
19 103.6  0.695  99.2 108.0
20 106.9  1.306 101.9 111.9
> 
> print( predict( fit2sls2s, se.pred = TRUE, interval = "confidence",
+    level = 0.999, newdata = predictData ) )
   demand.pred demand.se.pred demand.lwr demand.upr supply.pred supply.se.pred
1        102.7           2.23       99.1        106        96.1           2.75
2        105.2           2.23      101.6        109        97.5           2.64
3        105.1           2.24      101.4        109        97.6           2.65
4        105.4           2.23      101.8        109        97.9           2.62
5        107.2           2.52      101.7        113       100.1           2.83
6        107.1           2.46      101.9        112       100.0           2.77
7        107.7           2.45      102.6        113       100.0           2.70
8        108.5           2.41      103.6        113       102.2           2.65
9        106.5           2.53      100.9        112       100.4           2.87
10       105.0           2.66       98.7        111        97.4           3.10
11       100.1           2.42       95.1        105        93.0           3.17
12        99.5           2.22       96.0        103        91.3           3.14
13       101.2           2.13       98.5        104        93.1           2.95
14       104.0           2.32       99.7        108        95.3           2.91
15       108.9           2.74      102.1        116       100.2           2.92
16       108.9           2.62      102.7        115       102.0           2.79
17       108.4           3.09       99.9        117       101.1           3.37
18       107.5           2.36      102.9        112       100.5           2.65
19       109.2           2.44      104.1        114       100.3           2.64
20       113.0           2.67      106.6        119       103.3           2.58
   supply.lwr supply.upr
1        91.8      100.4
2        94.3      100.8
3        94.2      101.0
4        94.8      101.0
5        95.2      105.0
6        95.6      104.5
7        96.1      103.9
8        98.9      105.6
9        95.2      105.6
10       90.7      104.1
11       85.9      100.2
12       84.4       98.3
13       87.3       98.9
14       89.7      100.8
15       94.7      105.8
16       97.3      106.6
17       92.9      109.3
18       97.1      103.9
19       97.1      103.6
20      100.7      105.9
> print( predict( fit2sls2s$eq[[ 2 ]], se.pred = TRUE, interval = "confidence",
+    level = 0.999, newdata = predictData ) )
     fit se.pred   lwr   upr
1   96.1    2.75  91.8 100.4
2   97.5    2.64  94.3 100.8
3   97.6    2.65  94.2 101.0
4   97.9    2.62  94.8 101.0
5  100.1    2.83  95.2 105.0
6  100.0    2.77  95.6 104.5
7  100.0    2.70  96.1 103.9
8  102.2    2.65  98.9 105.6
9  100.4    2.87  95.2 105.6
10  97.4    3.10  90.7 104.1
11  93.0    3.17  85.9 100.2
12  91.3    3.14  84.4  98.3
13  93.1    2.95  87.3  98.9
14  95.3    2.91  89.7 100.8
15 100.2    2.92  94.7 105.8
16 102.0    2.79  97.3 106.6
17 101.1    3.37  92.9 109.3
18 100.5    2.65  97.1 103.9
19 100.3    2.64  97.1 103.6
20 103.3    2.58 100.7 105.9
> 
> print( predict( fit2sls3, se.pred = TRUE, interval = "prediction",
+    level = 0.975, useDfSys = TRUE ) )
   demand.pred demand.se.pred demand.lwr demand.upr supply.pred supply.se.pred
1         97.8           2.09       92.9        103        98.5           2.55
2        100.0           2.08       95.1        105       100.0           2.57
3         99.9           2.07       95.0        105       100.1           2.55
4        100.1           2.08       95.2        105       100.4           2.56
5        102.0           2.06       97.2        107       102.5           2.58
6        101.9           2.05       97.1        107       102.5           2.56
7        102.4           2.05       97.5        107       102.5           2.55
8        102.9           2.09       98.0        108       104.8           2.61
9        101.4           2.07       96.6        106       102.7           2.57
10       100.3           2.17       95.2        105        99.7           2.62
11        95.8           2.20       90.6        101        95.3           2.67
12        95.0           2.20       89.9        100        93.7           2.74
13        96.4           2.17       91.3        101        95.6           2.69
14        99.1           2.06       94.3        104        97.6           2.59
15       103.7           2.14       98.7        109       102.5           2.56
16       103.5           2.08       98.6        108       104.4           2.55
17       103.6           2.40       98.0        109       103.2           2.78
18       102.0           2.07       97.2        107       103.0           2.56
19       103.5           2.11       98.6        108       102.9           2.59
20       106.7           2.38      101.1        112       106.1           2.78
   supply.lwr supply.upr
1        92.5        104
2        94.0        106
3        94.1        106
4        94.4        106
5        96.4        109
6        96.5        108
7        96.5        108
8        98.6        111
9        96.7        109
10       93.5        106
11       89.0        102
12       87.3        100
13       89.3        102
14       91.6        104
15       96.5        109
16       98.4        110
17       96.7        110
18       97.0        109
19       96.8        109
20       99.5        113
> print( predict( fit2sls3$eq[[ 1 ]], se.pred = TRUE, interval = "prediction",
+    level = 0.975, useDfSys = TRUE ) )
     fit se.pred   lwr upr
1   97.8    2.09  92.9 103
2  100.0    2.08  95.1 105
3   99.9    2.07  95.0 105
4  100.1    2.08  95.2 105
5  102.0    2.06  97.2 107
6  101.9    2.05  97.1 107
7  102.4    2.05  97.5 107
8  102.9    2.09  98.0 108
9  101.4    2.07  96.6 106
10 100.3    2.17  95.2 105
11  95.8    2.20  90.6 101
12  95.0    2.20  89.9 100
13  96.4    2.17  91.3 101
14  99.1    2.06  94.3 104
15 103.7    2.14  98.7 109
16 103.5    2.08  98.6 108
17 103.6    2.40  98.0 109
18 102.0    2.07  97.2 107
19 103.5    2.11  98.6 108
20 106.7    2.38 101.1 112
> 
> print( predict( fit2sls4r, se.fit = TRUE, interval = "confidence",
+    level = 0.25 ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         97.8         0.602       97.6       97.9        98.5         0.586
2         99.9         0.526       99.7      100.1       100.1         0.672
3         99.8         0.508       99.7      100.0       100.2         0.621
4        100.0         0.530       99.8      100.2       100.5         0.632
5        102.1         0.488      101.9      102.2       102.5         0.704
6        101.9         0.474      101.8      102.1       102.4         0.636
7        102.4         0.498      102.2      102.5       102.5         0.587
8        102.9         0.604      102.7      103.0       104.8         0.764
9        101.5         0.502      101.3      101.6       102.7         0.656
10       100.4         0.696      100.2      100.6        99.5         0.710
11        95.8         0.928       95.5       96.1        95.1         0.885
12        94.9         0.889       94.7       95.2        93.6         1.146
13        96.3         0.739       96.0       96.5        95.6         1.052
14        99.1         0.519       98.9       99.3        97.6         0.746
15       103.8         0.626      103.6      104.0       102.5         0.637
16       103.6         0.566      103.4      103.8       104.4         0.615
17       103.8         0.942      103.5      104.1       103.1         1.153
18       102.0         0.540      101.8      102.2       103.1         0.556
19       103.5         0.677      103.3      103.7       103.0         0.631
20       106.6         1.226      106.2      107.0       106.3         0.900
   supply.lwr supply.upr
1        98.3       98.7
2        99.9      100.3
3       100.0      100.4
4       100.3      100.7
5       102.2      102.7
6       102.2      102.6
7       102.3      102.7
8       104.6      105.1
9       102.5      102.9
10       99.3       99.8
11       94.9       95.4
12       93.3       94.0
13       95.3       96.0
14       97.4       97.9
15      102.3      102.7
16      104.2      104.6
17      102.7      103.4
18      102.9      103.3
19      102.8      103.2
20      106.0      106.6
> print( predict( fit2sls4r$eq[[ 2 ]], se.fit = TRUE, interval = "confidence",
+    level = 0.25 ) )
     fit se.fit   lwr   upr
1   98.5  0.586  98.3  98.7
2  100.1  0.672  99.9 100.3
3  100.2  0.621 100.0 100.4
4  100.5  0.632 100.3 100.7
5  102.5  0.704 102.2 102.7
6  102.4  0.636 102.2 102.6
7  102.5  0.587 102.3 102.7
8  104.8  0.764 104.6 105.1
9  102.7  0.656 102.5 102.9
10  99.5  0.710  99.3  99.8
11  95.1  0.885  94.9  95.4
12  93.6  1.146  93.3  94.0
13  95.6  1.052  95.3  96.0
14  97.6  0.746  97.4  97.9
15 102.5  0.637 102.3 102.7
16 104.4  0.615 104.2 104.6
17 103.1  1.153 102.7 103.4
18 103.1  0.556 102.9 103.3
19 103.0  0.631 102.8 103.2
20 106.3  0.900 106.0 106.6
> 
> print( predict( fit2sls5rs, se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = predictData ) )
   demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1        102.8         0.713           2.10      101.4        104        95.9
2        105.4         0.742           2.11      103.9        107        97.4
3        105.3         0.751           2.11      103.8        107        97.5
4        105.5         0.749           2.11      104.1        107        97.8
5        107.5         1.080           2.25      105.9        109        99.9
6        107.4         1.031           2.23      105.9        109        99.9
7        107.9         1.040           2.23      106.4        109        99.9
8        108.7         1.044           2.23      107.1        110       102.1
9        106.8         1.073           2.24      105.2        108       100.2
10       105.3         1.188           2.30      103.8        107        97.2
11       100.3         1.013           2.22       98.8        102        92.8
12        99.7         0.770           2.12       98.2        101        91.1
13       101.3         0.584           2.06       99.9        103        93.0
14       104.3         0.833           2.14      102.8        106        95.1
15       109.2         1.310           2.37      107.6        111       100.1
16       109.1         1.214           2.32      107.6        111       101.8
17       108.9         1.582           2.53      107.1        111       100.8
18       107.7         0.958           2.19      106.2        109       100.4
19       109.4         1.111           2.26      107.9        111       100.3
20       113.2         1.529           2.50      111.5        115       103.4
   supply.se.fit supply.se.pred supply.lwr supply.upr
1          0.746           2.61       94.1       97.7
2          0.628           2.58       95.6       99.1
3          0.642           2.58       95.7       99.3
4          0.607           2.57       96.0       99.5
5          0.978           2.68       98.1      101.8
6          0.881           2.65       98.1      101.7
7          0.786           2.62       98.1      101.7
8          0.780           2.62      100.4      103.9
9          1.031           2.70       98.4      102.1
10         1.212           2.78       95.3       99.1
11         1.339           2.84       90.8       94.7
12         1.478           2.90       89.1       93.1
13         1.292           2.81       91.1       94.9
14         1.123           2.74       93.2       97.0
15         1.105           2.73       98.2      101.9
16         0.996           2.69      100.0      103.7
17         1.636           2.99       98.8      102.9
18         0.777           2.62       98.7      102.2
19         0.775           2.62       98.5      102.1
20         0.600           2.57      101.6      105.1
> print( predict( fit2sls5rs$eq[[ 1 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = predictData ) )
     fit se.fit se.pred   lwr upr
1  102.8  0.713    2.10 101.4 104
2  105.4  0.742    2.11 103.9 107
3  105.3  0.751    2.11 103.8 107
4  105.5  0.749    2.11 104.1 107
5  107.5  1.080    2.25 105.9 109
6  107.4  1.031    2.23 105.9 109
7  107.9  1.040    2.23 106.4 109
8  108.7  1.044    2.23 107.1 110
9  106.8  1.073    2.24 105.2 108
10 105.3  1.188    2.30 103.8 107
11 100.3  1.013    2.22  98.8 102
12  99.7  0.770    2.12  98.2 101
13 101.3  0.584    2.06  99.9 103
14 104.3  0.833    2.14 102.8 106
15 109.2  1.310    2.37 107.6 111
16 109.1  1.214    2.32 107.6 111
17 108.9  1.582    2.53 107.1 111
18 107.7  0.958    2.19 106.2 109
19 109.4  1.111    2.26 107.9 111
20 113.2  1.529    2.50 111.5 115
> 
> print( predict( fit2slsd1, se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.99, useDfSys = TRUE ) )
   demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1         97.1         0.751           2.13       95.1       99.2        98.9
2         99.2         0.757           2.13       97.1      101.2       100.4
3         99.2         0.692           2.11       97.3      101.1       100.5
4         99.3         0.766           2.13       97.2      101.4       100.7
5        102.5         0.595           2.08      100.9      104.2       102.6
6        102.2         0.503           2.05      100.8      103.6       102.6
7        102.5         0.503           2.05      101.1      103.9       102.6
8        102.7         0.653           2.10      100.9      104.4       104.8
9        102.0         0.655           2.10      100.2      103.8       102.7
10       101.4         1.074           2.26       98.5      104.3        99.7
11        95.6         0.978           2.22       93.0       98.3        95.4
12        93.9         1.134           2.29       90.8       97.0        93.8
13        95.0         1.162           2.31       91.9       98.2        95.6
14        98.9         0.530           2.06       97.5      100.4        97.6
15       104.9         1.061           2.26      102.0      107.8       102.3
16       104.3         0.757           2.13      102.2      106.3       104.1
17       106.1         1.963           2.80      100.7      111.4       102.8
18       101.7         0.597           2.08      100.1      103.4       102.7
19       103.3         0.736           2.12      101.3      105.3       102.6
20       106.0         1.430           2.45      102.1      110.0       105.6
   supply.se.fit supply.se.pred supply.lwr supply.upr
1          1.079           2.68       96.0      101.9
2          1.064           2.68       97.5      103.3
3          0.962           2.64       97.8      103.1
4          0.938           2.63       98.1      103.3
5          0.914           2.62      100.1      105.1
6          0.808           2.59      100.4      104.8
7          0.736           2.57      100.5      104.6
8          0.994           2.65      102.1      107.5
9          0.808           2.59      100.5      105.0
10         1.023           2.66       96.9      102.5
11         1.228           2.75       92.0       98.7
12         1.428           2.84       89.9       97.7
13         1.272           2.77       92.2       99.1
14         0.917           2.62       95.1      100.1
15         0.899           2.62       99.9      104.8
16         0.936           2.63      101.5      106.6
17         1.665           2.97       98.3      107.4
18         0.988           2.65      100.0      105.4
19         1.129           2.70       99.5      105.6
20         1.733           3.01      100.9      110.3
> print( predict( fit2slsd1$eq[[ 2 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.99, useDfSys = TRUE ) )
     fit se.fit se.pred   lwr   upr
1   98.9  1.079    2.68  96.0 101.9
2  100.4  1.064    2.68  97.5 103.3
3  100.5  0.962    2.64  97.8 103.1
4  100.7  0.938    2.63  98.1 103.3
5  102.6  0.914    2.62 100.1 105.1
6  102.6  0.808    2.59 100.4 104.8
7  102.6  0.736    2.57 100.5 104.6
8  104.8  0.994    2.65 102.1 107.5
9  102.7  0.808    2.59 100.5 105.0
10  99.7  1.023    2.66  96.9 102.5
11  95.4  1.228    2.75  92.0  98.7
12  93.8  1.428    2.84  89.9  97.7
13  95.6  1.272    2.77  92.2  99.1
14  97.6  0.917    2.62  95.1 100.1
15 102.3  0.899    2.62  99.9 104.8
16 104.1  0.936    2.63 101.5 106.6
17 102.8  1.665    2.97  98.3 107.4
18 102.7  0.988    2.65 100.0 105.4
19 102.6  1.129    2.70  99.5 105.6
20 105.6  1.733    3.01 100.9 110.3
> 
> print( predict( fit2slsd2r, se.fit = TRUE, interval = "prediction",
+    level = 0.9, newdata = predictData ) )
   demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1          104          1.34       99.8        108        95.8         1.026
2          106          1.27      102.3        110        97.3         0.786
3          106          1.32      102.2        110        97.4         0.804
4          106          1.27      102.4        110        97.7         0.734
5          109          2.06      104.2        114       100.0         1.130
6          109          1.92      104.1        113        99.9         1.014
7          109          1.86      104.7        114        99.9         0.893
8          110          1.67      105.4        114       102.2         0.765
9          108          2.12      103.4        113       100.4         1.187
10         107          2.45      101.9        112        97.4         1.525
11         102          1.85       97.1        106        92.9         1.627
12         101          1.26       96.6        104        91.2         1.587
13         102          0.98       98.3        106        93.1         1.314
14         105          1.63      101.1        110        95.3         1.253
15         111          2.53      105.6        116       100.4         1.269
16         111          2.23      105.7        116       102.1         1.075
17         111          3.28      104.9        118       101.3         1.888
18         109          1.59      104.5        113       100.7         0.796
19         110          1.70      106.1        115       100.5         0.772
20         114          1.87      109.4        119       103.6         0.656
   supply.lwr supply.upr
1        91.2      100.4
2        92.8      101.7
3        93.0      101.9
4        93.3      102.1
5        95.3      104.6
6        95.4      104.5
7        95.4      104.4
8        97.8      106.6
9        95.7      105.1
10       92.5      102.4
11       87.9       98.0
12       86.2       96.2
13       88.3       97.9
14       90.5      100.0
15       95.6      105.1
16       97.5      106.7
17       96.0      106.6
18       96.2      105.1
19       96.1      105.0
20       99.2      107.9
> print( predict( fit2slsd2r$eq[[ 1 ]], se.fit = TRUE, interval = "prediction",
+    level = 0.9, newdata = predictData ) )
   fit se.fit   lwr upr
1  104   1.34  99.8 108
2  106   1.27 102.3 110
3  106   1.32 102.2 110
4  106   1.27 102.4 110
5  109   2.06 104.2 114
6  109   1.92 104.1 113
7  109   1.86 104.7 114
8  110   1.67 105.4 114
9  108   2.12 103.4 113
10 107   2.45 101.9 112
11 102   1.85  97.1 106
12 101   1.26  96.6 104
13 102   0.98  98.3 106
14 105   1.63 101.1 110
15 111   2.53 105.6 116
16 111   2.23 105.7 116
17 111   3.28 104.9 118
18 109   1.59 104.5 113
19 110   1.70 106.1 115
20 114   1.87 109.4 119
> 
> # predict just one observation
> smallData <- data.frame( price = 130, income = 150, farmPrice = 120,
+    trend = 25 )
> 
> print( predict( fit2sls1rs, newdata = smallData ) )
  demand.pred supply.pred
1         110         118
> print( predict( fit2sls1rs$eq[[ 1 ]], newdata = smallData ) )
  fit
1 110
> 
> print( predict( fit2sls2, se.fit = TRUE, level = 0.9,
+    newdata = smallData ) )
  demand.pred demand.se.fit supply.pred supply.se.fit
1         110          2.79         119          3.18
> print( predict( fit2sls2$eq[[ 1 ]], se.pred = TRUE, level = 0.99,
+    newdata = smallData ) )
  fit se.pred
1 110    3.42
> 
> print( predict( fit2sls3, interval = "prediction", level = 0.975,
+    newdata = smallData ) )
  demand.pred demand.lwr demand.upr supply.pred supply.lwr supply.upr
1         110        102        117         119        110        128
> print( predict( fit2sls3$eq[[ 1 ]], interval = "confidence", level = 0.8,
+    newdata = smallData ) )
  fit lwr upr
1 110 106 113
> 
> print( predict( fit2sls4r, se.fit = TRUE, interval = "confidence",
+    level = 0.999, newdata = smallData ) )
  demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         109          2.24        101        118         119          2.09
  supply.lwr supply.upr
1        112        127
> print( predict( fit2sls4r$eq[[ 2 ]], se.pred = TRUE, interval = "prediction",
+    level = 0.75, newdata = smallData ) )
  fit se.pred lwr upr
1 119    3.26 115 123
> 
> print( predict( fit2sls5s, se.fit = TRUE, interval = "prediction",
+    newdata = smallData ) )
  demand.pred demand.se.fit demand.lwr demand.upr supply.pred supply.se.fit
1         109          2.26        103        116         119          2.33
  supply.lwr supply.upr
1        112        126
> print( predict( fit2sls5s$eq[[ 1 ]], se.pred = TRUE, interval = "confidence",
+    newdata = smallData ) )
  fit se.pred lwr upr
1 109       3 105 114
> 
> print( predict( fit2slsd3, se.fit = TRUE, se.pred = TRUE,
+    interval = "prediction", level = 0.5, newdata = smallData ) )
  demand.pred demand.se.fit demand.se.pred demand.lwr demand.upr supply.pred
1         108          3.33           3.86        105        110         119
  supply.se.fit supply.se.pred supply.lwr supply.upr
1           3.2           4.07        116        122
> print( predict( fit2slsd3$eq[[ 1 ]], se.fit = TRUE, se.pred = TRUE,
+    interval = "confidence", level = 0.25, newdata = smallData ) )
  fit se.fit se.pred lwr upr
1 108   3.33    3.86 107 109
> 
> 
> ## ************ correlation of predicted values ***************
> print( correlation.systemfit( fit2sls1, 1, 2 ) )
      [,1]
 [1,]    0
 [2,]    0
 [3,]    0
 [4,]    0
 [5,]    0
 [6,]    0
 [7,]    0
 [8,]    0
 [9,]    0
[10,]    0
[11,]    0
[12,]    0
[13,]    0
[14,]    0
[15,]    0
[16,]    0
[17,]    0
[18,]    0
[19,]    0
[20,]    0
> 
> print( correlation.systemfit( fit2sls2s, 2, 1 ) )
           [,1]
 [1,]  0.413453
 [2,]  0.153759
 [3,]  0.152962
 [4,]  0.112671
 [5,] -0.071442
 [6,] -0.053943
 [7,] -0.050961
 [8,] -0.005442
 [9,] -0.000476
[10,] -0.001894
[11,]  0.047351
[12,]  0.064973
[13,]  0.024591
[14,] -0.028036
[15,]  0.175326
[16,]  0.254878
[17,]  0.104540
[18,]  0.065579
[19,]  0.147008
[20,]  0.124593
> 
> print( correlation.systemfit( fit2sls3, 1, 2 ) )
          [,1]
 [1,]  0.44877
 [2,]  0.16875
 [3,]  0.16850
 [4,]  0.12519
 [5,] -0.08079
 [6,] -0.06096
 [7,] -0.05780
 [8,] -0.00618
 [9,] -0.00054
[10,] -0.00214
[11,]  0.05454
[12,]  0.07607
[13,]  0.02868
[14,] -0.03197
[15,]  0.19899
[16,]  0.28551
[17,]  0.11838
[18,]  0.07184
[19,]  0.16271
[20,]  0.13995
> 
> print( correlation.systemfit( fit2sls4r, 2, 1 ) )
         [,1]
 [1,]  0.4078
 [2,]  0.2866
 [3,]  0.2528
 [4,]  0.2836
 [5,] -0.0300
 [6,] -0.0537
 [7,] -0.0627
 [8,]  0.1044
 [9,]  0.1003
[10,]  0.4530
[11,]  0.1293
[12,]  0.0184
[13,]  0.0449
[14,] -0.0409
[15,]  0.4229
[16,]  0.2649
[17,]  0.6554
[18,]  0.2693
[19,]  0.3831
[20,]  0.5784
> 
> print( correlation.systemfit( fit2sls5rs, 1, 2 ) )
          [,1]
 [1,]  0.38438
 [2,]  0.30697
 [3,]  0.26690
 [4,]  0.30163
 [5,] -0.02768
 [6,] -0.05086
 [7,] -0.05895
 [8,]  0.10102
 [9,]  0.10072
[10,]  0.45547
[11,]  0.10817
[12,]  0.00552
[13,]  0.04219
[14,] -0.04054
[15,]  0.42100
[16,]  0.24974
[17,]  0.65722
[18,]  0.24286
[19,]  0.34336
[20,]  0.54717
> 
> print( correlation.systemfit( fit2slsd1, 2, 1 ) )
      [,1]
 [1,]    0
 [2,]    0
 [3,]    0
 [4,]    0
 [5,]    0
 [6,]    0
 [7,]    0
 [8,]    0
 [9,]    0
[10,]    0
[11,]    0
[12,]    0
[13,]    0
[14,]    0
[15,]    0
[16,]    0
[17,]    0
[18,]    0
[19,]    0
[20,]    0
> 
> print( correlation.systemfit( fit2slsd2r, 1, 2 ) )
          [,1]
 [1,]  0.51320
 [2,]  0.27263
 [3,]  0.26221
 [4,]  0.21307
 [5,] -0.11973
 [6,] -0.08282
 [7,] -0.06158
 [8,] -0.00225
 [9,] -0.00103
[10,] -0.00892
[11,]  0.04576
[12,]  0.08710
[13,]  0.03423
[14,] -0.03425
[15,]  0.25625
[16,]  0.35070
[17,]  0.17505
[18,] -0.02443
[19,]  0.07277
[20,]  0.05142
> 
> 
> ## ************ Log-Likelihood values ***************
> print( logLik( fit2sls1 ) )
'log Lik.' -67.6 (df=8)
> print( logLik( fit2sls1, residCovDiag = TRUE ) )
'log Lik.' -84.4 (df=8)
> 
> print( logLik( fit2sls2s ) )
'log Lik.' -65.7 (df=7)
> print( logLik( fit2sls2s, residCovDiag = TRUE ) )
'log Lik.' -84.8 (df=7)
> 
> print( logLik( fit2sls3 ) )
'log Lik.' -65.7 (df=7)
> print( logLik( fit2sls3, residCovDiag = TRUE ) )
'log Lik.' -84.8 (df=7)
> 
> print( logLik( fit2sls4r ) )
'log Lik.' -66.2 (df=6)
> print( logLik( fit2sls4r, residCovDiag = TRUE ) )
'log Lik.' -84.8 (df=6)
> 
> print( logLik( fit2sls5rs ) )
'log Lik.' -66.2 (df=6)
> print( logLik( fit2sls5rs, residCovDiag = TRUE ) )
'log Lik.' -84.8 (df=6)
> 
> print( logLik( fit2slsd1 ) )
'log Lik.' -75.1 (df=8)
> print( logLik( fit2slsd1, residCovDiag = TRUE ) )
'log Lik.' -84.7 (df=8)
> 
> print( logLik( fit2slsd2r ) )
'log Lik.' -68.8 (df=7)
> print( logLik( fit2slsd2r, residCovDiag = TRUE ) )
'log Lik.' -84.6 (df=7)
> 
> 
> ## ************** F tests ****************
> # testing first restriction
> print( linearHypothesis( fit2sls1, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.06    0.8
> linearHypothesis( fit2sls1, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.06    0.8
> 
> print( linearHypothesis( fit2sls1s, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1s

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.07   0.79
> linearHypothesis( fit2sls1s, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1s

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.07   0.79
> 
> print( linearHypothesis( fit2sls1, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.06    0.8
> linearHypothesis( fit2sls1, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.06    0.8
> 
> print( linearHypothesis( fit2sls1r, restrm ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1r

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.08   0.78
> linearHypothesis( fit2sls1r, restrict )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1r

  Res.Df Df    F Pr(>F)
1     34               
2     33  1 0.08   0.78
> 
> # testing second restriction
> restrOnly2m <- matrix(0,1,7)
> restrOnly2q <- 0.5
> restrOnly2m[1,2] <- -1
> restrOnly2m[1,5] <-  1
> restrictOnly2 <- "- demand_price + supply_price = 0.5"
> # first restriction not imposed 
> print( linearHypothesis( fit2sls1, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df  F Pr(>F)
1     34             
2     33  1  0   0.96
> linearHypothesis( fit2sls1, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df  F Pr(>F)
1     34             
2     33  1  0   0.96
> 
> # first restriction imposed
> print( linearHypothesis( fit2sls2, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.92
> linearHypothesis( fit2sls2, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.92
> 
> print( linearHypothesis( fit2sls2r, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2r

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.91
> linearHypothesis( fit2sls2r, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2r

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.91
> 
> print( linearHypothesis( fit2sls3, restrOnly2m, restrOnly2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls3

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.91
> linearHypothesis( fit2sls3, restrictOnly2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls3

  Res.Df Df    F Pr(>F)
1     35               
2     34  1 0.01   0.91
> 
> # testing both of the restrictions
> print( linearHypothesis( fit2sls1, restr2m, restr2q ) )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.04   0.97
> linearHypothesis( fit2sls1, restrict2 )
Linear hypothesis test (Theil's F test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df    F Pr(>F)
1     35               
2     33  2 0.04   0.97
> 
> 
> ## ************** Wald tests ****************
> # testing first restriction
> print( linearHypothesis( fit2sls1, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> linearHypothesis( fit2sls1, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> 
> print( linearHypothesis( fit2sls1s, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1s

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.34       0.56
> linearHypothesis( fit2sls1s, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1s

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.34       0.56
> 
> print( linearHypothesis( fit2sls1, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> linearHypothesis( fit2sls1, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.31       0.58
> 
> print( linearHypothesis( fit2sls1r, restrm, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1r

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.38       0.54
> linearHypothesis( fit2sls1r, restrict, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0

Model 1: restricted model
Model 2: fit2sls1r

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.38       0.54
> 
> # testing second restriction
> # first restriction not imposed
> print( linearHypothesis( fit2sls1, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.01       0.91
> linearHypothesis( fit2sls1, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     34                    
2     33  1  0.01       0.91
> # first restriction imposed
> print( linearHypothesis( fit2sls2, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.06       0.81
> linearHypothesis( fit2sls2, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.06       0.81
> 
> print( linearHypothesis( fit2sls2r, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2r

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.07        0.8
> linearHypothesis( fit2sls2r, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls2r

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.07        0.8
> 
> print( linearHypothesis( fit2sls3, restrOnly2m, restrOnly2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls3

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.07        0.8
> linearHypothesis( fit2sls3, restrictOnly2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls3

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     34  1  0.07        0.8
> 
> # testing both of the restrictions
> print( linearHypothesis( fit2sls1, restr2m, restr2q, test = "Chisq" ) )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2  0.35       0.84
> linearHypothesis( fit2sls1, restrict2, test = "Chisq" )
Linear hypothesis test (Chi^2 statistic of a Wald test)

Hypothesis:
demand_income - supply_trend = 0
- demand_price  + supply_price = 0.5

Model 1: restricted model
Model 2: fit2sls1

  Res.Df Df Chisq Pr(>Chisq)
1     35                    
2     33  2  0.35       0.84
> 
> 
> ## **************** model frame ************************
> print( mf <- model.frame( fit2sls1 ) )
   consump price income farmPrice trend
1     98.5 100.3   87.4      98.0     1
2     99.2 104.3   97.6      99.1     2
3    102.2 103.4   96.7      99.1     3
4    101.5 104.5   98.2      98.1     4
5    104.2  98.0   99.8     110.8     5
6    103.2  99.5  100.5     108.2     6
7    104.0 101.1  103.2     105.6     7
8     99.9 104.8  107.8     109.8     8
9    100.3  96.4   96.6     108.7     9
10   102.8  91.2   88.9     100.6    10
11    95.4  93.1   75.1      81.0    11
12    92.4  98.8   76.9      68.6    12
13    94.5 102.9   84.6      70.9    13
14    98.8  98.8   90.6      81.4    14
15   105.8  95.1  103.1     102.3    15
16   100.2  98.5  105.1     105.0    16
17   103.5  86.5   96.4     110.5    17
18    99.9 104.0  104.4      92.5    18
19   105.2 105.8  110.7      89.3    19
20   106.2 113.5  127.1      93.0    20
> print( mf1 <- model.frame( fit2sls1$eq[[ 1 ]] ) )
   consump price income
1     98.5 100.3   87.4
2     99.2 104.3   97.6
3    102.2 103.4   96.7
4    101.5 104.5   98.2
5    104.2  98.0   99.8
6    103.2  99.5  100.5
7    104.0 101.1  103.2
8     99.9 104.8  107.8
9    100.3  96.4   96.6
10   102.8  91.2   88.9
11    95.4  93.1   75.1
12    92.4  98.8   76.9
13    94.5 102.9   84.6
14    98.8  98.8   90.6
15   105.8  95.1  103.1
16   100.2  98.5  105.1
17   103.5  86.5   96.4
18    99.9 104.0  104.4
19   105.2 105.8  110.7
20   106.2 113.5  127.1
> print( attributes( mf1 )$terms )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> print( mf2 <- model.frame( fit2sls1$eq[[ 2 ]] ) )
   consump price farmPrice trend
1     98.5 100.3      98.0     1
2     99.2 104.3      99.1     2
3    102.2 103.4      99.1     3
4    101.5 104.5      98.1     4
5    104.2  98.0     110.8     5
6    103.2  99.5     108.2     6
7    104.0 101.1     105.6     7
8     99.9 104.8     109.8     8
9    100.3  96.4     108.7     9
10   102.8  91.2     100.6    10
11    95.4  93.1      81.0    11
12    92.4  98.8      68.6    12
13    94.5 102.9      70.9    13
14    98.8  98.8      81.4    14
15   105.8  95.1     102.3    15
16   100.2  98.5     105.0    16
17   103.5  86.5     110.5    17
18    99.9 104.0      92.5    18
19   105.2 105.8      89.3    19
20   106.2 113.5      93.0    20
> print( attributes( mf2 )$terms )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> print( all.equal( mf, model.frame( fit2sls2s ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fit2sls2s$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fit2sls3 ) ) )
[1] TRUE
> print( all.equal( mf1, model.frame( fit2sls3$eq[[ 1 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fit2sls4r ) ) )
[1] TRUE
> print( all.equal( mf2, model.frame( fit2sls4r$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> print( all.equal( mf, model.frame( fit2sls5rs ) ) )
[1] TRUE
> print( all.equal( mf1, model.frame( fit2sls5rs$eq[[ 1 ]] ) ) )
[1] TRUE
> 
> fit2sls1$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fit2sls1$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> fit2sls2s$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fit2sls2s$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> fit2sls5rs$eq[[ 1 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> fit2sls5rs$eq[[ 2 ]]$modelInst
   income farmPrice trend
1    87.4      98.0     1
2    97.6      99.1     2
3    96.7      99.1     3
4    98.2      98.1     4
5    99.8     110.8     5
6   100.5     108.2     6
7   103.2     105.6     7
8   107.8     109.8     8
9    96.6     108.7     9
10   88.9     100.6    10
11   75.1      81.0    11
12   76.9      68.6    12
13   84.6      70.9    13
14   90.6      81.4    14
15  103.1     102.3    15
16  105.1     105.0    16
17   96.4     110.5    17
18  104.4      92.5    18
19  110.7      89.3    19
20  127.1      93.0    20
> 
> 
> ## **************** model matrix ************************
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fit2sls1$eq[[ 1 ]]$x ) )
[1] TRUE
> print( mm <- model.matrix( fit2sls1 ) )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1                   1        100.3          87.4                  0
demand_2                   1        104.3          97.6                  0
demand_3                   1        103.4          96.7                  0
demand_4                   1        104.5          98.2                  0
demand_5                   1         98.0          99.8                  0
demand_6                   1         99.5         100.5                  0
demand_7                   1        101.1         103.2                  0
demand_8                   1        104.8         107.8                  0
demand_9                   1         96.4          96.6                  0
demand_10                  1         91.2          88.9                  0
demand_11                  1         93.1          75.1                  0
demand_12                  1         98.8          76.9                  0
demand_13                  1        102.9          84.6                  0
demand_14                  1         98.8          90.6                  0
demand_15                  1         95.1         103.1                  0
demand_16                  1         98.5         105.1                  0
demand_17                  1         86.5          96.4                  0
demand_18                  1        104.0         104.4                  0
demand_19                  1        105.8         110.7                  0
demand_20                  1        113.5         127.1                  0
supply_1                   0          0.0           0.0                  1
supply_2                   0          0.0           0.0                  1
supply_3                   0          0.0           0.0                  1
supply_4                   0          0.0           0.0                  1
supply_5                   0          0.0           0.0                  1
supply_6                   0          0.0           0.0                  1
supply_7                   0          0.0           0.0                  1
supply_8                   0          0.0           0.0                  1
supply_9                   0          0.0           0.0                  1
supply_10                  0          0.0           0.0                  1
supply_11                  0          0.0           0.0                  1
supply_12                  0          0.0           0.0                  1
supply_13                  0          0.0           0.0                  1
supply_14                  0          0.0           0.0                  1
supply_15                  0          0.0           0.0                  1
supply_16                  0          0.0           0.0                  1
supply_17                  0          0.0           0.0                  1
supply_18                  0          0.0           0.0                  1
supply_19                  0          0.0           0.0                  1
supply_20                  0          0.0           0.0                  1
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0            0
demand_2           0.0              0.0            0
demand_3           0.0              0.0            0
demand_4           0.0              0.0            0
demand_5           0.0              0.0            0
demand_6           0.0              0.0            0
demand_7           0.0              0.0            0
demand_8           0.0              0.0            0
demand_9           0.0              0.0            0
demand_10          0.0              0.0            0
demand_11          0.0              0.0            0
demand_12          0.0              0.0            0
demand_13          0.0              0.0            0
demand_14          0.0              0.0            0
demand_15          0.0              0.0            0
demand_16          0.0              0.0            0
demand_17          0.0              0.0            0
demand_18          0.0              0.0            0
demand_19          0.0              0.0            0
demand_20          0.0              0.0            0
supply_1         100.3             98.0            1
supply_2         104.3             99.1            2
supply_3         103.4             99.1            3
supply_4         104.5             98.1            4
supply_5          98.0            110.8            5
supply_6          99.5            108.2            6
supply_7         101.1            105.6            7
supply_8         104.8            109.8            8
supply_9          96.4            108.7            9
supply_10         91.2            100.6           10
supply_11         93.1             81.0           11
supply_12         98.8             68.6           12
supply_13        102.9             70.9           13
supply_14         98.8             81.4           14
supply_15         95.1            102.3           15
supply_16         98.5            105.0           16
supply_17         86.5            110.5           17
supply_18        104.0             92.5           18
supply_19        105.8             89.3           19
supply_20        113.5             93.0           20
> print( mm1 <- model.matrix( fit2sls1$eq[[ 1 ]] ) )
   (Intercept) price income
1            1 100.3   87.4
2            1 104.3   97.6
3            1 103.4   96.7
4            1 104.5   98.2
5            1  98.0   99.8
6            1  99.5  100.5
7            1 101.1  103.2
8            1 104.8  107.8
9            1  96.4   96.6
10           1  91.2   88.9
11           1  93.1   75.1
12           1  98.8   76.9
13           1 102.9   84.6
14           1  98.8   90.6
15           1  95.1  103.1
16           1  98.5  105.1
17           1  86.5   96.4
18           1 104.0  104.4
19           1 105.8  110.7
20           1 113.5  127.1
attr(,"assign")
[1] 0 1 2
> print( mm2 <- model.matrix( fit2sls1$eq[[ 2 ]] ) )
   (Intercept) price farmPrice trend
1            1 100.3      98.0     1
2            1 104.3      99.1     2
3            1 103.4      99.1     3
4            1 104.5      98.1     4
5            1  98.0     110.8     5
6            1  99.5     108.2     6
7            1 101.1     105.6     7
8            1 104.8     109.8     8
9            1  96.4     108.7     9
10           1  91.2     100.6    10
11           1  93.1      81.0    11
12           1  98.8      68.6    12
13           1 102.9      70.9    13
14           1  98.8      81.4    14
15           1  95.1     102.3    15
16           1  98.5     105.0    16
17           1  86.5     110.5    17
18           1 104.0      92.5    18
19           1 105.8      89.3    19
20           1 113.5      93.0    20
attr(,"assign")
[1] 0 1 2 3
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fit2sls1s ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls1s$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls1s$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fit2sls1s$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fit2sls2s$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fit2sls2s ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls2s$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls2s$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fit2sls2Sym ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls2Sym$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls2Sym$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fit2sls2Sym$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fit2sls3 ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls3$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls3$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fit2sls3$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fit2sls4r$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fit2sls4r ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls4r$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls4r$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fit2sls4s ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls4s$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls4s$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fit2sls4s$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # with x (returnModelMatrix) = TRUE
> print( !is.null( fit2sls5rs$eq[[ 1 ]]$x ) )
[1] TRUE
> print( all.equal( mm, model.matrix( fit2sls5rs ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls5rs$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls5rs$eq[[ 2 ]] ) ) )
[1] TRUE
> 
> # with x (returnModelMatrix) = FALSE
> print( all.equal( mm, model.matrix( fit2sls5r ) ) )
[1] TRUE
> print( all.equal( mm1, model.matrix( fit2sls5r$eq[[ 1 ]] ) ) )
[1] TRUE
> print( all.equal( mm2, model.matrix( fit2sls5r$eq[[ 2 ]] ) ) )
[1] TRUE
> print( !is.null( fit2sls5r$eq[[ 1 ]]$x ) )
[1] FALSE
> 
> # matrices of instrumental variables
> model.matrix( fit2sls1, which = "z" )
          demand_(Intercept) demand_income demand_farmPrice demand_trend
demand_1                   1          87.4             98.0            1
demand_2                   1          97.6             99.1            2
demand_3                   1          96.7             99.1            3
demand_4                   1          98.2             98.1            4
demand_5                   1          99.8            110.8            5
demand_6                   1         100.5            108.2            6
demand_7                   1         103.2            105.6            7
demand_8                   1         107.8            109.8            8
demand_9                   1          96.6            108.7            9
demand_10                  1          88.9            100.6           10
demand_11                  1          75.1             81.0           11
demand_12                  1          76.9             68.6           12
demand_13                  1          84.6             70.9           13
demand_14                  1          90.6             81.4           14
demand_15                  1         103.1            102.3           15
demand_16                  1         105.1            105.0           16
demand_17                  1          96.4            110.5           17
demand_18                  1         104.4             92.5           18
demand_19                  1         110.7             89.3           19
demand_20                  1         127.1             93.0           20
supply_1                   0           0.0              0.0            0
supply_2                   0           0.0              0.0            0
supply_3                   0           0.0              0.0            0
supply_4                   0           0.0              0.0            0
supply_5                   0           0.0              0.0            0
supply_6                   0           0.0              0.0            0
supply_7                   0           0.0              0.0            0
supply_8                   0           0.0              0.0            0
supply_9                   0           0.0              0.0            0
supply_10                  0           0.0              0.0            0
supply_11                  0           0.0              0.0            0
supply_12                  0           0.0              0.0            0
supply_13                  0           0.0              0.0            0
supply_14                  0           0.0              0.0            0
supply_15                  0           0.0              0.0            0
supply_16                  0           0.0              0.0            0
supply_17                  0           0.0              0.0            0
supply_18                  0           0.0              0.0            0
supply_19                  0           0.0              0.0            0
supply_20                  0           0.0              0.0            0
          supply_(Intercept) supply_income supply_farmPrice supply_trend
demand_1                   0           0.0              0.0            0
demand_2                   0           0.0              0.0            0
demand_3                   0           0.0              0.0            0
demand_4                   0           0.0              0.0            0
demand_5                   0           0.0              0.0            0
demand_6                   0           0.0              0.0            0
demand_7                   0           0.0              0.0            0
demand_8                   0           0.0              0.0            0
demand_9                   0           0.0              0.0            0
demand_10                  0           0.0              0.0            0
demand_11                  0           0.0              0.0            0
demand_12                  0           0.0              0.0            0
demand_13                  0           0.0              0.0            0
demand_14                  0           0.0              0.0            0
demand_15                  0           0.0              0.0            0
demand_16                  0           0.0              0.0            0
demand_17                  0           0.0              0.0            0
demand_18                  0           0.0              0.0            0
demand_19                  0           0.0              0.0            0
demand_20                  0           0.0              0.0            0
supply_1                   1          87.4             98.0            1
supply_2                   1          97.6             99.1            2
supply_3                   1          96.7             99.1            3
supply_4                   1          98.2             98.1            4
supply_5                   1          99.8            110.8            5
supply_6                   1         100.5            108.2            6
supply_7                   1         103.2            105.6            7
supply_8                   1         107.8            109.8            8
supply_9                   1          96.6            108.7            9
supply_10                  1          88.9            100.6           10
supply_11                  1          75.1             81.0           11
supply_12                  1          76.9             68.6           12
supply_13                  1          84.6             70.9           13
supply_14                  1          90.6             81.4           14
supply_15                  1         103.1            102.3           15
supply_16                  1         105.1            105.0           16
supply_17                  1          96.4            110.5           17
supply_18                  1         104.4             92.5           18
supply_19                  1         110.7             89.3           19
supply_20                  1         127.1             93.0           20
> model.matrix( fit2sls1$eq[[ 1 ]], which = "z" )
   (Intercept) income farmPrice trend
1            1   87.4      98.0     1
2            1   97.6      99.1     2
3            1   96.7      99.1     3
4            1   98.2      98.1     4
5            1   99.8     110.8     5
6            1  100.5     108.2     6
7            1  103.2     105.6     7
8            1  107.8     109.8     8
9            1   96.6     108.7     9
10           1   88.9     100.6    10
11           1   75.1      81.0    11
12           1   76.9      68.6    12
13           1   84.6      70.9    13
14           1   90.6      81.4    14
15           1  103.1     102.3    15
16           1  105.1     105.0    16
17           1   96.4     110.5    17
18           1  104.4      92.5    18
19           1  110.7      89.3    19
20           1  127.1      93.0    20
attr(,"assign")
[1] 0 1 2 3
> model.matrix( fit2sls1$eq[[ 2 ]], which = "z" )
   (Intercept) income farmPrice trend
1            1   87.4      98.0     1
2            1   97.6      99.1     2
3            1   96.7      99.1     3
4            1   98.2      98.1     4
5            1   99.8     110.8     5
6            1  100.5     108.2     6
7            1  103.2     105.6     7
8            1  107.8     109.8     8
9            1   96.6     108.7     9
10           1   88.9     100.6    10
11           1   75.1      81.0    11
12           1   76.9      68.6    12
13           1   84.6      70.9    13
14           1   90.6      81.4    14
15           1  103.1     102.3    15
16           1  105.1     105.0    16
17           1   96.4     110.5    17
18           1  104.4      92.5    18
19           1  110.7      89.3    19
20           1  127.1      93.0    20
attr(,"assign")
[1] 0 1 2 3
> 
> # matrices of fitted regressors
> model.matrix( fit2sls5r, which = "xHat" )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1                   1         99.6          87.4                  0
demand_2                   1        105.1          97.6                  0
demand_3                   1        103.8          96.7                  0
demand_4                   1        104.5          98.2                  0
demand_5                   1         98.7          99.8                  0
demand_6                   1         99.6         100.5                  0
demand_7                   1        102.0         103.2                  0
demand_8                   1        102.2         107.8                  0
demand_9                   1         94.6          96.6                  0
demand_10                  1         92.7          88.9                  0
demand_11                  1         92.4          75.1                  0
demand_12                  1         98.9          76.9                  0
demand_13                  1        102.2          84.6                  0
demand_14                  1        100.3          90.6                  0
demand_15                  1         97.6         103.1                  0
demand_16                  1         96.9         105.1                  0
demand_17                  1         87.7          96.4                  0
demand_18                  1        101.1         104.4                  0
demand_19                  1        106.1         110.7                  0
demand_20                  1        114.4         127.1                  0
supply_1                   0          0.0           0.0                  1
supply_2                   0          0.0           0.0                  1
supply_3                   0          0.0           0.0                  1
supply_4                   0          0.0           0.0                  1
supply_5                   0          0.0           0.0                  1
supply_6                   0          0.0           0.0                  1
supply_7                   0          0.0           0.0                  1
supply_8                   0          0.0           0.0                  1
supply_9                   0          0.0           0.0                  1
supply_10                  0          0.0           0.0                  1
supply_11                  0          0.0           0.0                  1
supply_12                  0          0.0           0.0                  1
supply_13                  0          0.0           0.0                  1
supply_14                  0          0.0           0.0                  1
supply_15                  0          0.0           0.0                  1
supply_16                  0          0.0           0.0                  1
supply_17                  0          0.0           0.0                  1
supply_18                  0          0.0           0.0                  1
supply_19                  0          0.0           0.0                  1
supply_20                  0          0.0           0.0                  1
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0            0
demand_2           0.0              0.0            0
demand_3           0.0              0.0            0
demand_4           0.0              0.0            0
demand_5           0.0              0.0            0
demand_6           0.0              0.0            0
demand_7           0.0              0.0            0
demand_8           0.0              0.0            0
demand_9           0.0              0.0            0
demand_10          0.0              0.0            0
demand_11          0.0              0.0            0
demand_12          0.0              0.0            0
demand_13          0.0              0.0            0
demand_14          0.0              0.0            0
demand_15          0.0              0.0            0
demand_16          0.0              0.0            0
demand_17          0.0              0.0            0
demand_18          0.0              0.0            0
demand_19          0.0              0.0            0
demand_20          0.0              0.0            0
supply_1          99.6             98.0            1
supply_2         105.1             99.1            2
supply_3         103.8             99.1            3
supply_4         104.5             98.1            4
supply_5          98.7            110.8            5
supply_6          99.6            108.2            6
supply_7         102.0            105.6            7
supply_8         102.2            109.8            8
supply_9          94.6            108.7            9
supply_10         92.7            100.6           10
supply_11         92.4             81.0           11
supply_12         98.9             68.6           12
supply_13        102.2             70.9           13
supply_14        100.3             81.4           14
supply_15         97.6            102.3           15
supply_16         96.9            105.0           16
supply_17         87.7            110.5           17
supply_18        101.1             92.5           18
supply_19        106.1             89.3           19
supply_20        114.4             93.0           20
> model.matrix( fit2sls5r$eq[[ 1 ]], which = "xHat" )
   (Intercept) price income
1            1  99.6   87.4
2            1 105.1   97.6
3            1 103.8   96.7
4            1 104.5   98.2
5            1  98.7   99.8
6            1  99.6  100.5
7            1 102.0  103.2
8            1 102.2  107.8
9            1  94.6   96.6
10           1  92.7   88.9
11           1  92.4   75.1
12           1  98.9   76.9
13           1 102.2   84.6
14           1 100.3   90.6
15           1  97.6  103.1
16           1  96.9  105.1
17           1  87.7   96.4
18           1 101.1  104.4
19           1 106.1  110.7
20           1 114.4  127.1
> model.matrix( fit2sls5r$eq[[ 2 ]], which = "xHat" )
   (Intercept) price farmPrice trend
1            1  99.6      98.0     1
2            1 105.1      99.1     2
3            1 103.8      99.1     3
4            1 104.5      98.1     4
5            1  98.7     110.8     5
6            1  99.6     108.2     6
7            1 102.0     105.6     7
8            1 102.2     109.8     8
9            1  94.6     108.7     9
10           1  92.7     100.6    10
11           1  92.4      81.0    11
12           1  98.9      68.6    12
13           1 102.2      70.9    13
14           1 100.3      81.4    14
15           1  97.6     102.3    15
16           1  96.9     105.0    16
17           1  87.7     110.5    17
18           1 101.1      92.5    18
19           1 106.1      89.3    19
20           1 114.4      93.0    20
> 
> 
> ## **************** formulas ************************
> formula( fit2sls1 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2sls1$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fit2sls2s )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2sls2s$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fit2sls3 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2sls3$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fit2sls4r )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2sls4r$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fit2sls5rs )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2sls5rs$eq[[ 1 ]] )
consump ~ price + income
> 
> formula( fit2slsd1 )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2slsd1$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
> 
> formula( fit2slsd2r )
$demand
consump ~ price + income

$supply
consump ~ price + farmPrice + trend

> formula( fit2slsd2r$eq[[ 1 ]] )
consump ~ price + income
> 
> 
> ## **************** model terms *******************
> terms( fit2sls1 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2sls1$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fit2sls2s )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2sls2s$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fit2sls3 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2sls3$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fit2sls4r )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2sls4r$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fit2sls5rs )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2sls5rs$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> terms( fit2slsd1 )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2slsd1$eq[[ 2 ]] )
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 
> 
> terms( fit2slsd2r )
$demand
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 

$supply
consump ~ price + farmPrice + trend
attr(,"variables")
list(consump, price, farmPrice, trend)
attr(,"factors")
          price farmPrice trend
consump       0         0     0
price         1         0     0
farmPrice     0         1     0
trend         0         0     1
attr(,"term.labels")
[1] "price"     "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, farmPrice, trend)
attr(,"dataClasses")
  consump     price farmPrice     trend 
"numeric" "numeric" "numeric" "numeric" 

> terms( fit2slsd2r$eq[[ 1 ]] )
consump ~ price + income
attr(,"variables")
list(consump, price, income)
attr(,"factors")
        price income
consump     0      0
price       1      0
income      0      1
attr(,"term.labels")
[1] "price"  "income"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(consump, price, income)
attr(,"dataClasses")
  consump     price    income 
"numeric" "numeric" "numeric" 
> 
> 
> ## **************** terms of instruments *******************
> fit2sls1$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2sls2s$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2sls3$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2sls4r$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2sls5rs$eq[[ 1 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2slsd1$eq[[ 2 ]]$termsInst
~income + farmPrice + trend
attr(,"variables")
list(income, farmPrice, trend)
attr(,"factors")
          income farmPrice trend
income         1         0     0
farmPrice      0         1     0
trend          0         0     1
attr(,"term.labels")
[1] "income"    "farmPrice" "trend"    
attr(,"order")
[1] 1 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice, trend)
attr(,"dataClasses")
   income farmPrice     trend 
"numeric" "numeric" "numeric" 
> 
> fit2slsd2r$eq[[ 1 ]]$termsInst
~income + farmPrice
attr(,"variables")
list(income, farmPrice)
attr(,"factors")
          income farmPrice
income         1         0
farmPrice      0         1
attr(,"term.labels")
[1] "income"    "farmPrice"
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 0
attr(,".Environment")
<environment: R_GlobalEnv>
attr(,"predvars")
list(income, farmPrice)
attr(,"dataClasses")
   income farmPrice 
"numeric" "numeric" 
> 
> 
> ## **************** estfun ************************
> library( "sandwich" )
> 
> estfun( fit2sls1 )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1              0.6738        67.13         58.89              0.000
demand_2             -0.4897       -51.48        -47.80              0.000
demand_3              2.4440       253.65        236.33              0.000
demand_4              1.4958       156.35        146.88              0.000
demand_5              2.2975       226.65        229.29              0.000
demand_6              1.3235       131.89        133.02              0.000
demand_7              1.7917       182.70        184.90              0.000
demand_8             -3.6818      -376.41       -396.90              0.000
demand_9             -1.5729      -148.80       -151.94              0.000
demand_10             2.8552       264.73        253.83              0.000
demand_11            -0.2736       -25.29        -20.55              0.000
demand_12            -2.2634      -223.89       -174.06              0.000
demand_13            -1.7795      -181.80       -150.55              0.000
demand_14             0.0991         9.93          8.98              0.000
demand_15             2.5674       250.64        264.70              0.000
demand_16            -3.8102      -369.18       -400.45              0.000
demand_17            -0.0206        -1.81         -1.99              0.000
demand_18            -2.8715      -290.19       -299.78              0.000
demand_19             1.6632       176.41        184.12              0.000
demand_20            -0.4478       -51.23        -56.92              0.000
supply_1              0.0000         0.00          0.00             -0.268
supply_2              0.0000         0.00          0.00             -1.418
supply_3              0.0000         0.00          0.00              1.625
supply_4              0.0000         0.00          0.00              0.790
supply_5              0.0000         0.00          0.00              1.438
supply_6              0.0000         0.00          0.00              0.613
supply_7              0.0000         0.00          0.00              1.217
supply_8              0.0000         0.00          0.00             -4.265
supply_9              0.0000         0.00          0.00             -1.956
supply_10             0.0000         0.00          0.00              2.785
supply_11             0.0000         0.00          0.00              0.233
supply_12             0.0000         0.00          0.00             -1.426
supply_13             0.0000         0.00          0.00             -0.935
supply_14             0.0000         0.00          0.00              0.803
supply_15             0.0000         0.00          0.00              2.886
supply_16             0.0000         0.00          0.00             -3.454
supply_17             0.0000         0.00          0.00              0.391
supply_18             0.0000         0.00          0.00             -2.061
supply_19             0.0000         0.00          0.00              2.596
supply_20             0.0000         0.00          0.00              0.406
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0        0.000
demand_2           0.0              0.0        0.000
demand_3           0.0              0.0        0.000
demand_4           0.0              0.0        0.000
demand_5           0.0              0.0        0.000
demand_6           0.0              0.0        0.000
demand_7           0.0              0.0        0.000
demand_8           0.0              0.0        0.000
demand_9           0.0              0.0        0.000
demand_10          0.0              0.0        0.000
demand_11          0.0              0.0        0.000
demand_12          0.0              0.0        0.000
demand_13          0.0              0.0        0.000
demand_14          0.0              0.0        0.000
demand_15          0.0              0.0        0.000
demand_16          0.0              0.0        0.000
demand_17          0.0              0.0        0.000
demand_18          0.0              0.0        0.000
demand_19          0.0              0.0        0.000
demand_20          0.0              0.0        0.000
supply_1         -26.7            -26.3       -0.268
supply_2        -149.1           -140.5       -2.836
supply_3         168.7            161.1        4.876
supply_4          82.6             77.5        3.159
supply_5         141.9            159.3        7.190
supply_6          61.1             66.4        3.680
supply_7         124.1            128.5        8.520
supply_8        -436.1           -468.3      -34.122
supply_9        -185.0           -212.6      -17.602
supply_10        258.2            280.1       27.848
supply_11         21.5             18.8        2.558
supply_12       -141.0            -97.8      -17.107
supply_13        -95.5            -66.3      -12.152
supply_14         80.6             65.4       11.246
supply_15        281.7            295.2       43.286
supply_16       -334.7           -362.7      -55.267
supply_17         34.3             43.2        6.650
supply_18       -208.3           -190.7      -37.106
supply_19        275.4            231.8       49.327
supply_20         46.5             37.8        8.122
> round( colSums( estfun( fit2sls1 ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> estfun( fit2sls1s )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1              0.6738        67.13         58.89              0.000
demand_2             -0.4897       -51.48        -47.80              0.000
demand_3              2.4440       253.65        236.33              0.000
demand_4              1.4958       156.35        146.88              0.000
demand_5              2.2975       226.65        229.29              0.000
demand_6              1.3235       131.89        133.02              0.000
demand_7              1.7917       182.70        184.90              0.000
demand_8             -3.6818      -376.41       -396.90              0.000
demand_9             -1.5729      -148.80       -151.94              0.000
demand_10             2.8552       264.73        253.83              0.000
demand_11            -0.2736       -25.29        -20.55              0.000
demand_12            -2.2634      -223.89       -174.06              0.000
demand_13            -1.7795      -181.80       -150.55              0.000
demand_14             0.0991         9.93          8.98              0.000
demand_15             2.5674       250.64        264.70              0.000
demand_16            -3.8102      -369.18       -400.45              0.000
demand_17            -0.0206        -1.81         -1.99              0.000
demand_18            -2.8715      -290.19       -299.78              0.000
demand_19             1.6632       176.41        184.12              0.000
demand_20            -0.4478       -51.23        -56.92              0.000
supply_1              0.0000         0.00          0.00             -0.268
supply_2              0.0000         0.00          0.00             -1.418
supply_3              0.0000         0.00          0.00              1.625
supply_4              0.0000         0.00          0.00              0.790
supply_5              0.0000         0.00          0.00              1.438
supply_6              0.0000         0.00          0.00              0.613
supply_7              0.0000         0.00          0.00              1.217
supply_8              0.0000         0.00          0.00             -4.265
supply_9              0.0000         0.00          0.00             -1.956
supply_10             0.0000         0.00          0.00              2.785
supply_11             0.0000         0.00          0.00              0.233
supply_12             0.0000         0.00          0.00             -1.426
supply_13             0.0000         0.00          0.00             -0.935
supply_14             0.0000         0.00          0.00              0.803
supply_15             0.0000         0.00          0.00              2.886
supply_16             0.0000         0.00          0.00             -3.454
supply_17             0.0000         0.00          0.00              0.391
supply_18             0.0000         0.00          0.00             -2.061
supply_19             0.0000         0.00          0.00              2.596
supply_20             0.0000         0.00          0.00              0.406
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0        0.000
demand_2           0.0              0.0        0.000
demand_3           0.0              0.0        0.000
demand_4           0.0              0.0        0.000
demand_5           0.0              0.0        0.000
demand_6           0.0              0.0        0.000
demand_7           0.0              0.0        0.000
demand_8           0.0              0.0        0.000
demand_9           0.0              0.0        0.000
demand_10          0.0              0.0        0.000
demand_11          0.0              0.0        0.000
demand_12          0.0              0.0        0.000
demand_13          0.0              0.0        0.000
demand_14          0.0              0.0        0.000
demand_15          0.0              0.0        0.000
demand_16          0.0              0.0        0.000
demand_17          0.0              0.0        0.000
demand_18          0.0              0.0        0.000
demand_19          0.0              0.0        0.000
demand_20          0.0              0.0        0.000
supply_1         -26.7            -26.3       -0.268
supply_2        -149.1           -140.5       -2.836
supply_3         168.7            161.1        4.876
supply_4          82.6             77.5        3.159
supply_5         141.9            159.3        7.190
supply_6          61.1             66.4        3.680
supply_7         124.1            128.5        8.520
supply_8        -436.1           -468.3      -34.122
supply_9        -185.0           -212.6      -17.602
supply_10        258.2            280.1       27.848
supply_11         21.5             18.8        2.558
supply_12       -141.0            -97.8      -17.107
supply_13        -95.5            -66.3      -12.152
supply_14         80.6             65.4       11.246
supply_15        281.7            295.2       43.286
supply_16       -334.7           -362.7      -55.267
supply_17         34.3             43.2        6.650
supply_18       -208.3           -190.7      -37.106
supply_19        275.4            231.8       49.327
supply_20         46.5             37.8        8.122
> round( colSums( estfun( fit2sls1s ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> estfun( fit2sls1r )
          demand_(Intercept) demand_price demand_income supply_(Intercept)
demand_1              0.6738        67.13         58.89              0.000
demand_2             -0.4897       -51.48        -47.80              0.000
demand_3              2.4440       253.65        236.33              0.000
demand_4              1.4958       156.35        146.88              0.000
demand_5              2.2975       226.65        229.29              0.000
demand_6              1.3235       131.89        133.02              0.000
demand_7              1.7917       182.70        184.90              0.000
demand_8             -3.6818      -376.41       -396.90              0.000
demand_9             -1.5729      -148.80       -151.94              0.000
demand_10             2.8552       264.73        253.83              0.000
demand_11            -0.2736       -25.29        -20.55              0.000
demand_12            -2.2634      -223.89       -174.06              0.000
demand_13            -1.7795      -181.80       -150.55              0.000
demand_14             0.0991         9.93          8.98              0.000
demand_15             2.5674       250.64        264.70              0.000
demand_16            -3.8102      -369.18       -400.45              0.000
demand_17            -0.0206        -1.81         -1.99              0.000
demand_18            -2.8715      -290.19       -299.78              0.000
demand_19             1.6632       176.41        184.12              0.000
demand_20            -0.4478       -51.23        -56.92              0.000
supply_1              0.0000         0.00          0.00             -0.268
supply_2              0.0000         0.00          0.00             -1.418
supply_3              0.0000         0.00          0.00              1.625
supply_4              0.0000         0.00          0.00              0.790
supply_5              0.0000         0.00          0.00              1.438
supply_6              0.0000         0.00          0.00              0.613
supply_7              0.0000         0.00          0.00              1.217
supply_8              0.0000         0.00          0.00             -4.265
supply_9              0.0000         0.00          0.00             -1.956
supply_10             0.0000         0.00          0.00              2.785
supply_11             0.0000         0.00          0.00              0.233
supply_12             0.0000         0.00          0.00             -1.426
supply_13             0.0000         0.00          0.00             -0.935
supply_14             0.0000         0.00          0.00              0.803
supply_15             0.0000         0.00          0.00              2.886
supply_16             0.0000         0.00          0.00             -3.454
supply_17             0.0000         0.00          0.00              0.391
supply_18             0.0000         0.00          0.00             -2.061
supply_19             0.0000         0.00          0.00              2.596
supply_20             0.0000         0.00          0.00              0.406
          supply_price supply_farmPrice supply_trend
demand_1           0.0              0.0        0.000
demand_2           0.0              0.0        0.000
demand_3           0.0              0.0        0.000
demand_4           0.0              0.0        0.000
demand_5           0.0              0.0        0.000
demand_6           0.0              0.0        0.000
demand_7           0.0              0.0        0.000
demand_8           0.0              0.0        0.000
demand_9           0.0              0.0        0.000
demand_10          0.0              0.0        0.000
demand_11          0.0              0.0        0.000
demand_12          0.0              0.0        0.000
demand_13          0.0              0.0        0.000
demand_14          0.0              0.0        0.000
demand_15          0.0              0.0        0.000
demand_16          0.0              0.0        0.000
demand_17          0.0              0.0        0.000
demand_18          0.0              0.0        0.000
demand_19          0.0              0.0        0.000
demand_20          0.0              0.0        0.000
supply_1         -26.7            -26.3       -0.268
supply_2        -149.1           -140.5       -2.836
supply_3         168.7            161.1        4.876
supply_4          82.6             77.5        3.159
supply_5         141.9            159.3        7.190
supply_6          61.1             66.4        3.680
supply_7         124.1            128.5        8.520
supply_8        -436.1           -468.3      -34.122
supply_9        -185.0           -212.6      -17.602
supply_10        258.2            280.1       27.848
supply_11         21.5             18.8        2.558
supply_12       -141.0            -97.8      -17.107
supply_13        -95.5            -66.3      -12.152
supply_14         80.6             65.4       11.246
supply_15        281.7            295.2       43.286
supply_16       -334.7           -362.7      -55.267
supply_17         34.3             43.2        6.650
supply_18       -208.3           -190.7      -37.106
supply_19        275.4            231.8       49.327
supply_20         46.5             37.8        8.122
> round( colSums( estfun( fit2sls1r ) ), digits = 7 )
demand_(Intercept)       demand_price      demand_income supply_(Intercept) 
                 0                  0                  0                  0 
      supply_price   supply_farmPrice       supply_trend 
                 0                  0                  0 
> 
> 
> ## **************** bread ************************
> bread( fit2sls1 )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)             649.07      -6.9669        0.5100
demand_price                    -6.97       0.0963       -0.0273
demand_income                    0.51      -0.0273        0.0228
supply_(Intercept)               0.00       0.0000        0.0000
supply_price                     0.00       0.0000        0.0000
supply_farmPrice                 0.00       0.0000        0.0000
supply_trend                     0.00       0.0000        0.0000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)               0.00      0.00000          0.00000
demand_price                     0.00      0.00000          0.00000
demand_income                    0.00      0.00000          0.00000
supply_(Intercept)             955.38     -7.25488         -2.14464
supply_price                    -7.25      0.06614          0.00620
supply_farmPrice                -2.14      0.00620          0.01479
supply_trend                    -1.96      0.00384          0.00912
                   supply_trend
demand_(Intercept)      0.00000
demand_price            0.00000
demand_income           0.00000
supply_(Intercept)     -1.95529
supply_price            0.00384
supply_farmPrice        0.00912
supply_trend            0.06577
> 
> bread( fit2sls1s )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)             649.07      -6.9669        0.5100
demand_price                    -6.97       0.0963       -0.0273
demand_income                    0.51      -0.0273        0.0228
supply_(Intercept)               0.00       0.0000        0.0000
supply_price                     0.00       0.0000        0.0000
supply_farmPrice                 0.00       0.0000        0.0000
supply_trend                     0.00       0.0000        0.0000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)               0.00      0.00000          0.00000
demand_price                     0.00      0.00000          0.00000
demand_income                    0.00      0.00000          0.00000
supply_(Intercept)             955.38     -7.25488         -2.14464
supply_price                    -7.25      0.06614          0.00620
supply_farmPrice                -2.14      0.00620          0.01479
supply_trend                    -1.96      0.00384          0.00912
                   supply_trend
demand_(Intercept)      0.00000
demand_price            0.00000
demand_income           0.00000
supply_(Intercept)     -1.95529
supply_price            0.00384
supply_farmPrice        0.00912
supply_trend            0.06577
> 
> bread( fit2sls1r )
                   demand_(Intercept) demand_price demand_income
demand_(Intercept)             649.07      -6.9669        0.5100
demand_price                    -6.97       0.0963       -0.0273
demand_income                    0.51      -0.0273        0.0228
supply_(Intercept)               0.00       0.0000        0.0000
supply_price                     0.00       0.0000        0.0000
supply_farmPrice                 0.00       0.0000        0.0000
supply_trend                     0.00       0.0000        0.0000
                   supply_(Intercept) supply_price supply_farmPrice
demand_(Intercept)               0.00      0.00000          0.00000
demand_price                     0.00      0.00000          0.00000
demand_income                    0.00      0.00000          0.00000
supply_(Intercept)             955.38     -7.25488         -2.14464
supply_price                    -7.25      0.06614          0.00620
supply_farmPrice                -2.14      0.00620          0.01479
supply_trend                    -1.96      0.00384          0.00912
                   supply_trend
demand_(Intercept)      0.00000
demand_price            0.00000
demand_income           0.00000
supply_(Intercept)     -1.95529
supply_price            0.00384
supply_farmPrice        0.00912
supply_trend            0.06577
> 
> proc.time()
   user  system elapsed 
    2.8     0.1     2.9 
