
%       $Id$    


\documentclass[article]{jss}
\usepackage{csquotes}
\MakeOuterQuote{°}

\author{Arne Henningsen\\University of Kiel\And
        Jeff D. Hamann\\ Forest Informatics, Inc. }
        
\title{systemfit: A Package to Estimate\\
       Simultaneous Equation Systems in \proglang{R}}

%% for pretty printing and a nice hypersummary also set:
\Plainauthor{Arne Henningsen, Jeff D. Hamann} %% comma-separated
\Plaintitle{systemfit: A Package to Estimate Simultaneous Equation Systems 
            in R} %% without formatting
\Shorttitle{systemfit} %% a short title (if necessary)

%% an abstract and keywords
\Abstract{Many statistical analysis are based on models that consist
  of  more than one equation. If these models contain relationships
  among the various equations, ignoring these relationships can result
  in biased and possibly inconsistent parameter estimates. If
  relationships exist among the equations, the sets of equations
  should be fitted simultaneously rather than equation by equation.
  The package \pkg{systemfit} provides the capability to estimate
  systems of linear and non-linear equations, using limited and
  full-information methods within the \proglang{R} programming
  environment.  }
  
\Keywords{R, simultaneous equation system, seemingly unrelated
  regression, two-stage least squares, three-stage least squares}

%% at least one keyword must be supplied

%% publication information
%% NOTE: This needs to filled out ONLY IF THE PAPER WAS ACCEPTED.
%% If it was not (yet) accepted, leave them commented.
%% \Volume{13}
%% \Issue{9}
%% \Month{September}
%% \Year{2004}
%% \Submitdate{2004-09-29}
%% \Acceptdate{2004-09-29}

%% The address of (at least) one author should be given
%% in the following format:
\Address{
   Arne Henningsen\\
   Department of Agricultural Economics\\
   University of Kiel\\
   D-24098 Kiel, Germany\\
   E-mail: \email{ahenningsen@agric-econ.uni-kiel.de}\\
   URL: \url{http://www.uni-kiel.de/agrarpol/ahenningsen/}\\
   \\
   Jeff D. Hamann\\
   Forest Informatics, Inc.\\
   PO Box 1421\\
   Corvallis, Oregon 97339-1421\\
   e-mail: \email{jeff.hamann@forestinformatics.com}\\
   URL: \url{http://www.forestinformatics.com}\\
}
%% It is also possible to add a telephone and fax number
%% before the e-mail in the following format:
%% Telephone: +43/1/31336-5053
%% Fax: +43/1/31336-734

%% for those who use Sweave please include the following line (with % symbols):
%% need no \usepackage{Sweave.sty}

%% end of declarations %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

\input{systemfit_intro.tex}
\input{systemfit_estimation.tex}
\input{systemfit_restrictions.tex}
\input{systemfit_usage.tex}
\input{systemfit_other.tex}
\input{systemfit_summary.tex}




% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \section{Estimating nonlinear equation systems}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% The \pkg{systemfit} package also contains a method for fitting
% nonlinear systems of equations.


% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% \subsection{Nonlinear parameter estimation}
% \label{sec:nonlinear_estimation}
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% A system of nonlinear equations can be written as:
  
% \begin{equation}
%   \label{eq:non_linear_eq_1}
%   \epsilon_{t} = q( y_t, x_t, \beta )
% \end{equation}
% %%% It is not clear what these variable are. 
% %%% Adding an equation representing only a single equation
% %%% would make things clearer.

% \noindent and

% \begin{equation}
%   \label{eq:non_linear_eq_2}
%   z_{t} = Z( x_t )
% \end{equation}

% where $\epsilon_{t}$ are the residuals from the y observations and
% $z_{t}$ are the function evaluated at the parameter estimates.

% \textbf{you really need to check this!!!}

% The objective functions for the methods are:
  
% \begin{center}
% \begin{tabular}{|l|c|c|c|} \hline
%   Method & Instruments & Objective Function & Covariance of $\theta$ \\ \hline  
%   OLS & No & $r'r$ & $(X(diag(S)^{-1}\otimes I)X)^{-1}$ \\ \hline
%   SUR & No & $r'(diag(S)_{OLS}^{-1}\otimes I)r$ & $(X(S^{-1}\otimes I)X)^{-1}$ \\ \hline
%   2SLS & Yes & $r'(I \otimes W)r$ & $(X(diag(S)^{-1}\otimes I)X)^{-1}$ \\ \hline 
%   3SLS & Yes & $r'(S_{2SLS}^{-1} \otimes W)r$ & $(X(diag(S)^{-1}\otimes W)X)^{-1}$ \\ \hline
% \end{tabular}
% \end{center}

% where, $r$ is a column vector for the residuals for each equation,
% %% what is the difference to \epsilon?
% $X$ is matrix of the partial derivatives of the dependent variable 
% with respect to the parameters $\left( \frac{ \partial y }{ \theta} \right)$,
% %% is this correct?
% %% in the linear section X is used for the regressors, 
% %% thus we should use a different variable name here.
% $W$ is a matrix of the instrument variables, $Z(Z'Z)^{-1}Z$, $Z$ is a
% matrix of the instrument variables, and $I$ is an $n \times n $
% identity matrix and $S$ is the estimated variance-covariance matrix between the
% equations

% \begin{equation}
%   \label{eq:non-linear_varcov}
%   \hat{\sigma}_{ij} = (\hat{e}_i' \hat{e}_j) / \sqrt{(T - k_i)*(T- k_j)} 
% \end{equation}

% \textbf{The residual variance-covariance matrix can be calculated in 
% different ways (section~\ref{sec:residcov}). 
% It should be relatively easy to implement this also in nlsystemfit(), 
% e.g. the function 'calcRCov' in systemfit() could be moved outside
% systemfit() that it can be used also by nlsystemfit().}

% \textbf{You need to clear this up.}

% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % \subsection{Using nlsystemfit}\label{sec:UsingnlSystemfit}
% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% % \code {nlsystemfit} fits a set of structural nonlinear equations using
% % Ordinary Least Squares (OLS), Seemingly Unrelated Regression (SUR),
% % Two-Stage Least Squares (2SLS), Three-Stage Least Squares (3SLS) using
% % the objective functions described in section
% % \ref{sec:nonlinear_estimation}.

% % %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% % \subsubsection{Standard usage}

% % Similar to calling the \code{systemfit} function, \code{nlsystemfit}
% % is called with a minimum of three arguments,

% % \code{
% % R> nlsystemfit( method, eqns, start )
% % }

% % where \code{method} is one of the following estimation methods: "OLS",
% % "SUR", "2SLS", or "3SLS", \code{eqns} is a list of equations similar
% % to those described for \code{systemfit}, and \code{start} is a list of
% % starting values of the parameter estimates.

% % % The mandatory argument \code{eqns} is a list of the equations  to
% % % estimate.  Each equation is a standard formula in \proglang{R}.  It
% % % starts with a dependent variable on the left hand side.  After a tilde
% % % ($~$) the regressors are listed  \footnote{For Details see the
% % %   \proglang{R} help files to \code{formula}}.

% % This is now demonstrated using an example: \\

% % % \code{
% % % R> library( systemfit ) \\
% % % R> data( ppine ) \\
% % % R> hg.formula <- hg $\sim$ exp( h0 + h1*log(tht) + h2*tht$\hat$2 + h3*elev + h4*cr) \\
% % % R> dg.formula <- dg $\sim$ exp( d0 + d1*log(dbh) + d2*hg + d3*cr + d4*ba  ) \\
% % % R> labels <- list( "height.growth", "diameter.growth" )\\
% % % R> inst <- $\sim$ tht + dbh + elev + cr + ba\\
% % % R> start.values <- c(h0=-0.5, h1=0.5, h2=-0.001, h3=0.0001, h4=0.08,\\
% % % R+   d0=-0.5, d1=0.009, d2=0.25, d3=0.005, d4=-0.02 )\\
% % % R> model <- list( hg.formula, dg.formula )\\
% % % R> model.3sls <- nlsystemfit( "3SLS", model, start.values, data=ppine,\\
% % % R+   eqnlabels=labels, inst=inst ) \\
% % % R> summary( model.3sls ) \\
% % % }


% % The nlsystemfit function relies on \code{nlm} to perform the
% % minimization of the objective functions and the \code{qr} set of
% % functions. If the user does not have a set of estimates for the
% % initial parameters, it is suggested using linearized forms in one of
% % the linear methods, or simply using \code{nls} to obtain estimates for
% % the equations. 

% % The outputs are similar to those for a systemfit object. 




% \section{CVS Revision Log}
% \begin{verbatim}
% $Log$
% Revision 1.16  2005/11/02 18:31:45  hamannj
% small last changes
%
% Revision 1.15  2005/11/02 18:15:40  hamannj
% small changes

% Revision 1.14  2005/10/26 21:16:53  hamannj
% checked out and updated local copy before edits

% Revision 1.13  2005/09/26 20:34:12  henningsena
% using now package csquotes to have uniform and correct quotation marks (BibTeX-Style jss.bst has to be modified)

% Revision 1.12  2005/09/26 11:24:05  henningsena
% some minor changes

% Revision 1.11  2005/09/01 12:27:55  henningsena
% revised structure of the document (sections, subsections, subsubsections) due to removal of nlsystemfit; moved each section into a separate file.

% Revision 1.10  2005/09/01 11:49:02  henningsena
% moved section about non-linear estimation from systemfit.tex into new file nlsystemfit.tex, because this section should not be included in (this version of) the article

% Revision 1.9  2004/11/16 10:59:09  henningsena
% some minor changes and some comments on nlsystemfit

% Revision 1.8  2004/11/16 08:55:53  henningsena
% merged file and resolved conflict due to some minor changes I did while Jeff was adding nlsystemfit.

% Revision 1.7  2004/11/16 05:34:47  hamannj
% question about nlsystemfit code section (example)

% Revision 1.6  2004/11/16 05:32:46  hamannj
% made small changes because my code section wouldn't compile. argh.

% Revision 1.5  2004/11/16 05:31:19  hamannj
% added cvs header and log section. to be removed when submitted.

% \end{verbatim}




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\bibliography{systemfit} % a subset of my big bibtex file
%\bibliography{/home/suapm095/Documents/Literatur/arne}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





\end{document}


