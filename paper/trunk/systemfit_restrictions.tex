%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Imposing linear restrictions}\label{sec:Restrictions}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

There are two ways to impose linear parameter restrictions.
First, a matrix $T$ can be provided with
\begin{equation}
   \beta = T \cdot \beta^* \label{eq:T-restr} 
\end{equation}
where $\beta^*$ is a vector of restricted (linear independent) coefficients,
and $T$ is a matrix with the number of rows equal to the number of
unrestricted coefficients ($\beta$) and
the number of columns equal to the number of restricted coefficients
($\beta^*$).
$T$ can be used to map each unrestricted coefficient to one or more
restricted coefficients.

To impose these restrictions, the $X$ matrix is
(post-)multiplied by this $T$ matrix.
\begin{equation}
    X^* = X \cdot T
\end{equation}

Then, a standard estimation is done by substituting $X^*$ for $X$.
This results in the linear independent parameter estimates $\beta^*$ and
the variance-covariance matrix of these parameters. 
The original parameters can be obtained by equation (\ref{eq:T-restr})
and the variance-covariance matrix of the original parameters 
can be obtained by:
\begin{equation}
   Var \left[ \widehat{\beta} \right] = T \cdot Var \left[ \widehat{\beta^*} \right] \cdot T'
\end{equation}

The second way to impose linear parameter restrictions 
can be formulated by
\begin{equation}
   R \beta^0 = q
\end{equation}
where $\beta^0$ is the vector of the restricted coefficients, 
$R$ is a matrix and $q$ is a vector (see \citealp[p.\ 100]{greene02}). 
Each restriction belongs to one row of $R$ and the corresponding 
element of~$q$.

The first way is less flexible than this latter one%
\footnote{e.g.\ restrictions like $\beta_1 + \beta_2 = 4$ cannot be imposed
by the first method.}, 
but the first way is preferable if equality constraints for coefficients
across many equations of the system are imposed. 
Of course, these restrictions can be also imposed using
the latter method.
However, while the latter method increases the dimension of the 
matrices to be inverted during estimation, the first reduces it. 
Thus, in some cases the latter way leads to estimation problems
(e.g.\ (near) singularity of the matrices to be inverted),
while the first doesn't.

These two methods can be combined. In this case the restrictions
imposed using the latter method are imposed on the linear independent 
parameters due to the restrictions imposed using the first method:
\begin{equation}
   R \beta^{*0} = q
\end{equation}
where $\beta^{*0}$ is the vector of the restricted $\beta^*$ coefficients.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted OLS estimation}

The OLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      X' X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      X' y \\ q 
   \end{array} \right]
\end{equation}
where $2\lambda$ is a vector of the Lagrangean multipliers of the restrictions.

If the whole system is treated as one single equation, 
the variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = \sigma^2 
   \left[ \begin{array}{cc}
      X' X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}
with $\sigma^2 = E \left( u' u \right)$.

If the disturbance terms of the individual equations 
are allowed to have different variances, 
the variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      X' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}
with $\Omega = \Sigma \otimes I$, 
$\sigma_{ij} = 0 \; \forall \; i \neq j$ and
$\sigma_{ii} = E \left( u_i' u_i \right)$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted WLS estimation}

The WLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      X' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      X' \Omega^{-1} y \\ q 
   \end{array} \right]
\end{equation}
with $\Omega = \Sigma \otimes I$, 
$\sigma_{ij} = 0 \; \forall \; i \neq j$ and
$\sigma_{ii} = E \left( u_i' u_i \right)$.

The variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      X' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted SUR estimation}

The SUR estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      X' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      X' \Omega^{-1} y \\ q 
   \end{array} \right]
\end{equation}
with $\Omega = \Sigma \otimes I$ and
$\sigma_{ij} = E \left( u_i' u_j \right)$.

The variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      X' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted 2SLS estimation}

The 2SLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' y \\ q 
   \end{array} \right]
   \label{eq:beta2SLSr}
\end{equation}

If the whole system is treated as one single equation, 
the variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = \sigma^2 
   \left[ \begin{array}{cc}
      \widehat{X}' \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}
with $\sigma^2 = E \left( u' u \right)$.

If the disturbance terms of the individual equations 
are allowed to have different variances, 
the variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}
with $\Omega = \Sigma \otimes I$, 
$\sigma_{ij} = 0 \; \forall \; i \neq j$ and
$\sigma_{ii} = E \left( u_i' u_i \right)$.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted W2SLS estimation}

The W2SLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' \Omega^{-1} y \\ q 
   \end{array} \right]
\end{equation}
with $\Omega = \Sigma \otimes I$, 
$\sigma_{ij} = 0 \; \forall \; i \neq j$ and
$\sigma_{ii} = E \left( u_i' u_i \right)$.

The variance-covariance matrix of the estimated parameters is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Restricted 3SLS estimation}

The standard 3SLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' \Omega^{-1} y \\ q 
   \end{array} \right]
\end{equation}
with $\Omega = \Sigma \otimes I$ and
$\sigma_{ij} = E \left( u_i' u_j \right)$.

The variance-covariance matrix of this estimator is
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \label{eq:cov3slsr}
\end{equation}


The IV-3SLS estimator restricted by $R \beta^0 = q$ can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' \Omega^{-1} y \\ q 
   \end{array} \right]
\end{equation}

with
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}


The restricted 3SLS-GMM estimator can be obtained by
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      X' H \left( H' \Omega H \right)^{-1} H' X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      X' H \left( H \Omega H \right)^{-1} H' y \\ q 
   \end{array} \right]
\end{equation}

with
\begin{equation}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right] 
   = 
   \left[ \begin{array}{cc}
      X' H \left( H' \Omega H \right)^{-1} H' X & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{equation}


The restricted 3SLS estimator based on the suggestion of 
\cite{schmidt90} is:
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' \Omega^{-1} H \left( H' H \right)^{-1} H' y \\ q 
   \end{array} \right]
\end{equation}

with
\begin{eqnarray}
   Var 
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right] 
   & = & 
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} H \left( H' H \right)^{-1} H' \Omega
      H \left( H' H \right)^{-1} H' \Omega^{-1} \widehat{X} & 0' \\ 
      0 & 0
   \end{array} \right]^{-1}
   \nonumber \\
   & & \cdot
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
\end{eqnarray}


The econometrics software EViews calculates the restricted 3SLS estimator by:
\begin{equation}
   \left[ \begin{array}{c}
      \widehat{\beta^0} \\ \widehat{\lambda}
   \end{array} \right]
   =
   \left[ \begin{array}{cc}
      \widehat{X}' \Omega^{-1} \widehat{X} & R' \\ 
      R & 0
   \end{array} \right]^{-1}
   \cdot
   \left[ \begin{array}{c}
      \widehat{X}' \Omega^{-1} \left( y - X \widehat{\beta^0}_{2SLS} \right) 
      \\ q 
   \end{array} \right]
\end{equation}
where $\widehat{\beta^0}_{2SLS}$ is the restricted 2SLS estimator calculated
by equation (\ref{eq:beta2SLSr}). 
To calculate the variance-covariance matrix 
EViews uses the standard formula of the restricted 3SLS estimator
(\ref{eq:cov3slsr}).


If the same instrumental variables are used in all equations 
($H_1 = H_2 = \ldots = H_G$), 
all the above mentioned approaches lead to identical parameter estimates
and identical variance-covariance matrices of the estimated parameters.

%%% Local Variables: 
%%% mode: latex
%%% TeX-master: "systemfit"
%%% End: 
