
R : Copyright 2005, The R Foundation for Statistical Computing
Version 2.1.0  (2005-04-18), ISBN 3-900051-07-0

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for a HTML browser interface to help.
Type 'q()' to quit R.

> 
> library( systemfit )
> data( kmenta )
> 
> demand <- q ~ p + d
> supply <- q ~ p + f + a
> inst   <- ~ d + f + a
> inst1  <- ~ d + f
> instlist <- list( inst1, inst )
> labels <- list( "demand", "supply" )
> system <- list( demand, supply )
> restrm <- matrix(0,1,7)  # restriction matrix "R"
> restrm[1,3] <-  1
> restrm[1,7] <- -1
> restr2m <- matrix(0,2,7)  # restriction matrix "R" 2
> restr2q <- matrix(0,2,1)  # restriction vector "q" 2
> restr2m[1,3] <-  1
> restr2m[1,7] <- -1
> restr2m[2,2] <- -1
> restr2m[2,5] <-  1
> restr2q[2,1] <-  0.5
> tc <- matrix(0,7,6)
> tc[1,1] <- 1
> tc[2,2] <- 1
> tc[3,3] <- 1
> tc[4,4] <- 1
> tc[5,5] <- 1
> tc[6,6] <- 1
> tc[7,3] <- 1
> restr3m <- matrix(0,1,6)  # restriction matrix "R" 2
> restr3q <- matrix(0,1,1)  # restriction vector "q" 2
> restr3m[1,2] <- -1
> restr3m[1,5] <-  1
> restr3q[1,1] <-  0.5
> 
> # It is not possible to estimate 2SLS with systemfit exactly
> # as EViews does, because EViews uses
> # rcovformula == 1 for the coefficient covariance matrix and
> # rcovformula == 0 for the residual covariance matrix.
> # systemfit uses always the same formulas for both calculations.
> 
> ## *************** 2SLS estimation ************************
> ## ************ 2SLS estimation (default)*********************
> fit2sls1 <- systemfit( "2SLS", system, labels, data = kmenta, inst = inst )
> print( fit2sls1 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 65.7291 3.86642 1.96632 0.754847 0.726005
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.86642 4.35744
supply 4.35744 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.901724
supply 0.901724 1.000000

The determinant of the residual covariance matrix: 4.36424
OLS R-squared value of the system: 0.697214

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.633304   7.920838 11.947385        0 ***
p           -0.243557   0.096484 -2.524313 0.021832   *
d            0.313992   0.046944  6.688695    4e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.966321 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729088 MSE: 3.866417 Root MSE: 1.966321 
Multiple R-Squared: 0.754847 Adjusted R-Squared: 0.726005 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  12.010526 4.124086 0.000795 ***
p            0.240076   0.099934 2.402347 0.028785   *
f            0.255606    0.04725 5.409637  5.8e-05 ***
a            0.252924   0.099655 2.537996 0.021929   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2sls1$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   62.739680 -0.673422  0.049302   0.000000  0.000000  0.000000
p             -0.673422  0.009309 -0.002642   0.000000  0.000000  0.000000
d              0.049302 -0.002642  0.002204   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 144.252745 -1.095410 -0.323818
               0.000000  0.000000  0.000000  -1.095410  0.009987  0.000936
               0.000000  0.000000  0.000000  -0.323818  0.000936  0.002233
               0.000000  0.000000  0.000000  -0.295229  0.000579  0.001377
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.295229
             0.000579
             0.001377
             0.009931
> 
> ## *************** 2SLS estimation (single.eq.sigma=F)*******************
> fit2sls1s <- systemfit( "2SLS", system, labels, data = kmenta, inst = inst,
+    single.eq.sigma = FALSE )
> print( fit2sls1s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 65.7291 3.86642 1.96632 0.754847 0.726005
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.86642 4.35744
supply 4.35744 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.901724
supply 0.901724 1.000000

The determinant of the residual covariance matrix: 4.36424
OLS R-squared value of the system: 0.697214

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.633304   8.935163 10.591111        0 ***
p           -0.243557    0.10884 -2.237751 0.038916   *
d            0.313992   0.052955   5.92939  1.6e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.966321 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729088 MSE: 3.866417 Root MSE: 1.966321 
Multiple R-Squared: 0.754847 Adjusted R-Squared: 0.726005 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  10.840378 4.569254 0.000315 ***
p            0.240076   0.090198 2.661665 0.017058   *
f            0.255606   0.042647 5.993572  1.9e-05 ***
a            0.252924   0.089946 2.811956 0.012528   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2sls1s$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   79.837136 -0.856939  0.062737   0.000000  0.000000  0.000000
p             -0.856939  0.011846 -0.003362   0.000000  0.000000  0.000000
d              0.062737 -0.003362  0.002804   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 117.513794 -0.892363 -0.263795
               0.000000  0.000000  0.000000  -0.892363  0.008136  0.000763
               0.000000  0.000000  0.000000  -0.263795  0.000763  0.001819
               0.000000  0.000000  0.000000  -0.240505  0.000472  0.001122
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.240505
             0.000472
             0.001122
             0.008090
> 
> ## ********************* 2SLS (probdfsys = TRUE) *****************
> fit2sls1p <- systemfit( "2SLS", system, labels, data = kmenta, inst = inst,
+    probdfsys = TRUE )
> print( fit2sls1p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 65.7291 3.86642 1.96632 0.754847 0.726005
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.86642 4.35744
supply 4.35744 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.901724
supply 0.901724 1.000000

The determinant of the residual covariance matrix: 4.36424
OLS R-squared value of the system: 0.697214

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.633304   7.920838 11.947385        0 ***
p           -0.243557   0.096484 -2.524313 0.016584   *
d            0.313992   0.046944  6.688695        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.966321 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729088 MSE: 3.866417 Root MSE: 1.966321 
Multiple R-Squared: 0.754847 Adjusted R-Squared: 0.726005 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  12.010526 4.124086 0.000236 ***
p            0.240076   0.099934 2.402347 0.022076   *
f            0.255606    0.04725 5.409637    6e-06 ***
a            0.252924   0.099655 2.537996 0.016053   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2sls1p$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   62.739680 -0.673422  0.049302   0.000000  0.000000  0.000000
p             -0.673422  0.009309 -0.002642   0.000000  0.000000  0.000000
d              0.049302 -0.002642  0.002204   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 144.252745 -1.095410 -0.323818
               0.000000  0.000000  0.000000  -1.095410  0.009987  0.000936
               0.000000  0.000000  0.000000  -0.323818  0.000936  0.002233
               0.000000  0.000000  0.000000  -0.295229  0.000579  0.001377
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.295229
             0.000579
             0.001377
             0.009931
> 
> ## ********************* 2SLS (rcovformula = 0) *****************
> fit2sls1r <- systemfit( "2SLS", system, labels, data = kmenta, inst = inst,
+    rcovformula = 0 )
> print( fit2sls1r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 65.7291 3.86642 1.96632 0.754847 0.726005
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.28645 3.59324
supply 3.59324 4.83166

The correlations of the residuals
         demand   supply
demand 1.000000 0.901724
supply 0.901724 1.000000

The determinant of the residual covariance matrix: 2.96768
OLS R-squared value of the system: 0.697214

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.633304   7.302652 12.958758        0 ***
p           -0.243557   0.088954 -2.738002 0.014016   *
d            0.313992    0.04328  7.254908    1e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.966321 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729088 MSE: 3.866417 Root MSE: 1.966321 
Multiple R-Squared: 0.754847 Adjusted R-Squared: 0.726005 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  10.742541 4.610868 0.000289 ***
p            0.240076   0.089384 2.685905 0.016234   *
f            0.255606   0.042262 6.048158  1.7e-05 ***
a            0.252924   0.089134 2.837565 0.011883   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2sls1r$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   53.328728 -0.572408  0.041906   0.000000  0.000000  0.000000
p             -0.572408  0.007913 -0.002246   0.000000  0.000000  0.000000
d              0.041906 -0.002246  0.001873   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 115.402196 -0.876328 -0.259055
               0.000000  0.000000  0.000000  -0.876328  0.007989  0.000749
               0.000000  0.000000  0.000000  -0.259055  0.000749  0.001786
               0.000000  0.000000  0.000000  -0.236183  0.000463  0.001101
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.236183
             0.000463
             0.001101
             0.007945
> 
> ## *************** 2SLS (rcovformula=0, single.eq.sigma=F) *************
> fit2sls1rs <- systemfit( "2SLS", system, labels, data = kmenta, inst = inst,
+    rcovformula = 0, single.eq.sigma = FALSE )
> print( fit2sls1rs )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 65.7291 3.86642 1.96632 0.754847 0.726005
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.28645 3.59324
supply 3.59324 4.83166

The correlations of the residuals
         demand   supply
demand 1.000000 0.901724
supply 0.901724 1.000000

The determinant of the residual covariance matrix: 2.96768
OLS R-squared value of the system: 0.697214

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.633304   8.115765  11.66043        0 ***
p           -0.243557   0.098859 -2.463683 0.024715   *
d            0.313992   0.048099  6.528044    5e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.966321 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 65.729088 MSE: 3.866417 Root MSE: 1.966321 
Multiple R-Squared: 0.754847 Adjusted R-Squared: 0.726005 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442   9.846262 5.030583 0.000123 ***
p            0.240076   0.081926 2.930396 0.009802  **
f            0.255606   0.038736 6.598706    6e-06 ***
a            0.252924   0.081698 3.095861  0.00694  **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2sls1rs$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   65.865638 -0.706974  0.051758  0.000000  0.000000  0.000000
p             -0.706974  0.009773 -0.002774  0.000000  0.000000  0.000000
d              0.051758 -0.002774  0.002314  0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 96.948880 -0.736200 -0.217631
               0.000000  0.000000  0.000000 -0.736200  0.006712  0.000629
               0.000000  0.000000  0.000000 -0.217631  0.000629  0.001500
               0.000000  0.000000  0.000000 -0.198416  0.000389  0.000925
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.198416
             0.000389
             0.000925
             0.006674
> 
> ## ********************* 2SLS with restriction ********************
> ## **************** 2SLS with restriction (default)********************
> fit2sls2 <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = inst )
> print( fit2sls2 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.96577 4.55271
supply 4.55271 6.13469

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 3.60162
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.869261 10.630157        0 ***
p           -0.224712   0.103432 -2.172551 0.036878   *
d            0.298273     0.0454  6.569893        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433  10.538406  4.57226  6.1e-05 ***
p            0.24272   0.089623 2.708237 0.010511   *
f           0.261893   0.041059 6.378406        0 ***
a           0.298273     0.0454 6.569893        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls2$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   78.663794 -0.829021  0.046112  -1.370813  0.002689  0.006393
p             -0.829021  0.010698 -0.002471   0.073457 -0.000144 -0.000343
d              0.046112 -0.002471  0.002061  -0.061273  0.000120  0.000286
              -1.370813  0.073457 -0.061273 111.058001 -0.872938 -0.236592
               0.002689 -0.000144  0.000120  -0.872938  0.008032  0.000707
               0.006393 -0.000343  0.000286  -0.236592  0.000707  0.001686
               0.046112 -0.002471  0.002061  -0.061273  0.000120  0.000286
                     
(Intercept)  0.046112
p           -0.002471
d            0.002061
            -0.061273
             0.000120
             0.000286
             0.002061
> 
> ## ************* 2SLS with restriction (single.eq.sigma=T) *****************
> fit2sls2s <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = inst, single.eq.sigma = TRUE )
> print( fit2sls2s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.96577 4.55271
supply 4.55271 6.13469

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 3.60162
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.009046 11.771894        0 ***
p           -0.224712   0.094624 -2.374782 0.023344   *
d            0.298273   0.042972  6.941143        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433  11.800069 4.083394 0.000255 ***
p            0.24272   0.100578  2.41324 0.021349   *
f           0.261893   0.045928 5.702302    2e-06 ***
a           0.298273   0.042972 6.941143        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls2s$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   64.144817 -0.679629  0.041312  -1.228098  0.002409  0.005727
p             -0.679629  0.008954 -0.002214   0.065809 -0.000129 -0.000307
d              0.041312 -0.002214  0.001847  -0.054894  0.000108  0.000256
              -1.228098  0.065809 -0.054894 139.241633 -1.098376 -0.294954
               0.002409 -0.000129  0.000108  -1.098376  0.010116  0.000884
               0.005727 -0.000307  0.000256  -0.294954  0.000884  0.002109
               0.041312 -0.002214  0.001847  -0.054894  0.000108  0.000256
                     
(Intercept)  0.041312
p           -0.002214
d            0.001847
            -0.054894
             0.000108
             0.000256
             0.001847
> 
> ## ********************* 2SLS with restriction (probdfsys=T) **************
> fit2sls2p <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = inst, probdfsys = TRUE )
> print( fit2sls2p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.96577 4.55271
supply 4.55271 6.13469

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 3.60162
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.869261 10.630157        0 ***
p           -0.224712   0.103432 -2.172551 0.036878   *
d            0.298273     0.0454  6.569893        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433  10.538406  4.57226  6.1e-05 ***
p            0.24272   0.089623 2.708237 0.010511   *
f           0.261893   0.041059 6.378406        0 ***
a           0.298273     0.0454 6.569893        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls2p$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   78.663794 -0.829021  0.046112  -1.370813  0.002689  0.006393
p             -0.829021  0.010698 -0.002471   0.073457 -0.000144 -0.000343
d              0.046112 -0.002471  0.002061  -0.061273  0.000120  0.000286
              -1.370813  0.073457 -0.061273 111.058001 -0.872938 -0.236592
               0.002689 -0.000144  0.000120  -0.872938  0.008032  0.000707
               0.006393 -0.000343  0.000286  -0.236592  0.000707  0.001686
               0.046112 -0.002471  0.002061  -0.061273  0.000120  0.000286
                     
(Intercept)  0.046112
p           -0.002471
d            0.002061
            -0.061273
             0.000120
             0.000286
             0.002061
> 
> ## ********************* 2SLS with restriction (rcovformula = 0) **************
> fit2sls2r <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = inst, rcovformula = 0 )
> print( fit2sls2r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.37091 3.75426
supply 3.75426 4.90775

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 2.4491
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.177055 11.530024        0 ***
p           -0.224712    0.09536 -2.356462 0.024352   *
d            0.298273   0.041857   7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433    9.71593 4.959312  1.9e-05 ***
p            0.24272   0.082628 2.937495 0.005903  **
f           0.261893   0.037855 6.918353        0 ***
a           0.298273   0.041857  7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls2r$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   66.864225 -0.704668  0.039196 -1.165191  0.002285  0.005434
p             -0.704668  0.009094 -0.002100  0.062438 -0.000122 -0.000291
d              0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243
              -1.165191  0.062438 -0.052082 94.399301 -0.741997 -0.201104
               0.002285 -0.000122  0.000102 -0.741997  0.006827  0.000601
               0.005434 -0.000291  0.000243 -0.201104  0.000601  0.001433
               0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243
                     
(Intercept)  0.039196
p           -0.002100
d            0.001752
            -0.052082
             0.000102
             0.000243
             0.001752
> 
> ## ******** 2SLS with restriction (rcovformula=0, single.eq.sigma=TRUE) *********
> fit2sls2rs <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = inst, rcovformula = 0, single.eq.sigma = TRUE )
> print( fit2sls2rs )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.37091 3.75426
supply 3.75426 4.90775

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 2.4491
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   7.383374 12.769453        0 ***
p           -0.224712   0.087093 -2.580142 0.014369   *
d            0.298273   0.039393  7.571672        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433  10.557424 4.564023  6.3e-05 ***
p            0.24272   0.089962 2.698043 0.010779   *
f           0.261893   0.041096 6.372662        0 ***
a           0.298273   0.039393 7.571672        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls2rs$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   54.514208 -0.577209  0.034718  -1.032075  0.002024  0.004813
p             -0.577209  0.007585 -0.001860   0.055305 -0.000108 -0.000258
d              0.034718 -0.001860  0.001552  -0.046132  0.000090  0.000215
              -1.032075  0.055305 -0.046132 111.459210 -0.878830 -0.236271
               0.002024 -0.000108  0.000090  -0.878830  0.008093  0.000708
               0.004813 -0.000258  0.000215  -0.236271  0.000708  0.001689
               0.034718 -0.001860  0.001552  -0.046132  0.000090  0.000215
                     
(Intercept)  0.034718
p           -0.001860
d            0.001552
            -0.046132
             0.000090
             0.000215
             0.001552
> 
> ## ********************* 2SLS with restriction via TX ******************
> ## *************** 2SLS with restriction via TX (default )***************
> fit2sls3 <- systemfit( "2SLS", system, labels, data = kmenta, TX = tc,
+    inst = inst, rcovformula = 0, probdfsys = TRUE )
> print( fit2sls3 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.37091 3.75426
supply 3.75426 4.90775

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 2.4491
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.177055 11.530024        0 ***
p           -0.224712    0.09536 -2.356462 0.024352   *
d            0.298273   0.041857   7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433    9.71593 4.959312  1.9e-05 ***
p            0.24272   0.082628 2.937495 0.005903  **
f           0.261893   0.037855 6.918353        0 ***
a           0.298273   0.041857  7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls3$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 66.864225 -0.704668  0.039196 -1.165191  0.002285  0.005434  0.039196
[2,] -0.704668  0.009094 -0.002100  0.062438 -0.000122 -0.000291 -0.002100
[3,]  0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243  0.001752
[4,] -1.165191  0.062438 -0.052082 94.399301 -0.741997 -0.201104 -0.052082
[5,]  0.002285 -0.000122  0.000102 -0.741997  0.006827  0.000601  0.000102
[6,]  0.005434 -0.000291  0.000243 -0.201104  0.000601  0.001433  0.000243
[7,]  0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243  0.001752
> 
> ## ********************* 2SLS with restriction via TX (EViews-like) *******
> fit2sls3e <- systemfit( "2SLS", system, labels, data = kmenta, TX = tc,
+    inst = inst, rcovformula = 0, probdfsys = TRUE )
> print( fit2sls3e )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4181 3.96577 1.99143 0.748547 0.718964
supply 20 16 98.1550 6.13469 2.47683 0.633906 0.565263

The covariance matrix of the residuals
        demand  supply
demand 3.37091 3.75426
supply 3.75426 4.90775

The correlations of the residuals
         demand   supply
demand 1.000000 0.923017
supply 0.923017 1.000000

The determinant of the residual covariance matrix: 2.4491
OLS R-squared value of the system: 0.691227

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 94.281641   8.177055 11.530024        0 ***
p           -0.224712    0.09536 -2.356462 0.024352   *
d            0.298273   0.041857   7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991425 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.418139 MSE: 3.965773 Root MSE: 1.991425 
Multiple R-Squared: 0.748547 Adjusted R-Squared: 0.718964 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

            Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 48.18433    9.71593 4.959312  1.9e-05 ***
p            0.24272   0.082628 2.937495 0.005903  **
f           0.261893   0.037855 6.918353        0 ***
a           0.298273   0.041857  7.12605        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.47683 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 98.155009 MSE: 6.134688 Root MSE: 2.47683 
Multiple R-Squared: 0.633906 Adjusted R-Squared: 0.565263 

> print( round( fit2sls3e$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 66.864225 -0.704668  0.039196 -1.165191  0.002285  0.005434  0.039196
[2,] -0.704668  0.009094 -0.002100  0.062438 -0.000122 -0.000291 -0.002100
[3,]  0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243  0.001752
[4,] -1.165191  0.062438 -0.052082 94.399301 -0.741997 -0.201104 -0.052082
[5,]  0.002285 -0.000122  0.000102 -0.741997  0.006827  0.000601  0.000102
[6,]  0.005434 -0.000291  0.000243 -0.201104  0.000601  0.001433  0.000243
[7,]  0.039196 -0.002100  0.001752 -0.052082  0.000102  0.000243  0.001752
> 
> ## ***************** 2SLS with 2 restrictions *******************
> ## ************** 2SLS with 2 restrictions (default) **************
> fit2sls4 <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr2m,
+    q.restr = restr2q, inst = inst )
> print( fit2sls4 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.418923 14.909958        0 ***
p           -0.243279   0.066338 -3.667237 0.000808 ***
d             0.30271   0.040794  7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.894064 5.898573    1e-06 ***
p            0.256721   0.066338 3.869873 0.000454 ***
f             0.26369   0.039825 6.621231        0 ***
a             0.30271   0.040794 7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls4$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   41.202573 -0.345730 -0.065472 38.985202 -0.345730 -0.038481
p             -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249
d             -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139
              38.985202 -0.454065  0.065924 62.316249 -0.454065 -0.179623
              -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249
              -0.038481  0.000249  0.000139 -0.179623  0.000249  0.001586
              -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139
                     
(Intercept) -0.065472
p           -0.000968
d            0.001664
             0.065924
            -0.000968
             0.000139
             0.001664
> 
> ## ************ 2SLS with 2 restrictions (single.eq.sigma=T) **************
> fit2sls4s <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr2m,
+    q.restr = restr2q, inst = inst, single.eq.sigma = TRUE )
> print( fit2sls4s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.305629 15.177848        0 ***
p           -0.243279   0.068419 -3.555705 0.001104  **
d             0.30271   0.039386   7.68576        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   8.329568 5.590172    3e-06 ***
p            0.256721   0.068419 3.752178 0.000635 ***
f             0.26369   0.045524  5.79232    1e-06 ***
a             0.30271   0.039386  7.68576        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls4s$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   39.760952 -0.358128 -0.038417 39.694908 -0.358128 -0.035932
p             -0.358128  0.004681 -0.001129 -0.480685  0.004681  0.000252
d             -0.038417 -0.001129  0.001551  0.085946 -0.001129  0.000110
              39.694908 -0.480685  0.085946 69.381697 -0.480685 -0.226588
              -0.358128  0.004681 -0.001129 -0.480685  0.004681  0.000252
              -0.035932  0.000252  0.000110 -0.226588  0.000252  0.002072
              -0.038417 -0.001129  0.001551  0.085946 -0.001129  0.000110
                     
(Intercept) -0.038417
p           -0.001129
d            0.001551
             0.085946
            -0.001129
             0.000110
             0.001551
> 
> ## ***************** 2SLS with 2 restrictions (probdfsys=T) **************
> fit2sls4p <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr2m,
+    q.restr = restr2q, inst = inst, probdfsys = TRUE )
> print( fit2sls4p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.418923 14.909958        0 ***
p           -0.243279   0.066338 -3.667237 0.000808 ***
d             0.30271   0.040794  7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.894064 5.898573    1e-06 ***
p            0.256721   0.066338 3.869873 0.000454 ***
f             0.26369   0.039825 6.621231        0 ***
a             0.30271   0.040794 7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls4p$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   41.202573 -0.345730 -0.065472 38.985202 -0.345730 -0.038481
p             -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249
d             -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139
              38.985202 -0.454065  0.065924 62.316249 -0.454065 -0.179623
              -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249
              -0.038481  0.000249  0.000139 -0.179623  0.000249  0.001586
              -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139
                     
(Intercept) -0.065472
p           -0.000968
d            0.001664
             0.065924
            -0.000968
             0.000139
             0.001664
> 
> ## ***************** 2SLS with 2 restrictions (rcovformula=0) **************
> fit2sls4r <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr2m,
+    q.restr = restr2q, inst = inst, rcovformula = 0 )
> print( fit2sls4r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.30406 3.73451
supply 3.73451 4.99853

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 2.56886
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.004353 15.939415        0 ***
p           -0.243279   0.062054 -3.920441 0.000393 ***
d             0.30271   0.038159  7.932884        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.384221  6.30584        0 ***
p            0.256721   0.062054 4.137068  0.00021 ***
f             0.26369   0.037253 7.078394        0 ***
a             0.30271   0.038159 7.932884        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls4r$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   36.052251 -0.302514 -0.057288 34.112051 -0.302514 -0.033671
p             -0.302514  0.003851 -0.000847 -0.397307  0.003851  0.000218
d             -0.057288 -0.000847  0.001456  0.057684 -0.000847  0.000122
              34.112051 -0.397307  0.057684 54.526718 -0.397307 -0.157170
              -0.302514  0.003851 -0.000847 -0.397307  0.003851  0.000218
              -0.033671  0.000218  0.000122 -0.157170  0.000218  0.001388
              -0.057288 -0.000847  0.001456  0.057684 -0.000847  0.000122
                     
(Intercept) -0.057288
p           -0.000847
d            0.001456
             0.057684
            -0.000847
             0.000122
             0.001456
> 
> ## ***** 2SLS with 2 restrictions (rcovformula=0, single.eq.sigma=T) *******
> fit2sls4rs <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr2m,
+    q.restr = restr2q, inst = inst, rcovformula = 0, single.eq.sigma = TRUE )
> print( fit2sls4rs )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.30406 3.73451
supply 3.73451 4.99853

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 2.56886
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   5.757891 16.621689        0 ***
p           -0.243279   0.062128  -3.91575 0.000398 ***
d             0.30271   0.036041  8.399158        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713    7.53598 6.178853        0 ***
p            0.256721   0.062128 4.132117 0.000213 ***
f             0.26369   0.040736 6.473175        0 ***
a             0.30271   0.036041 8.399158        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls4rs$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)   33.153306 -0.296170 -0.034505 32.891500 -0.296170 -0.030081
p             -0.296170  0.003860 -0.000922 -0.396563  0.003860  0.000209
d             -0.034505 -0.000922  0.001299  0.069435 -0.000922  0.000094
              32.891500 -0.396563  0.069435 56.791000 -0.396563 -0.182213
              -0.296170  0.003860 -0.000922 -0.396563  0.003860  0.000209
              -0.030081  0.000209  0.000094 -0.182213  0.000209  0.001659
              -0.034505 -0.000922  0.001299  0.069435 -0.000922  0.000094
                     
(Intercept) -0.034505
p           -0.000922
d            0.001299
             0.069435
            -0.000922
             0.000094
             0.001299
> 
> ## ************* 2SLS with 2 restrictions via R and TX ******************
> ## ******** 2SLS with 2 restrictions via R and TX (default) *************
> fit2sls5 <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr3m,
+    q.restr = restr3q, TX = tc, inst = inst )
> print( fit2sls5 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.418923 14.909958        0 ***
p           -0.243279   0.066338 -3.667237 0.000808 ***
d             0.30271   0.040794  7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.894064 5.898573    1e-06 ***
p            0.256721   0.066338 3.869873 0.000454 ***
f             0.26369   0.039825 6.621231        0 ***
a             0.30271   0.040794 7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls5$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 41.202573 -0.345730 -0.065472 38.985202 -0.345730 -0.038481 -0.065472
[2,] -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249 -0.000968
[3,] -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139  0.001664
[4,] 38.985202 -0.454065  0.065924 62.316249 -0.454065 -0.179623  0.065924
[5,] -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249 -0.000968
[6,] -0.038481  0.000249  0.000139 -0.179623  0.000249  0.001586  0.000139
[7,] -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139  0.001664
> 
> ## ******* 2SLS with 2 restrictions via R and TX (single.eq.sigma=T) ******
> fit2sls5s <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr3m,
+    q.restr = restr3q, TX = tc, inst = inst, single.eq.sigma = TRUE )
> print( fit2sls5s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.305629 15.177848        0 ***
p           -0.243279   0.068419 -3.555705 0.001104  **
d             0.30271   0.039386   7.68576        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   8.329568 5.590172    3e-06 ***
p            0.256721   0.068419 3.752178 0.000635 ***
f             0.26369   0.045524  5.79232    1e-06 ***
a             0.30271   0.039386  7.68576        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls5s$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 39.760952 -0.358128 -0.038417 39.694908 -0.358128 -0.035932 -0.038417
[2,] -0.358128  0.004681 -0.001129 -0.480685  0.004681  0.000252 -0.001129
[3,] -0.038417 -0.001129  0.001551  0.085946 -0.001129  0.000110  0.001551
[4,] 39.694908 -0.480685  0.085946 69.381697 -0.480685 -0.226588  0.085946
[5,] -0.358128  0.004681 -0.001129 -0.480685  0.004681  0.000252 -0.001129
[6,] -0.035932  0.000252  0.000110 -0.226588  0.000252  0.002072  0.000110
[7,] -0.038417 -0.001129  0.001551  0.085946 -0.001129  0.000110  0.001551
> 
> ## ********** 2SLS with 2 restrictions via R and TX (probdfsys=T) *******
> fit2sls5p <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr3m,
+    q.restr = restr3q, TX = tc, inst = inst, probdfsys = TRUE )
> print( fit2sls5p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.88713 4.52876
supply 4.52876 6.24816

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 3.77774
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.418923 14.909958        0 ***
p           -0.243279   0.066338 -3.667237 0.000808 ***
d             0.30271   0.040794  7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.894064 5.898573    1e-06 ***
p            0.256721   0.066338 3.869873 0.000454 ***
f             0.26369   0.039825 6.621231        0 ***
a             0.30271   0.040794 7.420533        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls5p$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 41.202573 -0.345730 -0.065472 38.985202 -0.345730 -0.038481 -0.065472
[2,] -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249 -0.000968
[3,] -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139  0.001664
[4,] 38.985202 -0.454065  0.065924 62.316249 -0.454065 -0.179623  0.065924
[5,] -0.345730  0.004401 -0.000968 -0.454065  0.004401  0.000249 -0.000968
[6,] -0.038481  0.000249  0.000139 -0.179623  0.000249  0.001586  0.000139
[7,] -0.065472 -0.000968  0.001664  0.065924 -0.000968  0.000139  0.001664
> 
> ## ************* 2SLS with 2 restrictions via R and TX (rcovformula=0) *********
> fit2sls5r <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr3m,
+    q.restr = restr3q, TX = tc, inst = inst, rcovformula = 0 )
> print( fit2sls5r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.30406 3.73451
supply 3.73451 4.99853

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 2.56886
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   6.004353 15.939415        0 ***
p           -0.243279   0.062054 -3.920441 0.000393 ***
d             0.30271   0.038159  7.932884        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713   7.384221  6.30584        0 ***
p            0.256721   0.062054 4.137068  0.00021 ***
f             0.26369   0.037253 7.078394        0 ***
a             0.30271   0.038159 7.932884        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls5r$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 36.052251 -0.302514 -0.057288 34.112051 -0.302514 -0.033671 -0.057288
[2,] -0.302514  0.003851 -0.000847 -0.397307  0.003851  0.000218 -0.000847
[3,] -0.057288 -0.000847  0.001456  0.057684 -0.000847  0.000122  0.001456
[4,] 34.112051 -0.397307  0.057684 54.526718 -0.397307 -0.157170  0.057684
[5,] -0.302514  0.003851 -0.000847 -0.397307  0.003851  0.000218 -0.000847
[6,] -0.033671  0.000218  0.000122 -0.157170  0.000218  0.001388  0.000122
[7,] -0.057288 -0.000847  0.001456  0.057684 -0.000847  0.000122  0.001456
> 
> ## ** 2SLS with 2 restrictions via R and TX (rcovformula=0, single.eq.sigma=T) **
> fit2sls5rs <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restr3m,
+    q.restr = restr3q, TX = tc, inst = inst, rcovformula = 0, single.eq.sigma = TRUE )
> print( fit2sls5rs )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 66.0812 3.88713 1.97158 0.753534 0.724538
supply 20 16 99.9706 6.24816 2.49963 0.627134 0.557222

The covariance matrix of the residuals
        demand  supply
demand 3.30406 3.73451
supply 3.73451 4.99853

The correlations of the residuals
         demand   supply
demand 1.000000 0.918943
supply 0.918943 1.000000

The determinant of the residual covariance matrix: 2.56886
OLS R-squared value of the system: 0.690334

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f + a

             Estimate Std. Error   t value Pr(>|t|)    
(Intercept)  95.70587   5.757891 16.621689        0 ***
p           -0.243279   0.062128  -3.91575 0.000398 ***
d             0.30271   0.036041  8.399158        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.97158 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 66.081175 MSE: 3.887128 Root MSE: 1.97158 
Multiple R-Squared: 0.753534 Adjusted R-Squared: 0.724538 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 46.563713    7.53598 6.178853        0 ***
p            0.256721   0.062128 4.132117 0.000213 ***
f             0.26369   0.040736 6.473175        0 ***
a             0.30271   0.036041 8.399158        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.499633 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 99.970628 MSE: 6.248164 Root MSE: 2.499633 
Multiple R-Squared: 0.627134 Adjusted R-Squared: 0.557222 

> print( round( fit2sls5rs$bcov, digits = 6 ) )
          [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 33.153306 -0.296170 -0.034505 32.891500 -0.296170 -0.030081 -0.034505
[2,] -0.296170  0.003860 -0.000922 -0.396563  0.003860  0.000209 -0.000922
[3,] -0.034505 -0.000922  0.001299  0.069435 -0.000922  0.000094  0.001299
[4,] 32.891500 -0.396563  0.069435 56.791000 -0.396563 -0.182213  0.069435
[5,] -0.296170  0.003860 -0.000922 -0.396563  0.003860  0.000209 -0.000922
[6,] -0.030081  0.000209  0.000094 -0.182213  0.000209  0.001659  0.000094
[7,] -0.034505 -0.000922  0.001299  0.069435 -0.000922  0.000094  0.001299
> 
> ## *********** 2SLS estimation with different instruments **************
> ## ******* 2SLS estimation with different instruments (default) *********
> fit2slsd1 <- systemfit( "2SLS", system, labels, data = kmenta, inst = instlist )
> print( fit2slsd1 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4466 3.96745 1.99185 0.748441 0.718846
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.96744 3.83562
supply 3.83562 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.783569
supply 0.783569 1.000000

The determinant of the residual covariance matrix: 9.24969
OLS R-squared value of the system: 0.694011

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 106.789358  11.143545 9.583069        0 ***
p            -0.411599   0.144845 -2.84166 0.011271   *
d             0.361681   0.056406 6.412096    6e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991845 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.446561 MSE: 3.967445 Root MSE: 1.991845 
Multiple R-Squared: 0.748441 Adjusted R-Squared: 0.718846 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  12.010526 4.124086 0.000795 ***
p            0.240076   0.099934 2.402347 0.028785   *
f            0.255606    0.04725 5.409637  5.8e-05 ***
a            0.252924   0.099655 2.537996 0.021929   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2slsd1$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  124.178595 -1.517672  0.285189   0.000000  0.000000  0.000000
p             -1.517672  0.020980 -0.005954   0.000000  0.000000  0.000000
d              0.285189 -0.005954  0.003182   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 144.252745 -1.095410 -0.323818
               0.000000  0.000000  0.000000  -1.095410  0.009987  0.000936
               0.000000  0.000000  0.000000  -0.323818  0.000936  0.002233
               0.000000  0.000000  0.000000  -0.295229  0.000579  0.001377
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.295229
             0.000579
             0.001377
             0.009931
> 
> ## *********** 2SLS estimation with different instruments (single.eq.sigma=F)*****
> fit2slsd1s <- systemfit( "2SLS", system, labels, data = kmenta, inst = instlist,
+    single.eq.sigma = FALSE )
> print( fit2slsd1s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4466 3.96745 1.99185 0.748441 0.718846
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.96744 3.83562
supply 3.83562 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.783569
supply 0.783569 1.000000

The determinant of the residual covariance matrix: 9.24969
OLS R-squared value of the system: 0.694011

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 106.789358  12.474942  8.560309        0 ***
p            -0.411599    0.16215 -2.538382 0.021211   *
d             0.361681   0.063145  5.727761  2.5e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991845 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.446561 MSE: 3.967445 Root MSE: 1.991845 
Multiple R-Squared: 0.748441 Adjusted R-Squared: 0.718846 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  10.897562 4.545277 0.000331 ***
p            0.240076   0.090673 2.647698 0.017551   *
f            0.255606   0.042872 5.962121    2e-05 ***
a            0.252924    0.09042   2.7972 0.012916   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2slsd1s$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  155.624169 -1.901991  0.357407   0.000000  0.000000  0.000000
p             -1.901991  0.026293 -0.007462   0.000000  0.000000  0.000000
d              0.357407 -0.007462  0.003987   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 118.756858 -0.901803 -0.266585
               0.000000  0.000000  0.000000  -0.901803  0.008222  0.000771
               0.000000  0.000000  0.000000  -0.266585  0.000771  0.001838
               0.000000  0.000000  0.000000  -0.243049  0.000477  0.001133
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.243049
             0.000477
             0.001133
             0.008176
> 
> ## ********* 2SLS estimation with different instruments (probdfsys=T) *******
> fit2slsd1p <- systemfit( "2SLS", system, labels, data = kmenta, inst = instlist,
+    probdfsys = TRUE )
> print( fit2slsd1p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4466 3.96745 1.99185 0.748441 0.718846
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.96744 3.83562
supply 3.83562 6.03958

The correlations of the residuals
         demand   supply
demand 1.000000 0.783569
supply 0.783569 1.000000

The determinant of the residual covariance matrix: 9.24969
OLS R-squared value of the system: 0.694011

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 106.789358  11.143545 9.583069        0 ***
p            -0.411599   0.144845 -2.84166 0.007636  **
d             0.361681   0.056406 6.412096        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991845 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.446561 MSE: 3.967445 Root MSE: 1.991845 
Multiple R-Squared: 0.748441 Adjusted R-Squared: 0.718846 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  12.010526 4.124086 0.000236 ***
p            0.240076   0.099934 2.402347 0.022076   *
f            0.255606    0.04725 5.409637    6e-06 ***
a            0.252924   0.099655 2.537996 0.016053   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2slsd1p$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  124.178595 -1.517672  0.285189   0.000000  0.000000  0.000000
p             -1.517672  0.020980 -0.005954   0.000000  0.000000  0.000000
d              0.285189 -0.005954  0.003182   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 144.252745 -1.095410 -0.323818
               0.000000  0.000000  0.000000  -1.095410  0.009987  0.000936
               0.000000  0.000000  0.000000  -0.323818  0.000936  0.002233
               0.000000  0.000000  0.000000  -0.295229  0.000579  0.001377
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.295229
             0.000579
             0.001377
             0.009931
> 
> ## ********* 2SLS estimation with different instruments (rcovformula=0) ******
> fit2slsd1r <- systemfit( "2SLS", system, labels, data = kmenta, inst = instlist,
+    rcovformula = 0 )
> print( fit2slsd1r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4466 3.96745 1.99185 0.748441 0.718846
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.37233 3.16294
supply 3.16294 4.83166

The correlations of the residuals
         demand   supply
demand 1.000000 0.783569
supply 0.783569 1.000000

The determinant of the residual covariance matrix: 6.28979
OLS R-squared value of the system: 0.694011

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 106.789358  10.273841 10.394298        0 ***
p            -0.411599    0.13354 -3.082213 0.006757  **
d             0.361681   0.052004  6.954895    2e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991845 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.446561 MSE: 3.967445 Root MSE: 1.991845 
Multiple R-Squared: 0.748441 Adjusted R-Squared: 0.718846 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442  10.742541 4.610868 0.000289 ***
p            0.240076   0.089384 2.685905 0.016234   *
f            0.255606   0.042262 6.048158  1.7e-05 ***
a            0.252924   0.089134 2.837565 0.011883   *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2slsd1r$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  105.551806 -1.290022  0.242411   0.000000  0.000000  0.000000
p             -1.290022  0.017833 -0.005061   0.000000  0.000000  0.000000
d              0.242411 -0.005061  0.002704   0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 115.402196 -0.876328 -0.259055
               0.000000  0.000000  0.000000  -0.876328  0.007989  0.000749
               0.000000  0.000000  0.000000  -0.259055  0.000749  0.001786
               0.000000  0.000000  0.000000  -0.236183  0.000463  0.001101
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.236183
             0.000463
             0.001101
             0.007945
> 
> ## 2SLS estimation with different instruments (rcovformula=0,single.eq.sigma=F)
> fit2slsd1r <- systemfit( "2SLS", system, labels, data = kmenta, inst = instlist,
+    rcovformula = 0, single.eq.sigma = FALSE )
> print( fit2slsd1r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17 67.4466 3.96745 1.99185 0.748441 0.718846
supply 20 16 96.6332 6.03958 2.45756 0.639582 0.572004

The covariance matrix of the residuals
        demand  supply
demand 3.37233 3.16294
supply 3.16294 4.83166

The correlations of the residuals
         demand   supply
demand 1.000000 0.783569
supply 0.783569 1.000000

The determinant of the residual covariance matrix: 6.28979
OLS R-squared value of the system: 0.694011

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 106.789358  11.330928   9.42459        0 ***
p            -0.411599    0.14728 -2.794666 0.012444   *
d             0.361681   0.057355  6.306057    8e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.991845 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 67.446561 MSE: 3.967445 Root MSE: 1.991845 
Multiple R-Squared: 0.748441 Adjusted R-Squared: 0.718846 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 49.532442   9.898202 5.004186  0.00013 ***
p            0.240076   0.082358 2.915019  0.01012   *
f            0.255606    0.03894 6.564079    7e-06 ***
a            0.252924   0.082128 3.079616  0.00718  **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.457555 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 96.633244 MSE: 6.039578 Root MSE: 2.457555 
Multiple R-Squared: 0.639582 Adjusted R-Squared: 0.572004 

> print( round( fit2slsd1r$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)  128.389939 -1.569142  0.294861  0.000000  0.000000  0.000000
p             -1.569142  0.021691 -0.006156  0.000000  0.000000  0.000000
d              0.294861 -0.006156  0.003290  0.000000  0.000000  0.000000
               0.000000  0.000000  0.000000 97.974408 -0.743987 -0.219933
               0.000000  0.000000  0.000000 -0.743987  0.006783  0.000636
               0.000000  0.000000  0.000000 -0.219933  0.000636  0.001516
               0.000000  0.000000  0.000000 -0.200515  0.000393  0.000935
                     
(Intercept)  0.000000
p            0.000000
d            0.000000
            -0.200515
             0.000393
             0.000935
             0.006745
> 
> ## **** 2SLS estimation with different instruments and restriction *******
> ## ** 2SLS estimation with different instruments and restriction (default) ****
> fit2slsd2 <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = instlist )
> print( fit2slsd2 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.79088 4.34523
supply 4.34523 6.27004

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 4.88798
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605  11.892958  8.710499        0 ***
p             -0.34488   0.145481 -2.370628 0.023569   *
d             0.326029    0.05111  6.378936        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225  10.536236  4.49489  7.7e-05 ***
p            0.244338   0.089415 2.732641 0.009895  **
f            0.265741    0.04109 6.467208        0 ***
a            0.326029    0.05111 6.378936        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd2$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  141.442455 -1.640068  0.234151  -6.960747  0.013653  0.032462
p             -1.640068  0.021165 -0.004888   0.145321 -0.000285 -0.000678
d              0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362
              -6.960747  0.145321 -0.077656 111.012272 -0.869653 -0.237751
               0.013653 -0.000285  0.000152  -0.869653  0.007995  0.000708
               0.032462 -0.000678  0.000362  -0.237751  0.000708  0.001688
               0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362
                     
(Intercept)  0.234151
p           -0.004888
d            0.002612
            -0.077656
             0.000152
             0.000362
             0.002612
> 
> ## 2SLS estimation with different instruments and restriction (single.eq.sigma=T)
> fit2slsd2s <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = instlist, single.eq.sigma = TRUE )
> print( fit2slsd2s )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.79088 4.34523
supply 4.34523 6.27004

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 4.88798
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605   10.63439  9.741377        0 ***
p             -0.34488   0.132748 -2.598011 0.013762   *
d             0.326029   0.048454   6.72863        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225  11.946576 3.964251 0.000359 ***
p            0.244338    0.10169 2.402785 0.021876   *
f            0.265741   0.046527  5.71158    2e-06 ***
a            0.326029   0.048454  6.72863        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd2s$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  113.090252 -1.334011  0.210445  -6.256034  0.012271  0.029175
p             -1.334011  0.017622 -0.004394   0.130609 -0.000256 -0.000609
d              0.210445 -0.004394  0.002348  -0.069794  0.000137  0.000325
              -6.256034  0.130609 -0.069794 142.720671 -1.123408 -0.303360
               0.012271 -0.000256  0.000137  -1.123408  0.010341  0.000908
               0.029175 -0.000609  0.000325  -0.303360  0.000908  0.002165
               0.210445 -0.004394  0.002348  -0.069794  0.000137  0.000325
                     
(Intercept)  0.210445
p           -0.004394
d            0.002348
            -0.069794
             0.000137
             0.000325
             0.002348
> 
> ## **** 2SLS estimation with different instruments and restriction (probdfsys=F)
> fit2slsd2p <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = instlist, probdfsys = FALSE )
> print( fit2slsd2p )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.79088 4.34523
supply 4.34523 6.27004

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 4.88798
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605  11.892958  8.710499        0 ***
p             -0.34488   0.145481 -2.370628 0.029845   *
d             0.326029    0.05111  6.378936    7e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225  10.536236  4.49489 0.000367 ***
p            0.244338   0.089415 2.732641 0.014751   *
f            0.265741    0.04109 6.467208    8e-06 ***
a            0.326029    0.05111 6.378936    9e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd2p$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)  141.442455 -1.640068  0.234151  -6.960747  0.013653  0.032462
p             -1.640068  0.021165 -0.004888   0.145321 -0.000285 -0.000678
d              0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362
              -6.960747  0.145321 -0.077656 111.012272 -0.869653 -0.237751
               0.013653 -0.000285  0.000152  -0.869653  0.007995  0.000708
               0.032462 -0.000678  0.000362  -0.237751  0.000708  0.001688
               0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362
                     
(Intercept)  0.234151
p           -0.004888
d            0.002612
            -0.077656
             0.000152
             0.000362
             0.002612
> 
> ## **** 2SLS estimation with different instruments and restriction (rcovformula=0)
> fit2slsd2r <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = instlist, rcovformula = 0 )
> print( fit2slsd2r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.22225 3.58317
supply 3.58317 5.01603

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 3.32382
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605  10.964766  9.447863        0 ***
p             -0.34488   0.134126 -2.571307 0.014678   *
d             0.326029   0.047121  6.918928        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225    9.71393 4.875393  2.5e-05 ***
p            0.244338   0.082436 2.963965 0.005515  **
f            0.265741   0.037884 7.014671        0 ***
a            0.326029   0.047121 6.918928        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd2r$bcov, digits = 6 ) )
            (Intercept)         p         d                              
(Intercept)  120.226087 -1.394058  0.199028 -5.916635  0.011605  0.027592
p             -1.394058  0.017990 -0.004155  0.123523 -0.000242 -0.000576
d              0.199028 -0.004155  0.002220 -0.066008  0.000129  0.000308
              -5.916635  0.123523 -0.066008 94.360431 -0.739205 -0.202088
               0.011605 -0.000242  0.000129 -0.739205  0.006796  0.000602
               0.027592 -0.000576  0.000308 -0.202088  0.000602  0.001435
               0.199028 -0.004155  0.002220 -0.066008  0.000129  0.000308
                     
(Intercept)  0.199028
p           -0.004155
d            0.002220
            -0.066008
             0.000129
             0.000308
             0.002220
> 
> ## 2SLS estimation with different instr. and restr. (rcovformula=0, single.eq.sigma=T)
> fit2slsd2rs <- systemfit( "2SLS", system, labels, data = kmenta, R.restr = restrm,
+    inst = instlist, rcovformula = 0, single.eq.sigma = TRUE )
> print( fit2slsd2rs )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.22225 3.58317
supply 3.58317 5.01603

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 3.32382
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605   9.792942 10.578394        0 ***
p             -0.34488   0.121986 -2.827209 0.007812  **
d             0.326029   0.044358  7.349976        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225  10.689038 4.430635  9.3e-05 ***
p            0.244338   0.090956 2.686346 0.011094   *
f            0.265741   0.041635 6.382576        0 ***
a            0.326029   0.044358 7.349976        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd2rs$bcov, digits = 6 ) )
            (Intercept)         p         d                               
(Intercept)   95.901717 -1.129212  0.176368  -5.243009  0.010284  0.024451
p             -1.129212  0.014881 -0.003682   0.109460 -0.000215 -0.000510
d              0.176368 -0.003682  0.001968  -0.058492  0.000115  0.000273
              -5.243009  0.109460 -0.058492 114.255530 -0.898881 -0.243056
               0.010284 -0.000215  0.000115  -0.898881  0.008273  0.000727
               0.024451 -0.000510  0.000273  -0.243056  0.000727  0.001733
               0.176368 -0.003682  0.001968  -0.058492  0.000115  0.000273
                     
(Intercept)  0.176368
p           -0.003682
d            0.001968
            -0.058492
             0.000115
             0.000273
             0.001968
> 
> ## **** 2SLS estimation with different instruments and restriction via TX *
> ## 2SLS estimation with different instruments and restriction via TX (default)
> fit2slsd3 <- systemfit( "2SLS", system, labels, data = kmenta, TX = tc,
+    inst = instlist )
> print( fit2slsd3 )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.79088 4.34523
supply 4.34523 6.27004

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 4.88798
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605  11.892958  8.710499        0 ***
p             -0.34488   0.145481 -2.370628 0.023569   *
d             0.326029    0.05111  6.378936        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225  10.536236  4.49489  7.7e-05 ***
p            0.244338   0.089415 2.732641 0.009895  **
f            0.265741    0.04109 6.467208        0 ***
a            0.326029    0.05111 6.378936        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd3$bcov, digits = 6 ) )
           [,1]      [,2]      [,3]       [,4]      [,5]      [,6]      [,7]
[1,] 141.442455 -1.640068  0.234151  -6.960747  0.013653  0.032462  0.234151
[2,]  -1.640068  0.021165 -0.004888   0.145321 -0.000285 -0.000678 -0.004888
[3,]   0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362  0.002612
[4,]  -6.960747  0.145321 -0.077656 111.012272 -0.869653 -0.237751 -0.077656
[5,]   0.013653 -0.000285  0.000152  -0.869653  0.007995  0.000708  0.000152
[6,]   0.032462 -0.000678  0.000362  -0.237751  0.000708  0.001688  0.000362
[7,]   0.234151 -0.004888  0.002612  -0.077656  0.000152  0.000362  0.002612
> 
> ## **** 2SLS estimation with different instr. and restr. via TX (rcovformula=0)
> fit2slsd3r <- systemfit( "2SLS", system, labels, data = kmenta, TX = tc,
+    inst = instlist, rcovformula = 0 )
> print( fit2slsd3r )

systemfit results 
method: 2SLS 

        N DF     SSR     MSE    RMSE       R2   Adj R2
demand 20 17  64.445 3.79088 1.94702 0.759636 0.731358
supply 20 16 100.321 6.27004 2.50400 0.625829 0.555672

The covariance matrix of the residuals
        demand  supply
demand 3.22225 3.58317
supply 3.58317 5.01603

The correlations of the residuals
         demand   supply
demand 1.000000 0.891266
supply 0.891266 1.000000

The determinant of the residual covariance matrix: 3.32382
OLS R-squared value of the system: 0.692732

2SLS estimates for demand  (equation 1 )
Model Formula: q ~ p + d
Instruments: ~d + f

              Estimate Std. Error   t value Pr(>|t|)    
(Intercept) 103.593605  10.964766  9.447863        0 ***
p             -0.34488   0.134126 -2.571307 0.014678   *
d             0.326029   0.047121  6.918928        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 1.947019 on 17 degrees of freedom
Number of observations: 20 Degrees of Freedom: 17 
SSR: 64.445035 MSE: 3.790884 Root MSE: 1.947019 
Multiple R-Squared: 0.759636 Adjusted R-Squared: 0.731358 


2SLS estimates for supply  (equation 2 )
Model Formula: q ~ p + f + a
Instruments: ~d + f + a

             Estimate Std. Error  t value Pr(>|t|)    
(Intercept) 47.359225    9.71393 4.875393  2.5e-05 ***
p            0.244338   0.082436 2.963965 0.005515  **
f            0.265741   0.037884 7.014671        0 ***
a            0.326029   0.047121 6.918928        0 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 

Residual standard error: 2.504004 on 16 degrees of freedom
Number of observations: 20 Degrees of Freedom: 16 
SSR: 100.320616 MSE: 6.270038 Root MSE: 2.504004 
Multiple R-Squared: 0.625829 Adjusted R-Squared: 0.555672 

> print( round( fit2slsd3r$bcov, digits = 6 ) )
           [,1]      [,2]      [,3]      [,4]      [,5]      [,6]      [,7]
[1,] 120.226087 -1.394058  0.199028 -5.916635  0.011605  0.027592  0.199028
[2,]  -1.394058  0.017990 -0.004155  0.123523 -0.000242 -0.000576 -0.004155
[3,]   0.199028 -0.004155  0.002220 -0.066008  0.000129  0.000308  0.002220
[4,]  -5.916635  0.123523 -0.066008 94.360431 -0.739205 -0.202088 -0.066008
[5,]   0.011605 -0.000242  0.000129 -0.739205  0.006796  0.000602  0.000129
[6,]   0.027592 -0.000576  0.000308 -0.202088  0.000602  0.001435  0.000308
[7,]   0.199028 -0.004155  0.002220 -0.066008  0.000129  0.000308  0.002220
> 
